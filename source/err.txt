./bitops.h:161:7: warning: function 'MemoryReader::read_byte' has a definition with different parameter names [readability-inconsistent-declaration-parameter-name]
        bool read_byte(std::uint8_t* to) override;
             ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:297:20: note: the definition seen here
bool MemoryReader::read_byte(std::uint8_t* byte) {
                   ^
/home/mangix/devstuff/packJPG/source/./bitops.h:161:7: note: differing parameters are named here: ('to'), in definition: ('byte')
        bool read_byte(std::uint8_t* to) override;
             ^                       ~~
                                     byte
/home/mangix/devstuff/packJPG/source/aricoder.cpp:13:18: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
    curr_byte_ = (curr_byte_ << 1) | bit;
                 ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:13:19: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
    curr_byte_ = (curr_byte_ << 1) | bit;
                  ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:18:19: warning: 8 is a magic number; consider replacing it with a named constant [readability-magic-numbers]
        if (curr_bit_ == 8) {
                         ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:25:23: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        if (n + curr_bit_ >= 8) {
                             ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:26:24: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                auto remainingBits = 8 - curr_bit_;
                                     ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:33:14: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        while (n >= 8) {
                    ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:35:8: warning: 8 is a magic number; consider replacing it with a named constant [readability-magic-numbers]
                n -= 8;
                     ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:44:23: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        if (n + curr_bit_ >= 8) {
                             ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:45:24: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                auto remainingBits = 8 - curr_bit_;
                                     ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:48:3: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                curr_byte_ |= all_ones >> (8 - remainingBits);
                ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:48:30: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                curr_byte_ |= all_ones >> (8 - remainingBits);
                                           ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:53:14: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        while (n >= 8) {
                    ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:55:8: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                n -= 8;
                     ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:58:15: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
        curr_byte_ = (curr_byte_ << n) | (all_ones >> (8 - n));
                     ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:58:49: warning: 8 is a magic number; consider replacing it with a named constant [readability-magic-numbers]
        curr_byte_ = (curr_byte_ << n) | (all_ones >> (8 - n));
                                                       ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:68:48: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::vector<std::uint8_t> ArithmeticBitWriter::get_data() const {
~~~~~~~~~~~~~~~~~~~~~~~~~                      ^
auto                                                            -> std::vector<std::uint8_t>
/home/mangix/devstuff/packJPG/source/aricoder.cpp:75:13: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                ccode = ( ccode << 1 ) | read_bit();
                          ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:145:3: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                clow_local <<= 1;
                ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:146:3: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                chigh_local <<= 1;
                ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:157:3: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                clow_local <<= 1;
                ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:158:3: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                chigh_local <<= 1;
                ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:171:33: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
unsigned int ArithmeticDecoder::decode_count( symbol* s )
~~~~~~~~~~~~                    ^
auto                                                      -> unsigned int
/home/mangix/devstuff/packJPG/source/aricoder.cpp:205:3: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                clow_local <<= 1;
                ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:206:3: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                chigh_local <<= 1;
                ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:208:3: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                ccode_local <<= 1;
                ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:219:3: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                clow_local <<= 1;
                ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:220:3: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                chigh_local <<= 1;
                ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:222:3: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                ccode_local <<= 1;
                ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:234:34: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
unsigned char ArithmeticDecoder::read_bit()
~~~~~~~~~~~~~                    ^
auto                                        -> unsigned char
/home/mangix/devstuff/packJPG/source/aricoder.cpp:238:35: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( !reader_.read_byte(&bbyte)) // read next byte if available
                                                ^
                                                 {
/home/mangix/devstuff/packJPG/source/aricoder.cpp:240:10: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                cbit = 8;
                       ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:246:9: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
        return BITN( bbyte, cbit );
               ^
/home/mangix/devstuff/packJPG/source/./bitops.h:7:25: note: expanded from macro 'BITN'
#define BITN( c, n )            ( (c >> n) & 0x1 )
                                  ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:272:3: warning: calling a function that uses a default argument is disallowed [fuchsia-default-arguments-calls]
                totals(max_s + 2),
                ^
/usr/bin/../lib/gcc/x86_64-redhat-linux/9/../../../../include/c++/9/bits/stl_vector.h:507:29: note: default parameter was declared here
      vector(size_type __n, const allocator_type& __a = allocator_type())
                            ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:274:3: warning: calling a function that uses a default argument is disallowed [fuchsia-default-arguments-calls]
                contexts(max_o + 3)
                ^
/usr/bin/../lib/gcc/x86_64-redhat-linux/9/../../../../include/c++/9/bits/stl_vector.h:507:29: note: default parameter was declared here
      vector(size_type __n, const allocator_type& __a = allocator_type())
                            ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:276:35: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        std::fill(scoreboard, scoreboard + max_symbol, false);
                                         ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:279:2: warning: initializing non-owner 'table_s *' with a newly created 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        table_s* null_table = new table_s;
        ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:279:2: warning: use auto when initializing with new to avoid duplicating the type name [hicpp-use-auto]
        table_s* null_table = new table_s;
        ^~~~~~~
        auto
/home/mangix/devstuff/packJPG/source/aricoder.cpp:280:23: warning: calling a function that uses a default argument is disallowed [fuchsia-default-arguments-calls]
        null_table->counts = std::vector<uint16_t>(max_symbol, uint16_t(1));  // Set all probabilities to 1.
                             ^
/usr/bin/../lib/gcc/x86_64-redhat-linux/9/../../../../include/c++/9/bits/stl_vector.h:520:7: note: default parameter was declared here
             const allocator_type& __a = allocator_type())
             ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:287:2: warning: initializing non-owner 'table_s *' with a newly created 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        table_s* start_table = new table_s;
        ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:287:2: warning: use auto when initializing with new to avoid duplicating the type name [modernize-use-auto]
        table_s* start_table = new table_s;
        ^~~~~~~
        auto
/home/mangix/devstuff/packJPG/source/aricoder.cpp:288:23: warning: calling a function that uses a default argument is disallowed [fuchsia-default-arguments-calls]
        start_table->links = std::vector<table_s*>(max_context);
                             ^
/usr/bin/../lib/gcc/x86_64-redhat-linux/9/../../../../include/c++/9/bits/stl_vector.h:507:29: note: default parameter was declared here
      vector(size_type __n, const allocator_type& __a = allocator_type())
                            ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:297:3: warning: assigning newly created 'gsl::owner<>' to non-owner '__gnu_cxx::__alloc_traits<std::allocator<table_s *>, table_s *>::value_type' (aka 'table_s *') [cppcoreguidelines-owning-memory]
                contexts[i] = new table_s;
                ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:300:25: warning: calling a function that uses a default argument is disallowed [fuchsia-default-arguments-calls]
                        contexts[i]->links = std::vector<table_s*>(max_context);
                                             ^
/usr/bin/../lib/gcc/x86_64-redhat-linux/9/../../../../include/c++/9/bits/stl_vector.h:507:29: note: default parameter was declared here
      vector(size_type __n, const allocator_type& __a = allocator_type())
                            ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:314:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete contexts[1];
        ^
/usr/bin/../lib/gcc/x86_64-redhat-linux/9/../../../../include/c++/9/bits/stl_vector.h:1039:7: note: variable declared here
      reference
      ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:317:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete contexts[0];
        ^
/usr/bin/../lib/gcc/x86_64-redhat-linux/9/../../../../include/c++/9/bits/stl_vector.h:1039:7: note: variable declared here
      reference
      ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:352:35: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        std::fill(scoreboard, scoreboard + max_symbol, false);
                                         ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:365:39: warning: statement should be inside braces [hicpp-braces-around-statements]
        if ( ( max_order < 2 ) || ( c < 0 ) ) return;
                                             ^
                                              {
/home/mangix/devstuff/packJPG/source/aricoder.cpp:375:4: warning: assigning newly created 'gsl::owner<>' to non-owner 'table_s *' [cppcoreguidelines-owning-memory]
                        context = new table_s;
                        ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:410:9: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                if ( !scoreboard[ c ] ) {
                      ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:411:4: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        scoreboard[ c ] = true;
                        ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:422:14: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
int model_s::convert_int_to_symbol( int c, symbol *s )
~~~          ^
auto                                                   -> int
/home/mangix/devstuff/packJPG/source/aricoder.cpp:466:14: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
int model_s::convert_symbol_to_int(uint32_t count, symbol *s)
~~~          ^
auto                                                          -> int
/home/mangix/devstuff/packJPG/source/aricoder.cpp:523:9: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        if (!scoreboard[i]) {
                             ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:529:6: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                        scoreboard[i] = true;
                                        ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:573:3: warning: calling a function that uses a default argument is disallowed [fuchsia-default-arguments-calls]
                contexts(max_o + 3)
                ^
/usr/bin/../lib/gcc/x86_64-redhat-linux/9/../../../../include/c++/9/bits/stl_vector.h:507:29: note: default parameter was declared here
      vector(size_type __n, const allocator_type& __a = allocator_type())
                            ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:576:2: warning: initializing non-owner 'table *' with a newly created 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        table* null_table = new table;
        ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:576:2: warning: use auto when initializing with new to avoid duplicating the type name [modernize-use-auto]
        table* null_table = new table;
        ^~~~~
        auto
/home/mangix/devstuff/packJPG/source/aricoder.cpp:577:23: warning: calling a function that uses a default argument is disallowed [fuchsia-default-arguments-calls]
        null_table->counts = std::vector<uint16_t>(2, uint16_t(1));
                             ^
/usr/bin/../lib/gcc/x86_64-redhat-linux/9/../../../../include/c++/9/bits/stl_vector.h:520:7: note: default parameter was declared here
             const allocator_type& __a = allocator_type())
             ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:581:2: warning: initializing non-owner 'table *' with a newly created 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        table* start_table = new table;
        ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:581:2: warning: use auto when initializing with new to avoid duplicating the type name [hicpp-use-auto]
        table* start_table = new table;
        ^~~~~
        auto
/home/mangix/devstuff/packJPG/source/aricoder.cpp:582:23: warning: calling a function that uses a default argument is disallowed [fuchsia-default-arguments-calls]
        start_table->links = std::vector<table*>(max_context);
                             ^
/usr/bin/../lib/gcc/x86_64-redhat-linux/9/../../../../include/c++/9/bits/stl_vector.h:507:29: note: default parameter was declared here
      vector(size_type __n, const allocator_type& __a = allocator_type())
                            ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:591:3: warning: assigning newly created 'gsl::owner<>' to non-owner '__gnu_cxx::__alloc_traits<std::allocator<table *>, table *>::value_type' (aka 'table *') [cppcoreguidelines-owning-memory]
                contexts[i] = new table;
                ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:594:25: warning: calling a function that uses a default argument is disallowed [fuchsia-default-arguments-calls]
                        contexts[i]->links = std::vector<table*>(max_context);
                                             ^
/usr/bin/../lib/gcc/x86_64-redhat-linux/9/../../../../include/c++/9/bits/stl_vector.h:507:29: note: default parameter was declared here
      vector(size_type __n, const allocator_type& __a = allocator_type())
                            ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:608:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete contexts[1];
        ^
/usr/bin/../lib/gcc/x86_64-redhat-linux/9/../../../../include/c++/9/bits/stl_vector.h:1039:7: note: variable declared here
      reference
      ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:611:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete contexts[0];
        ^
/usr/bin/../lib/gcc/x86_64-redhat-linux/9/../../../../include/c++/9/bits/stl_vector.h:1039:7: note: variable declared here
      reference
      ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:633:48: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( context->counts[ symbol ] >= max_count )
                                                             ^
                                                              {
/home/mangix/devstuff/packJPG/source/aricoder.cpp:647:38: warning: statement should be inside braces [hicpp-braces-around-statements]
        if ( (max_order < 2 ) || ( c < 0 ) ) return;
                                            ^
                                             {
/home/mangix/devstuff/packJPG/source/aricoder.cpp:657:4: warning: assigning newly created 'gsl::owner<>' to non-owner 'table *' [cppcoreguidelines-owning-memory]
                        context = new table;            
                        ^
/home/mangix/devstuff/packJPG/source/aricoder.cpp:687:14: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
int model_b::convert_int_to_symbol( int c, symbol *s )
~~~          ^
auto                                                   -> int
/home/mangix/devstuff/packJPG/source/aricoder.cpp:731:14: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
int model_b::convert_symbol_to_int(uint32_t count, symbol *s)
~~~          ^
auto                                                          -> int
/home/mangix/devstuff/packJPG/source/aricoder.cpp:742:2: warning: do not use 'else' after 'return' [readability-else-after-return]
        else {
        ^~~~~~
/home/mangix/devstuff/packJPG/source/bitops.cpp:35:12: warning: use '= default' to define a trivial destructor [hicpp-use-equals-default]
BitReader::~BitReader() {}
           ^            ~~
                        = default;
/home/mangix/devstuff/packJPG/source/bitops.cpp:41:25: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
unsigned int BitReader::read( int nbits ) {
~~~~~~~~~~~~            ^
auto                                      -> unsigned int
/home/mangix/devstuff/packJPG/source/bitops.cpp:51:3: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                retval |= ( RBITS( data[cbyte], cbit ) << nbits );              
                ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:51:15: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                retval |= ( RBITS( data[cbyte], cbit ) << nbits );              
                            ^
/home/mangix/devstuff/packJPG/source/./bitops.h:4:32: note: expanded from macro 'RBITS'
#define RBITS( c, n )           ( c & ( 0xFF >> (8 - n) ) )
                                        ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:51:22: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                retval |= ( RBITS( data[cbyte], cbit ) << nbits );              
                                   ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:51:22: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/./bitops.h:4:26: note: expanded from macro 'RBITS'
#define RBITS( c, n )           ( c & ( 0xFF >> (8 - n) ) )
                                  ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:60:3: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                retval |= ( MBITS( data[cbyte], cbit, (cbit-nbits) ) );
                ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:60:15: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                retval |= ( MBITS( data[cbyte], cbit, (cbit-nbits) ) );
                            ^
/home/mangix/devstuff/packJPG/source/./bitops.h:6:28: note: expanded from macro 'MBITS'
#define MBITS( c, l, r )        ( RBITS( c,l ) >> r )
                                  ^
/home/mangix/devstuff/packJPG/source/./bitops.h:4:24: note: expanded from macro 'RBITS'
#define RBITS( c, n )           ( c & ( 0xFF >> (8 - n) ) )
                                ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:60:22: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                retval |= ( MBITS( data[cbyte], cbit, (cbit-nbits) ) );
                                   ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:60:22: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/./bitops.h:6:35: note: expanded from macro 'MBITS'
#define MBITS( c, l, r )        ( RBITS( c,l ) >> r )
                                         ^
/home/mangix/devstuff/packJPG/source/./bitops.h:4:26: note: expanded from macro 'RBITS'
#define RBITS( c, n )           ( c & ( 0xFF >> (8 - n) ) )
                                  ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:71:26: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
unsigned char BitReader::read_bit() {
~~~~~~~~~~~~~            ^
auto                                -> unsigned char
/home/mangix/devstuff/packJPG/source/bitops.cpp:78:22: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
        unsigned char bit = BITN( data[cbyte], --cbit );
                            ^
/home/mangix/devstuff/packJPG/source/./bitops.h:7:25: note: expanded from macro 'BITN'
#define BITN( c, n )            ( (c >> n) & 0x1 )
                                  ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:78:28: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        unsigned char bit = BITN( data[cbyte], --cbit );
                                  ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:78:28: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/./bitops.h:7:26: note: expanded from macro 'BITN'
#define BITN( c, n )            ( (c >> n) & 0x1 )
                                   ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:89:12: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
    cbit = 8;
           ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:96:26: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
unsigned char BitReader::unpad( unsigned char fillbit ) {
~~~~~~~~~~~~~            ^
auto                                                    -> unsigned char
/home/mangix/devstuff/packJPG/source/bitops.cpp:97:17: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        if ( ( cbit == 8 ) || eof()) {
                       ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:99:7: warning: do not use 'else' after 'return' [readability-else-after-return]
    } else {
      ^~~~~~
/home/mangix/devstuff/packJPG/source/bitops.cpp:101:19: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                while ( cbit != 8 ) {
                                ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:113:16: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
int BitReader::getpos() {
~~~            ^
auto                    -> int
/home/mangix/devstuff/packJPG/source/bitops.cpp:121:16: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
int BitReader::getbitp() {
~~~            ^
auto                     -> int
/home/mangix/devstuff/packJPG/source/bitops.cpp:141:10: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                cbit = 8;
                       ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:142:33: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                peof_ = ( ( pbyte - lbyte ) * 8 ) + 8 - pbit;
                                              ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:142:39: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                peof_ = ( ( pbyte - lbyte ) * 8 ) + 8 - pbit;
                                                    ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:163:18: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        cbyte -= cbit / 8;
                        ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:164:16: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        cbit = cbit % 8;
                      ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:167:10: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                cbit = 8;
                       ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:171:17: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
bool BitReader::eof() {
~~~~            ^
auto                  -> bool
/home/mangix/devstuff/packJPG/source/bitops.cpp:175:16: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
int BitReader::peof() {
~~~            ^
auto                  -> int
/home/mangix/devstuff/packJPG/source/bitops.cpp:181:12: warning: use '= default' to define a trivial destructor [hicpp-use-equals-default]
BitWriter::~BitWriter() {}
           ^            ~~
                        = default;
/home/mangix/devstuff/packJPG/source/bitops.cpp:183:15: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::uint32_t rbits32(std::uint32_t val, std::size_t n) {
~~~~~~~~~~~~~ ^
auto                                                    -> std::uint32_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:184:19: warning: 0xFFFFFFFF is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
    return val & (0xFFFFFFFF >> (32 - n));
                  ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:184:34: warning: 32 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
    return val & (0xFFFFFFFF >> (32 - n));
                                 ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:187:15: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::uint32_t mbits32(std::uint32_t val, std::size_t l, std::size_t r) {
~~~~~~~~~~~~~ ^
auto                                                                   -> std::uint32_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:206:2: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
        curr_byte_ |= bit << curr_bit_;
        ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:215:14: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        curr_bit_ = 8;
                    ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:219:21: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        while (curr_bit_ < 8) {
                           ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:224:38: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::vector<std::uint8_t> BitWriter::get_bytes() {
~~~~~~~~~~~~~~~~~~~~~~~~~            ^
auto                                             -> std::vector<std::uint8_t>
/home/mangix/devstuff/packJPG/source/bitops.cpp:229:27: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
unsigned char* BitWriter::get_c_bytes() {
~~~~~~~~~~~~~~            ^
auto                                    -> unsigned char*
/home/mangix/devstuff/packJPG/source/bitops.cpp:231:5: warning: initializing non-owner 'unsigned char *' with a newly created 'gsl::owner<>' [cppcoreguidelines-owning-memory]
    unsigned char* c_bytes = new unsigned char[bytes_.size()];
    ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:231:5: warning: use auto when initializing with new to avoid duplicating the type name [hicpp-use-auto]
    unsigned char* c_bytes = new unsigned char[bytes_.size()];
    ^~~~~~~~~~~~~
    auto
/home/mangix/devstuff/packJPG/source/bitops.cpp:236:24: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::size_t BitWriter::num_bytes_written() const {
~~~~~~~~~~~            ^
auto                                             -> std::size_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:240:24: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
unsigned char* Reader::get_c_data() {
~~~~~~~~~~~~~~         ^
auto                                -> unsigned char*
/home/mangix/devstuff/packJPG/source/bitops.cpp:242:5: warning: initializing non-owner 'unsigned char *' with a newly created 'gsl::owner<>' [cppcoreguidelines-owning-memory]
    auto c_data_copy = static_cast<unsigned char*>(std::malloc(data.size() * sizeof data[0]));
    ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:242:5: note: type deduction did not result in an owner
/home/mangix/devstuff/packJPG/source/bitops.cpp:242:52: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
    auto c_data_copy = static_cast<unsigned char*>(std::malloc(data.size() * sizeof data[0]));
                                                   ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:251:28: warning: pass by value and use std::move [modernize-pass-by-value]
MemoryReader::MemoryReader(const std::vector<std::uint8_t>& bytes) :
                           ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
                           std::vector<std::uint8_t> 
/home/mangix/devstuff/packJPG/source/bitops.cpp:257:5: warning: calling a function that uses a default argument is disallowed [fuchsia-default-arguments-calls]
    data_(bytes, bytes + size),
    ^
/usr/bin/../lib/gcc/x86_64-redhat-linux/9/../../../../include/c++/9/bits/stl_vector.h:651:9: note: default parameter was declared here
               const allocator_type& __a = allocator_type())
               ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:257:24: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
    data_(bytes, bytes + size),
                       ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:261:27: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::size_t MemoryReader::read(std::uint8_t* to, std::size_t num_to_read) {
~~~~~~~~~~~               ^
auto                                                                      -> std::size_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:273:27: warning: default arguments on virtual or override methods are prohibited [google-default-arguments]
std::size_t MemoryReader::read(std::vector<std::uint8_t>& into, std::size_t n, std::size_t offset) {
                          ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:273:27: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::size_t MemoryReader::read(std::vector<std::uint8_t>& into, std::size_t n, std::size_t offset) {
~~~~~~~~~~~               ^
auto                                                                                               -> std::size_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:287:28: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::uint8_t MemoryReader::read_byte() {
~~~~~~~~~~~~               ^
auto                                   -> std::uint8_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:290:4: warning: do not use 'else' after 'throw' [readability-else-after-return]
        } else {
          ^~~~~~
/home/mangix/devstuff/packJPG/source/bitops.cpp:297:20: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
bool MemoryReader::read_byte(std::uint8_t* byte) {
~~~~               ^
auto                                             -> bool
/home/mangix/devstuff/packJPG/source/bitops.cpp:300:4: warning: do not use 'else' after 'return' [readability-else-after-return]
        } else {
          ^~~~~~
/home/mangix/devstuff/packJPG/source/bitops.cpp:322:27: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::size_t MemoryReader::num_bytes_read() {
~~~~~~~~~~~               ^
auto                                       -> std::size_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:326:27: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::size_t MemoryReader::get_size() {
~~~~~~~~~~~               ^
auto                                 -> std::size_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:330:41: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::vector<std::uint8_t> MemoryReader::get_data() {
~~~~~~~~~~~~~~~~~~~~~~~~~               ^
auto                                               -> std::vector<std::uint8_t>
/home/mangix/devstuff/packJPG/source/bitops.cpp:334:20: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
bool MemoryReader::error() {
~~~~               ^
auto                       -> bool
/home/mangix/devstuff/packJPG/source/bitops.cpp:338:20: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
bool MemoryReader::end_of_reader() {
~~~~               ^
auto                               -> bool
/home/mangix/devstuff/packJPG/source/bitops.cpp:342:24: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
unsigned char* Writer::get_c_data() {
~~~~~~~~~~~~~~         ^
auto                                -> unsigned char*
/home/mangix/devstuff/packJPG/source/bitops.cpp:345:9: warning: initializing non-owner 'unsigned char *' with a newly created 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        auto c_data_copy = static_cast<unsigned char*>(std::malloc(data.size() * sizeof data[0]));
        ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:345:9: note: type deduction did not result in an owner
/home/mangix/devstuff/packJPG/source/bitops.cpp:345:56: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
        auto c_data_copy = static_cast<unsigned char*>(std::malloc(data.size() * sizeof data[0]));
                                                       ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:357:15: warning: use '= default' to define a trivial default constructor [hicpp-use-equals-default]
MemoryWriter::MemoryWriter() {}
              ^              ~~
                             = default;
/home/mangix/devstuff/packJPG/source/bitops.cpp:359:27: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::size_t MemoryWriter::write(const std::uint8_t* from, std::size_t n) {
~~~~~~~~~~~               ^
auto                                                                     -> std::size_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:360:43: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        data_.insert(std::end(data_), from, from + n);
                                                 ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:364:27: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::size_t MemoryWriter::write(const std::vector<std::uint8_t>& bytes) {
~~~~~~~~~~~               ^
auto                                                                    -> std::size_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:369:27: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::size_t MemoryWriter::write(const std::array<std::uint8_t, 2>& bytes) {
~~~~~~~~~~~               ^
auto                                                                      -> std::size_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:374:20: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
bool MemoryWriter::write_byte(std::uint8_t byte) {
~~~~               ^
auto                                             -> bool
/home/mangix/devstuff/packJPG/source/bitops.cpp:379:41: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::vector<std::uint8_t> MemoryWriter::get_data() {
~~~~~~~~~~~~~~~~~~~~~~~~~               ^
auto                                               -> std::vector<std::uint8_t>
/home/mangix/devstuff/packJPG/source/bitops.cpp:387:27: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::size_t MemoryWriter::num_bytes_written() {
~~~~~~~~~~~               ^
auto                                          -> std::size_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:391:20: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
bool MemoryWriter::error() {
~~~~               ^
auto                       -> bool
/home/mangix/devstuff/packJPG/source/bitops.cpp:396:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'FILE *' (aka '_IO_FILE *') [cppcoreguidelines-owning-memory]
        fptr_ = std::fopen(file_path.c_str(), "wb");
        ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:396:40: warning: use 'fopen' mode 'e' to set O_CLOEXEC [android-cloexec-fopen]
        fptr_ = std::fopen(file_path.c_str(), "wb");
                                              ^~~~
                                              "wbe"
/home/mangix/devstuff/packJPG/source/bitops.cpp:398:24: warning: 32768 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                file_buffer_.reserve(32768);
                                     ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:409:3: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
                std::fclose(fptr_);
                ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:413:25: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::size_t FileWriter::write(const std::uint8_t* from, std::size_t n) {
~~~~~~~~~~~             ^
auto                                                                   -> std::size_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:414:34: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        return std::fwrite(from, sizeof from[0], n, fptr_);
                                        ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:417:25: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::size_t FileWriter::write(const std::vector<std::uint8_t>& bytes) {
~~~~~~~~~~~             ^
auto                                                                  -> std::size_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:421:25: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::size_t FileWriter::write(const std::array<std::uint8_t, 2>& bytes) {
~~~~~~~~~~~             ^
auto                                                                    -> std::size_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:425:18: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
bool FileWriter::write_byte(std::uint8_t byte) {
~~~~             ^
auto                                           -> bool
/home/mangix/devstuff/packJPG/source/bitops.cpp:429:39: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::vector<std::uint8_t> FileWriter::get_data() {
~~~~~~~~~~~~~~~~~~~~~~~~~             ^
auto                                             -> std::vector<std::uint8_t>
/home/mangix/devstuff/packJPG/source/bitops.cpp:433:29: warning: calling a function that uses a default argument is disallowed [fuchsia-default-arguments-calls]
                std::vector<std::uint8_t> data_copy(size);
                                          ^
/usr/bin/../lib/gcc/x86_64-redhat-linux/9/../../../../include/c++/9/bits/stl_vector.h:507:29: note: default parameter was declared here
      vector(size_type __n, const allocator_type& __a = allocator_type())
                            ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:435:15: warning: do not use reinterpret_cast [cppcoreguidelines-pro-type-reinterpret-cast]
                if (is.read(reinterpret_cast<char*>(data_copy.data()), size)) {
                            ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:437:5: warning: do not use 'else' after 'return' [readability-else-after-return]
                } else {
                  ^~~~~~
/home/mangix/devstuff/packJPG/source/bitops.cpp:449:25: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::size_t FileWriter::num_bytes_written() {
~~~~~~~~~~~             ^
auto                                        -> std::size_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:454:18: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
bool FileWriter::error() {
~~~~             ^
auto                     -> bool
/home/mangix/devstuff/packJPG/source/bitops.cpp:455:29: warning: implicit conversion 'int' -> bool [readability-implicit-bool-conversion]
        return fptr_ == nullptr || std::ferror(fptr_);
                                   ^
                                   (                  != 0)
/home/mangix/devstuff/packJPG/source/bitops.cpp:473:27: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::size_t StreamWriter::write(const std::uint8_t* from, std::size_t n) {
~~~~~~~~~~~               ^
auto                                                                     -> std::size_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:477:27: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::size_t StreamWriter::write(const std::vector<std::uint8_t>& bytes) {
~~~~~~~~~~~               ^
auto                                                                    -> std::size_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:481:27: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::size_t StreamWriter::write(const std::array<std::uint8_t, 2>& bytes) {
~~~~~~~~~~~               ^
auto                                                                      -> std::size_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:485:20: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
bool StreamWriter::write_byte(std::uint8_t byte) {
~~~~               ^
auto                                             -> bool
/home/mangix/devstuff/packJPG/source/bitops.cpp:489:41: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::vector<std::uint8_t> StreamWriter::get_data() {
~~~~~~~~~~~~~~~~~~~~~~~~~               ^
auto                                               -> std::vector<std::uint8_t>
/home/mangix/devstuff/packJPG/source/bitops.cpp:497:27: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::size_t StreamWriter::num_bytes_written() {
~~~~~~~~~~~               ^
auto                                          -> std::size_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:501:20: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
bool StreamWriter::error() {
~~~~               ^
auto                       -> bool
/home/mangix/devstuff/packJPG/source/bitops.cpp:510:29: warning: calling a function that uses a default argument is disallowed [fuchsia-default-arguments-calls]
                std::vector<std::uint8_t> data(size);
                                          ^
/usr/bin/../lib/gcc/x86_64-redhat-linux/9/../../../../include/c++/9/bits/stl_vector.h:507:29: note: default parameter was declared here
      vector(size_type __n, const allocator_type& __a = allocator_type())
                            ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:512:15: warning: do not use reinterpret_cast [cppcoreguidelines-pro-type-reinterpret-cast]
                if (is.read(reinterpret_cast<char*>(data.data()), size)) {
                            ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:522:13: warning: use '= default' to define a trivial destructor [hicpp-use-equals-default]
FileReader::~FileReader() {}
            ^             ~~
                          = default;
/home/mangix/devstuff/packJPG/source/bitops.cpp:524:25: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::size_t FileReader::read(std::uint8_t* to, std::size_t num_to_read) {
~~~~~~~~~~~             ^
auto                                                                    -> std::size_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:528:25: warning: default arguments on virtual or override methods are prohibited [google-default-arguments]
std::size_t FileReader::read(std::vector<std::uint8_t>& into, std::size_t num_to_read, std::size_t offset) {
                        ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:528:25: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::size_t FileReader::read(std::vector<std::uint8_t>& into, std::size_t num_to_read, std::size_t offset) {
~~~~~~~~~~~             ^
auto                                                                                                       -> std::size_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:532:26: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::uint8_t FileReader::read_byte() {
~~~~~~~~~~~~             ^
auto                                 -> std::uint8_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:536:18: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
bool FileReader::read_byte(std::uint8_t* to) {
~~~~             ^
auto                                         -> bool
/home/mangix/devstuff/packJPG/source/bitops.cpp:552:25: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::size_t FileReader::num_bytes_read() {
~~~~~~~~~~~             ^
auto                                     -> std::size_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:556:25: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::size_t FileReader::get_size() {
~~~~~~~~~~~             ^
auto                               -> std::size_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:560:39: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::vector<std::uint8_t> FileReader::get_data() {
~~~~~~~~~~~~~~~~~~~~~~~~~             ^
auto                                             -> std::vector<std::uint8_t>
/home/mangix/devstuff/packJPG/source/bitops.cpp:564:18: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
bool FileReader::error() {
~~~~             ^
auto                     -> bool
/home/mangix/devstuff/packJPG/source/bitops.cpp:568:18: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
bool FileReader::end_of_reader() {
~~~~             ^
auto                             -> bool
/home/mangix/devstuff/packJPG/source/bitops.cpp:582:28: warning: calling a function that uses a default argument is disallowed [fuchsia-default-arguments-calls]
        std::vector<std::uint8_t> buffer(buffer_capacity);
                                  ^
/usr/bin/../lib/gcc/x86_64-redhat-linux/9/../../../../include/c++/9/bits/stl_vector.h:507:29: note: default parameter was declared here
      vector(size_type __n, const allocator_type& __a = allocator_type())
                            ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:593:27: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::size_t StreamReader::read(std::uint8_t* to, std::size_t num_to_read) {
~~~~~~~~~~~               ^
auto                                                                      -> std::size_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:597:27: warning: default arguments on virtual or override methods are prohibited [google-default-arguments]
std::size_t StreamReader::read(std::vector<std::uint8_t>& into, std::size_t num_to_read, std::size_t offset) {
                          ^
/home/mangix/devstuff/packJPG/source/bitops.cpp:597:27: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::size_t StreamReader::read(std::vector<std::uint8_t>& into, std::size_t num_to_read, std::size_t offset) {
~~~~~~~~~~~               ^
auto                                                                                                         -> std::size_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:601:28: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::uint8_t StreamReader::read_byte() {
~~~~~~~~~~~~               ^
auto                                   -> std::uint8_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:605:20: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
bool StreamReader::read_byte(std::uint8_t* to) {
~~~~               ^
auto                                           -> bool
/home/mangix/devstuff/packJPG/source/bitops.cpp:621:27: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::size_t StreamReader::num_bytes_read() {
~~~~~~~~~~~               ^
auto                                       -> std::size_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:625:27: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::size_t StreamReader::get_size() {
~~~~~~~~~~~               ^
auto                                 -> std::size_t
/home/mangix/devstuff/packJPG/source/bitops.cpp:629:41: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
std::vector<std::uint8_t> StreamReader::get_data() {
~~~~~~~~~~~~~~~~~~~~~~~~~               ^
auto                                               -> std::vector<std::uint8_t>
/home/mangix/devstuff/packJPG/source/bitops.cpp:633:20: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
bool StreamReader::error() {
~~~~               ^
auto                       -> bool
/home/mangix/devstuff/packJPG/source/bitops.cpp:637:20: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
bool StreamReader::end_of_reader() {
~~~~               ^
auto                               -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:273:1: warning: #includes are not sorted properly [llvm-include-order]
#include <cstdio>
^        ~~~~~~~~
         <cmath>
/home/mangix/devstuff/packJPG/source/packjpg.cpp:283:1: warning: #includes are not sorted properly [llvm-include-order]
#include "bitops.h"
^        ~~~~~~~~~~
         "aricoder.h"
/home/mangix/devstuff/packJPG/source/packjpg.cpp:296:9: warning: macro 'INTERN' used to declare a constant; consider using a 'constexpr' constant [cppcoreguidelines-macro-usage]
#define INTERN static
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:298:9: warning: function-like macro 'INIT_MODEL_S' used; consider a 'constexpr' template function [cppcoreguidelines-macro-usage]
#define INIT_MODEL_S(a,b,c) new model_s( a, b, c, 255 )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:9: warning: function-like macro 'INIT_MODEL_B' used; consider a 'constexpr' template function [cppcoreguidelines-macro-usage]
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:9: warning: function-like macro 'QUANT' used; consider a 'constexpr' template function [cppcoreguidelines-macro-usage]
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:9: warning: function-like macro 'MAX_V' used; consider a 'constexpr' template function [cppcoreguidelines-macro-usage]
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:309:9: warning: function-like macro 'ENVLI' used; consider a 'constexpr' template function [cppcoreguidelines-macro-usage]
#define ENVLI(s,v)              ( ( v > 0 ) ? v : ( v - 1 ) + ( 1 << s ) )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:309:25: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define ENVLI(s,v)              ( ( v > 0 ) ? v : ( v - 1 ) + ( 1 << s ) )
                                    ^
                                    ()
/home/mangix/devstuff/packJPG/source/packjpg.cpp:309:35: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define ENVLI(s,v)              ( ( v > 0 ) ? v : ( v - 1 ) + ( 1 << s ) )
                                              ^
                                              ()
/home/mangix/devstuff/packJPG/source/packjpg.cpp:309:41: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define ENVLI(s,v)              ( ( v > 0 ) ? v : ( v - 1 ) + ( 1 << s ) )
                                                    ^
                                                    ()
/home/mangix/devstuff/packJPG/source/packjpg.cpp:309:58: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define ENVLI(s,v)              ( ( v > 0 ) ? v : ( v - 1 ) + ( 1 << s ) )
                                                                     ^
                                                                     ()
/home/mangix/devstuff/packJPG/source/packjpg.cpp:310:9: warning: function-like macro 'DEVLI' used; consider a 'constexpr' template function [cppcoreguidelines-macro-usage]
#define DEVLI(s,n)              ( ( n >= ( 1 << (s - 1) ) ) ? n : n + 1 - ( 1 << s ) )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:310:25: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define DEVLI(s,n)              ( ( n >= ( 1 << (s - 1) ) ) ? n : n + 1 - ( 1 << s ) )
                                    ^
                                    ()
/home/mangix/devstuff/packJPG/source/packjpg.cpp:310:38: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define DEVLI(s,n)              ( ( n >= ( 1 << (s - 1) ) ) ? n : n + 1 - ( 1 << s ) )
                                                 ^
                                                 ()
/home/mangix/devstuff/packJPG/source/packjpg.cpp:310:51: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define DEVLI(s,n)              ( ( n >= ( 1 << (s - 1) ) ) ? n : n + 1 - ( 1 << s ) )
                                                              ^
                                                              ()
/home/mangix/devstuff/packJPG/source/packjpg.cpp:310:55: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define DEVLI(s,n)              ( ( n >= ( 1 << (s - 1) ) ) ? n : n + 1 - ( 1 << s ) )
                                                                  ^
                                                                  ()
/home/mangix/devstuff/packJPG/source/packjpg.cpp:310:70: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define DEVLI(s,n)              ( ( n >= ( 1 << (s - 1) ) ) ? n : n + 1 - ( 1 << s ) )
                                                                                 ^
                                                                                 ()
/home/mangix/devstuff/packJPG/source/packjpg.cpp:311:9: warning: function-like macro 'E_ENVLI' used; consider a 'constexpr' template function [cppcoreguidelines-macro-usage]
#define E_ENVLI(s,v)    ( v - ( 1 << s ) )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:311:24: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define E_ENVLI(s,v)    ( v - ( 1 << s ) )
                          ^
                          ()
/home/mangix/devstuff/packJPG/source/packjpg.cpp:311:35: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define E_ENVLI(s,v)    ( v - ( 1 << s ) )
                                     ^
                                     ()
/home/mangix/devstuff/packJPG/source/packjpg.cpp:312:9: warning: function-like macro 'E_DEVLI' used; consider a 'constexpr' template function [cppcoreguidelines-macro-usage]
#define E_DEVLI(s,n)    ( n + ( 1 << s ) )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:312:24: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define E_DEVLI(s,n)    ( n + ( 1 << s ) )
                          ^
                          ()
/home/mangix/devstuff/packJPG/source/packjpg.cpp:312:35: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define E_DEVLI(s,n)    ( n + ( 1 << s ) )
                                     ^
                                     ()
/home/mangix/devstuff/packJPG/source/packjpg.cpp:314:9: warning: function-like macro 'ABS' used; consider a 'constexpr' template function [cppcoreguidelines-macro-usage]
#define ABS(v1)                 ( (v1 < 0) ? -v1 : v1 )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:314:22: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define ABS(v1)                 ( (v1 < 0) ? -v1 : v1 )
                                   ^
                                   ( )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:314:33: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define ABS(v1)                 ( (v1 < 0) ? -v1 : v1 )
                                              ^
                                              ( )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:314:38: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define ABS(v1)                 ( (v1 < 0) ? -v1 : v1 )
                                                   ^
                                                   ( )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:315:9: warning: function-like macro 'ABSDIFF' used; consider a 'constexpr' template function [cppcoreguidelines-macro-usage]
#define ABSDIFF(v1,v2)  ( (v1 > v2) ? (v1 - v2) : (v2 - v1) )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:315:27: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define ABSDIFF(v1,v2)  ( (v1 > v2) ? (v1 - v2) : (v2 - v1) )
                           ^
                           ( )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:315:32: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define ABSDIFF(v1,v2)  ( (v1 > v2) ? (v1 - v2) : (v2 - v1) )
                                ^
                                ( )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:315:39: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define ABSDIFF(v1,v2)  ( (v1 > v2) ? (v1 - v2) : (v2 - v1) )
                                       ^
                                       ( )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:315:44: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define ABSDIFF(v1,v2)  ( (v1 > v2) ? (v1 - v2) : (v2 - v1) )
                                            ^
                                            ( )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:315:51: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define ABSDIFF(v1,v2)  ( (v1 > v2) ? (v1 - v2) : (v2 - v1) )
                                                   ^
                                                   ( )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:315:56: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define ABSDIFF(v1,v2)  ( (v1 > v2) ? (v1 - v2) : (v2 - v1) )
                                                        ^
                                                        ( )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:316:9: warning: function-like macro 'IPOS' used; consider a 'constexpr' template function [cppcoreguidelines-macro-usage]
#define IPOS(w,v,h)             ( ( v * w ) + h )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:316:26: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define IPOS(w,v,h)             ( ( v * w ) + h )
                                    ^
                                    ()
/home/mangix/devstuff/packJPG/source/packjpg.cpp:316:30: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define IPOS(w,v,h)             ( ( v * w ) + h )
                                        ^
                                        ()
/home/mangix/devstuff/packJPG/source/packjpg.cpp:316:36: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define IPOS(w,v,h)             ( ( v * w ) + h )
                                              ^
                                              ()
/home/mangix/devstuff/packJPG/source/packjpg.cpp:317:9: warning: function-like macro 'NPOS' used; consider a 'constexpr' template function [cppcoreguidelines-macro-usage]
#define NPOS(n1,n2,p)   ( ( ( p / n1 ) * n2 ) + ( p % n1 ) )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:317:29: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define NPOS(n1,n2,p)   ( ( ( p / n1 ) * n2 ) + ( p % n1 ) )
                              ^
                              ()
/home/mangix/devstuff/packJPG/source/packjpg.cpp:317:33: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define NPOS(n1,n2,p)   ( ( ( p / n1 ) * n2 ) + ( p % n1 ) )
                                  ^
                                  ( )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:317:40: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define NPOS(n1,n2,p)   ( ( ( p / n1 ) * n2 ) + ( p % n1 ) )
                                         ^
                                         ( )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:317:49: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define NPOS(n1,n2,p)   ( ( ( p / n1 ) * n2 ) + ( p % n1 ) )
                                                  ^
                                                  ()
/home/mangix/devstuff/packJPG/source/packjpg.cpp:317:53: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define NPOS(n1,n2,p)   ( ( ( p / n1 ) * n2 ) + ( p % n1 ) )
                                                      ^
                                                      ( )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:318:9: warning: function-like macro 'ROUND_F' used; consider a 'constexpr' template function [cppcoreguidelines-macro-usage]
#define ROUND_F(v1)             ( (v1 < 0) ? (int) (v1 - 0.5) : (int) (v1 + 0.5) )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:318:25: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define ROUND_F(v1)             ( (v1 < 0) ? (int) (v1 - 0.5) : (int) (v1 + 0.5) )
                                   ^
                                   ( )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:318:42: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define ROUND_F(v1)             ( (v1 < 0) ? (int) (v1 - 0.5) : (int) (v1 + 0.5) )
                                                    ^
                                                    ( )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:318:61: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define ROUND_F(v1)             ( (v1 < 0) ? (int) (v1 - 0.5) : (int) (v1 + 0.5) )
                                                                       ^
                                                                       ( )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:319:9: warning: function-like macro 'DIV_INT' used; consider a 'constexpr' template function [cppcoreguidelines-macro-usage]
#define DIV_INT(v1,v2)  ( (v1 < 0) ? (v1 - (v2>>1)) / v2 : (v1 + (v2>>1)) / v2 )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:319:27: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define DIV_INT(v1,v2)  ( (v1 < 0) ? (v1 - (v2>>1)) / v2 : (v1 + (v2>>1)) / v2 )
                           ^
                           ( )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:319:38: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define DIV_INT(v1,v2)  ( (v1 < 0) ? (v1 - (v2>>1)) / v2 : (v1 + (v2>>1)) / v2 )
                                      ^
                                      ( )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:319:44: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define DIV_INT(v1,v2)  ( (v1 < 0) ? (v1 - (v2>>1)) / v2 : (v1 + (v2>>1)) / v2 )
                                            ^
                                            ( )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:319:54: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define DIV_INT(v1,v2)  ( (v1 < 0) ? (v1 - (v2>>1)) / v2 : (v1 + (v2>>1)) / v2 )
                                                      ^
                                                      ( )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:319:60: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define DIV_INT(v1,v2)  ( (v1 < 0) ? (v1 - (v2>>1)) / v2 : (v1 + (v2>>1)) / v2 )
                                                            ^
                                                            ( )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:319:66: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define DIV_INT(v1,v2)  ( (v1 < 0) ? (v1 - (v2>>1)) / v2 : (v1 + (v2>>1)) / v2 )
                                                                  ^
                                                                  ( )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:319:76: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define DIV_INT(v1,v2)  ( (v1 < 0) ? (v1 - (v2>>1)) / v2 : (v1 + (v2>>1)) / v2 )
                                                                            ^
                                                                            ( )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:320:9: warning: function-like macro 'B_SHORT' used; consider a 'constexpr' template function [cppcoreguidelines-macro-usage]
#define B_SHORT(v1,v2)  ( ( ((int) v1) << 8 ) + ((int) v2) )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:320:35: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define B_SHORT(v1,v2)  ( ( ((int) v1) << 8 ) + ((int) v2) )
                                   ^
                                   ( )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:320:55: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define B_SHORT(v1,v2)  ( ( ((int) v1) << 8 ) + ((int) v2) )
                                                       ^
                                                       ( )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:321:9: warning: function-like macro 'BITLEN1024P' used; consider a 'constexpr' template function [cppcoreguidelines-macro-usage]
#define BITLEN1024P(v)  ( pbitlen_0_1024[ v ] )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:322:9: warning: function-like macro 'BITLEN2048N' used; consider a 'constexpr' template function [cppcoreguidelines-macro-usage]
#define BITLEN2048N(v)  ( (pbitlen_n2048_2047+2048)[ v ] )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:323:9: warning: function-like macro 'CLAMPED' used; consider a 'constexpr' template function [cppcoreguidelines-macro-usage]
#define CLAMPED(l,h,v)  ( ( v < l ) ? l : ( v > h ) ? h : v )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:323:28: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define CLAMPED(l,h,v)  ( ( v < l ) ? l : ( v > h ) ? h : v )
                            ^
                            ()
/home/mangix/devstuff/packJPG/source/packjpg.cpp:323:32: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define CLAMPED(l,h,v)  ( ( v < l ) ? l : ( v > h ) ? h : v )
                                ^
                                ()
/home/mangix/devstuff/packJPG/source/packjpg.cpp:323:38: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define CLAMPED(l,h,v)  ( ( v < l ) ? l : ( v > h ) ? h : v )
                                      ^
                                      ()
/home/mangix/devstuff/packJPG/source/packjpg.cpp:323:44: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define CLAMPED(l,h,v)  ( ( v < l ) ? l : ( v > h ) ? h : v )
                                            ^
                                            ()
/home/mangix/devstuff/packJPG/source/packjpg.cpp:323:48: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define CLAMPED(l,h,v)  ( ( v < l ) ? l : ( v > h ) ? h : v )
                                                ^
                                                ()
/home/mangix/devstuff/packJPG/source/packjpg.cpp:323:54: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define CLAMPED(l,h,v)  ( ( v < l ) ? l : ( v > h ) ? h : v )
                                                      ^
                                                      ()
/home/mangix/devstuff/packJPG/source/packjpg.cpp:323:58: warning: macro argument should be enclosed in parentheses [bugprone-macro-parentheses]
#define CLAMPED(l,h,v)  ( ( v < l ) ? l : ( v > h ) ? h : v )
                                                          ^
                                                          ()
/home/mangix/devstuff/packJPG/source/packjpg.cpp:325:9: warning: macro 'MEM_ERRMSG' used to declare a constant; consider using a 'constexpr' constant [cppcoreguidelines-macro-usage]
#define MEM_ERRMSG      "out of memory error"
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:326:9: warning: macro 'FRD_ERRMSG' used to declare a constant; consider using a 'constexpr' constant [cppcoreguidelines-macro-usage]
#define FRD_ERRMSG      "could not read file / file not found: %s"
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:327:9: warning: macro 'FWR_ERRMSG' used to declare a constant; consider using a 'constexpr' constant [cppcoreguidelines-macro-usage]
#define FWR_ERRMSG      "could not write file / file write-protected: %s"
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:328:9: warning: macro 'MSG_SIZE' used to declare a constant; consider using a 'constexpr' constant [cppcoreguidelines-macro-usage]
#define MSG_SIZE        128
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:329:9: warning: macro 'BARLEN' used to declare a constant; consider using a 'constexpr' constant [cppcoreguidelines-macro-usage]
#define BARLEN          36
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:332:21: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
static inline void* frealloc( void* ptr, size_t size ) {
              ~~~~~ ^
              auto                                     -> void*
/home/mangix/devstuff/packJPG/source/packjpg.cpp:333:2: warning: initializing non-owner 'void *' with a newly created 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        void* n_ptr = realloc( ptr, (size) ? size : 1 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:333:16: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        void* n_ptr = realloc( ptr, (size) ? size : 1 );
                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:333:16: warning: do not manage memory manually; consider std::vector or std::string [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:333:30: warning: implicit conversion 'size_t' (aka 'unsigned long') -> bool [readability-implicit-bool-conversion]
        void* n_ptr = realloc( ptr, (size) ? size : 1 );
                                    ^
                                           != 0u
/home/mangix/devstuff/packJPG/source/packjpg.cpp:334:25: warning: statement should be inside braces [readability-braces-around-statements]
        if ( n_ptr == nullptr ) free( ptr );
                               ^
                                {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:334:26: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        if ( n_ptr == nullptr ) free( ptr );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:334:26: warning: do not manage memory manually; use RAII [hicpp-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:345:2: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        unsigned short* qtable; // quantization table
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:362:2: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        unsigned short cval[ 256 ];
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:362:2: warning: do not declare C-style arrays, use std::array<> instead [modernize-avoid-c-arrays]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:362:23: warning: 256 is a magic number; consider replacing it with a named constant [readability-magic-numbers]
        unsigned short cval[ 256 ];
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:363:2: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        unsigned short clen[ 256 ];
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:363:2: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:363:23: warning: 256 is a magic number; consider replacing it with a named constant [readability-magic-numbers]
        unsigned short clen[ 256 ];
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:364:2: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        unsigned short max_eobrun;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:368:2: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        unsigned short l[ 256 ];
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:368:2: warning: do not declare C-style arrays, use std::array<> instead [modernize-avoid-c-arrays]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:368:20: warning: 256 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        unsigned short l[ 256 ];
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:369:2: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        unsigned short r[ 256 ];
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:369:2: warning: do not declare C-style arrays, use std::array<> instead [hicpp-avoid-c-arrays]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:369:20: warning: 256 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        unsigned short r[ 256 ];
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:378:25: warning: redundant void argument list in function declaration [modernize-redundant-void-arg]
INTERN void process_ui( void );
                        ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:379:27: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN inline const char* get_status( bool (*function)() );
              ~~~~~~~~~~~ ^
              auto                                         -> const char*
/home/mangix/devstuff/packJPG/source/packjpg.cpp:380:24: warning: redundant void argument list in function declaration [modernize-redundant-void-arg]
INTERN void show_help( void );
                       ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:382:27: warning: redundant void argument list in function declaration [modernize-redundant-void-arg]
INTERN void process_file( void );
                          ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:390:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool check_file( void );
       ~~~~ ^
       auto                    -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:390:25: warning: redundant void argument list in function declaration [modernize-redundant-void-arg]
INTERN bool check_file( void );
                        ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:391:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool swap_streams( void );
       ~~~~ ^
       auto                      -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:391:27: warning: redundant void argument list in function declaration [modernize-redundant-void-arg]
INTERN bool swap_streams( void );
                          ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:392:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool compare_output( void );
       ~~~~ ^
       auto                        -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:392:29: warning: redundant void argument list in function declaration [modernize-redundant-void-arg]
INTERN bool compare_output( void );
                            ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:394:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool reset_buffers( void );
       ~~~~ ^
       auto                       -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:394:28: warning: redundant void argument list in function declaration [modernize-redundant-void-arg]
INTERN bool reset_buffers( void );
                           ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:395:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool read_jpeg( void );
       ~~~~ ^
       auto                   -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:395:24: warning: redundant void argument list in function declaration [modernize-redundant-void-arg]
INTERN bool read_jpeg( void );
                       ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:396:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool merge_jpeg( void );
       ~~~~ ^
       auto                    -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:396:25: warning: redundant void argument list in function declaration [modernize-redundant-void-arg]
INTERN bool merge_jpeg( void );
                        ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:397:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool decode_jpeg( void );
       ~~~~ ^
       auto                     -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:397:26: warning: redundant void argument list in function declaration [modernize-redundant-void-arg]
INTERN bool decode_jpeg( void );
                         ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:398:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool recode_jpeg( void );
       ~~~~ ^
       auto                     -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:398:26: warning: redundant void argument list in function declaration [modernize-redundant-void-arg]
INTERN bool recode_jpeg( void );
                         ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:399:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool adapt_icos( void );
       ~~~~ ^
       auto                    -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:399:25: warning: redundant void argument list in function declaration [modernize-redundant-void-arg]
INTERN bool adapt_icos( void );
                        ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:400:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool predict_dc( void );
       ~~~~ ^
       auto                    -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:400:25: warning: redundant void argument list in function declaration [modernize-redundant-void-arg]
INTERN bool predict_dc( void );
                        ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:401:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool unpredict_dc( void );
       ~~~~ ^
       auto                      -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:401:27: warning: redundant void argument list in function declaration [modernize-redundant-void-arg]
INTERN bool unpredict_dc( void );
                          ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:402:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool check_value_range( void );
       ~~~~ ^
       auto                           -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:402:32: warning: redundant void argument list in function declaration [modernize-redundant-void-arg]
INTERN bool check_value_range( void );
                               ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:403:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool calc_zdst_lists( void );
       ~~~~ ^
       auto                         -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:403:30: warning: redundant void argument list in function declaration [modernize-redundant-void-arg]
INTERN bool calc_zdst_lists( void );
                             ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:404:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pack_pjg( void );
       ~~~~ ^
       auto                  -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:404:23: warning: redundant void argument list in function declaration [modernize-redundant-void-arg]
INTERN bool pack_pjg( void );
                      ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:405:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool unpack_pjg( void );
       ~~~~ ^
       auto                    -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:405:25: warning: redundant void argument list in function declaration [modernize-redundant-void-arg]
INTERN bool unpack_pjg( void );
                        ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:412:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool jpg_setup_imginfo( void );
       ~~~~ ^
       auto                           -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:412:32: warning: redundant void argument list in function declaration [modernize-redundant-void-arg]
INTERN bool jpg_setup_imginfo( void );
                               ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:413:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool jpg_parse_jfif( unsigned char type, unsigned int len, unsigned char* segment );
       ~~~~ ^
       auto                                                                                -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:414:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool jpg_rebuild_header( void );
       ~~~~ ^
       auto                            -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:414:33: warning: redundant void argument list in function declaration [modernize-redundant-void-arg]
INTERN bool jpg_rebuild_header( void );
                                ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:416:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_decode_block_seq( BitReader* huffr, huffTree* dctree, huffTree* actree, short* block );
       ~~~ ^
       auto                                                                                           -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:416:88: warning: consider replacing 'short' with 'int16' [google-runtime-int]
INTERN int jpg_decode_block_seq( BitReader* huffr, huffTree* dctree, huffTree* actree, short* block );
                                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:417:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_encode_block_seq( BitWriter* huffw, huffCodes* dctbl, huffCodes* actbl, short* block );
       ~~~ ^
       auto                                                                                           -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:417:88: warning: consider replacing 'short' with 'int16' [google-runtime-int]
INTERN int jpg_encode_block_seq( BitWriter* huffw, huffCodes* dctbl, huffCodes* actbl, short* block );
                                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:419:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_decode_dc_prg_fs( BitReader* huffr, huffTree* dctree, short* block );
       ~~~ ^
       auto                                                                         -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:419:70: warning: consider replacing 'short' with 'int16' [google-runtime-int]
INTERN int jpg_decode_dc_prg_fs( BitReader* huffr, huffTree* dctree, short* block );
                                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:420:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_encode_dc_prg_fs( BitWriter* huffw, huffCodes* dctbl, short* block );
       ~~~ ^
       auto                                                                         -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:420:70: warning: consider replacing 'short' with 'int16' [google-runtime-int]
INTERN int jpg_encode_dc_prg_fs( BitWriter* huffw, huffCodes* dctbl, short* block );
                                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:421:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_decode_ac_prg_fs( BitReader* huffr, huffTree* actree, short* block,
       ~~~ ^
       auto
/home/mangix/devstuff/packJPG/source/packjpg.cpp:421:70: warning: consider replacing 'short' with 'int16' [google-runtime-int]
INTERN int jpg_decode_ac_prg_fs( BitReader* huffr, huffTree* actree, short* block,
                                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:423:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_encode_ac_prg_fs( BitWriter* huffw, huffCodes* actbl, short* block,
       ~~~ ^
       auto
/home/mangix/devstuff/packJPG/source/packjpg.cpp:423:70: warning: consider replacing 'short' with 'int16' [google-runtime-int]
INTERN int jpg_encode_ac_prg_fs( BitWriter* huffw, huffCodes* actbl, short* block,
                                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:426:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_decode_dc_prg_sa( BitReader* huffr, short* block );
       ~~~ ^
       auto                                                       -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:426:52: warning: consider replacing 'short' with 'int16' [google-runtime-int]
INTERN int jpg_decode_dc_prg_sa( BitReader* huffr, short* block );
                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:427:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_encode_dc_prg_sa( BitWriter* huffw, short* block );
       ~~~ ^
       auto                                                       -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:427:52: warning: consider replacing 'short' with 'int16' [google-runtime-int]
INTERN int jpg_encode_dc_prg_sa( BitWriter* huffw, short* block );
                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:428:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_decode_ac_prg_sa( BitReader* huffr, huffTree* actree, short* block,
       ~~~ ^
       auto
/home/mangix/devstuff/packJPG/source/packjpg.cpp:428:70: warning: consider replacing 'short' with 'int16' [google-runtime-int]
INTERN int jpg_decode_ac_prg_sa( BitReader* huffr, huffTree* actree, short* block,
                                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:430:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_encode_ac_prg_sa( BitWriter* huffw, std::vector<std::uint8_t>& storw, huffCodes* actbl,
       ~~~ ^
       auto
/home/mangix/devstuff/packJPG/source/packjpg.cpp:430:79: warning: non-const reference parameter 'storw', make it const or use a pointer [google-runtime-references]
INTERN int jpg_encode_ac_prg_sa( BitWriter* huffw, std::vector<std::uint8_t>& storw, huffCodes* actbl,
                                                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:431:7: warning: consider replacing 'short' with 'int16' [google-runtime-int]
                                                short* block, int* eobrun, int from, int to );
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:433:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_decode_eobrun_sa( BitReader* huffr, short* block, int* eobrun, int from, int to );
       ~~~ ^
       auto                                                                                      -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:433:52: warning: consider replacing 'short' with 'int16' [google-runtime-int]
INTERN int jpg_decode_eobrun_sa( BitReader* huffr, short* block, int* eobrun, int from, int to );
                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:434:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_encode_eobrun( BitWriter* huffw, huffCodes* actbl, int* eobrun );
       ~~~ ^
       auto                                                                     -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:435:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_encode_crbits( BitWriter* huffw, std::vector<std::uint8_t>& storw );
       ~~~ ^
       auto                                                                        -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:435:76: warning: non-const reference parameter 'storw', make it const or use a pointer [google-runtime-references]
INTERN int jpg_encode_crbits( BitWriter* huffw, std::vector<std::uint8_t>& storw );
                                                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:437:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_next_huffcode( BitReader *huffw, huffTree *ctree );
       ~~~ ^
       auto                                                       -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:438:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_next_mcupos( int* mcu, int* cmp, int* csc, int* sub, int* dpos, int* rstw );
       ~~~ ^
       auto                                                                                -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:439:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_next_mcuposn( int* cmp, int* dpos, int* rstw );
       ~~~ ^
       auto                                                   -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:440:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_skip_eobrun( int* cmp, int* dpos, int* rstw, int* eobrun );
       ~~~ ^
       auto                                                               -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:449:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_encode_zstscan( ArithmeticEncoder* enc, int cmp );
       ~~~~ ^
       auto                                                       -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:450:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_encode_zdst_high( ArithmeticEncoder* enc, int cmp );
       ~~~~ ^
       auto                                                         -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:451:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_encode_zdst_low( ArithmeticEncoder* enc, int cmp );
       ~~~~ ^
       auto                                                        -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:452:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_encode_dc( ArithmeticEncoder* enc, int cmp );
       ~~~~ ^
       auto                                                  -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:453:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_encode_ac_high( ArithmeticEncoder* enc, int cmp );
       ~~~~ ^
       auto                                                       -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:454:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_encode_ac_low( ArithmeticEncoder* enc, int cmp );
       ~~~~ ^
       auto                                                      -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:455:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_encode_generic( ArithmeticEncoder* enc, unsigned char* data, int len );
       ~~~~ ^
       auto                                                                            -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:456:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_encode_bit( ArithmeticEncoder* enc, unsigned char bit );
       ~~~~ ^
       auto                                                             -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:458:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_decode_zstscan( ArithmeticDecoder* dec, int cmp );
       ~~~~ ^
       auto                                                       -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:459:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_decode_zdst_high( ArithmeticDecoder* dec, int cmp );
       ~~~~ ^
       auto                                                         -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:460:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_decode_zdst_low( ArithmeticDecoder* dec, int cmp );
       ~~~~ ^
       auto                                                        -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:461:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_decode_dc( ArithmeticDecoder* dec, int cmp );
       ~~~~ ^
       auto                                                  -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:462:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_decode_ac_high( ArithmeticDecoder* dec, int cmp );
       ~~~~ ^
       auto                                                       -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:463:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_decode_ac_low( ArithmeticDecoder* dec, int cmp );
       ~~~~ ^
       auto                                                      -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:464:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_decode_generic( ArithmeticDecoder* dec, unsigned char** data, int* len );
       ~~~~ ^
       auto                                                                              -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:465:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_decode_bit( ArithmeticDecoder* dec, unsigned char* bit );
       ~~~~ ^
       auto                                                              -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:468:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_optimize_header( void );
       ~~~~ ^
       auto                             -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:468:34: warning: redundant void argument list in function declaration [modernize-redundant-void-arg]
INTERN bool pjg_optimize_header( void );
                                 ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:469:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_unoptimize_header( void );
       ~~~~ ^
       auto                               -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:469:36: warning: redundant void argument list in function declaration [modernize-redundant-void-arg]
INTERN bool pjg_unoptimize_header( void );
                                   ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:471:32: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
INTERN void pjg_aavrg_prepare( unsigned short** abs_coeffs, int* weights, unsigned short* abs_store, int cmp );
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:471:75: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
INTERN void pjg_aavrg_prepare( unsigned short** abs_coeffs, int* weights, unsigned short* abs_store, int cmp );
                                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:472:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int pjg_aavrg_context( unsigned short** abs_coeffs, int* weights, int pos, int p_y, int p_x, int r_x );
       ~~~ ^
       auto                                                                                                   -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:472:31: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
INTERN int pjg_aavrg_context( unsigned short** abs_coeffs, int* weights, int pos, int p_y, int p_x, int r_x );
                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:473:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int pjg_lakh_context( signed short** coeffs_x, signed short** coeffs_a, int* pred_cf, int pos );
       ~~~ ^
       auto                                                                                            -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:473:30: warning: consider replacing 'short' with 'int16' [google-runtime-int]
INTERN int pjg_lakh_context( signed short** coeffs_x, signed short** coeffs_a, int* pred_cf, int pos );
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:473:55: warning: consider replacing 'short' with 'int16' [google-runtime-int]
INTERN int pjg_lakh_context( signed short** coeffs_x, signed short** coeffs_a, int* pred_cf, int pos );
                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:484:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int idct_2d_fst_1x8( int cmp, int dpos, int ix, int iy );
       ~~~ ^
       auto                                                     -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:485:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int idct_2d_fst_8x1( int cmp, int dpos, int ix, int iy );
       ~~~ ^
       auto                                                     -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:495:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int dc_1ddct_predictor( int cmp, int dpos );
       ~~~ ^
       auto                                        -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:497:19: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN inline int plocoi( int a, int b, int c );
              ~~~ ^
              auto                              -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:498:19: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN inline int median_int( int* values, int size );
              ~~~ ^
              auto                                    -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:499:21: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN inline float median_float( float* values, int size );
              ~~~~~ ^
              auto                                          -> float
/home/mangix/devstuff/packJPG/source/packjpg.cpp:507:21: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN inline char* create_filename( const char* base, const char* extension );
              ~~~~~ ^
              auto                                                             -> char*
/home/mangix/devstuff/packJPG/source/packjpg.cpp:508:21: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN inline char* unique_filename( const char* base, const char* extension );
              ~~~~~ ^
              auto                                                             -> char*
/home/mangix/devstuff/packJPG/source/packjpg.cpp:512:20: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN inline bool file_exists( const char* filename );
              ~~~~ ^
              auto                                     -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:548:8: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
INTERN unsigned short qtables[4][64];                           // quantization tables
       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:548:8: warning: do not declare C-style arrays, use std::array<> instead [modernize-avoid-c-arrays]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:548:34: warning: 64 is a magic number; consider replacing it with a named constant [readability-magic-numbers]
INTERN unsigned short qtables[4][64];                           // quantization tables
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:549:1: warning: static objects are disallowed; if possible, use a constexpr constructor instead [fuchsia-statically-constructed-objects]
INTERN huffCodes      hcodes[2][4];                             // huffman codes
^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:296:16: note: expanded from macro 'INTERN'
#define INTERN static
               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:549:8: warning: do not declare C-style arrays, use std::array<> instead [hicpp-avoid-c-arrays]
INTERN huffCodes      hcodes[2][4];                             // huffman codes
       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:550:1: warning: static objects are disallowed; if possible, use a constexpr constructor instead [fuchsia-statically-constructed-objects]
INTERN huffTree       htrees[2][4];                             // huffman decoding trees
^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:296:16: note: expanded from macro 'INTERN'
#define INTERN static
               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:550:8: warning: do not declare C-style arrays, use std::array<> instead [modernize-avoid-c-arrays]
INTERN huffTree       htrees[2][4];                             // huffman decoding trees
       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:551:8: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
INTERN unsigned char  htset[2][4];                                      // 1 if huffman table is set
       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:568:8: warning: do not declare C-style arrays, use std::array<> instead [hicpp-avoid-c-arrays]
INTERN unsigned char* zdstdata[4]      = { nullptr }; // zero distribution (# of non-zeroes) lists (for higher 7x7 block)
       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:569:8: warning: do not declare C-style arrays, use std::array<> instead [hicpp-avoid-c-arrays]
INTERN unsigned char* eobxhigh[4]      = { nullptr }; // eob in x direction (for higher 7x7 block)
       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:570:8: warning: do not declare C-style arrays, use std::array<> instead [modernize-avoid-c-arrays]
INTERN unsigned char* eobyhigh[4]      = { nullptr }; // eob in y direction (for higher 7x7 block)
       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:571:8: warning: do not declare C-style arrays, use std::array<> instead [hicpp-avoid-c-arrays]
INTERN unsigned char* zdstxlow[4]               = { nullptr }; // # of non zeroes for first row
       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:572:8: warning: do not declare C-style arrays, use std::array<> instead [hicpp-avoid-c-arrays]
INTERN unsigned char* zdstylow[4]               = { nullptr }; // # of non zeroes for first collumn
       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:573:8: warning: consider replacing 'short' with 'int16' [google-runtime-int]
INTERN signed short*  colldata[4][64]  = {{nullptr}}; // collection sorted DCT coefficients
       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:573:8: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:573:35: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
INTERN signed short*  colldata[4][64]  = {{nullptr}}; // collection sorted DCT coefficients
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:575:8: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
INTERN unsigned char* freqscan[4]      = { nullptr }; // optimized order for frequency scans (only pointers to scans)
       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:576:8: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
INTERN unsigned char  zsrtscan[4][64];                          // zero optimized frequency scan
       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:576:35: warning: 64 is a magic number; consider replacing it with a named constant [readability-magic-numbers]
INTERN unsigned char  zsrtscan[4][64];                          // zero optimized frequency scan
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:578:8: warning: do not declare C-style arrays, use std::array<> instead [hicpp-avoid-c-arrays]
INTERN int adpt_idct_8x8[ 4 ][ 8 * 8 * 8 * 8 ]; // precalculated/adapted values for idct (8x8)
       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:578:32: warning: 8 is a magic number; consider replacing it with a named constant [readability-magic-numbers]
INTERN int adpt_idct_8x8[ 4 ][ 8 * 8 * 8 * 8 ]; // precalculated/adapted values for idct (8x8)
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:578:36: warning: 8 is a magic number; consider replacing it with a named constant [readability-magic-numbers]
INTERN int adpt_idct_8x8[ 4 ][ 8 * 8 * 8 * 8 ]; // precalculated/adapted values for idct (8x8)
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:578:40: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
INTERN int adpt_idct_8x8[ 4 ][ 8 * 8 * 8 * 8 ]; // precalculated/adapted values for idct (8x8)
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:578:44: warning: 8 is a magic number; consider replacing it with a named constant [readability-magic-numbers]
INTERN int adpt_idct_8x8[ 4 ][ 8 * 8 * 8 * 8 ]; // precalculated/adapted values for idct (8x8)
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:579:8: warning: do not declare C-style arrays, use std::array<> instead [hicpp-avoid-c-arrays]
INTERN int adpt_idct_1x8[ 4 ][ 1 * 1 * 8 * 8 ]; // precalculated/adapted values for idct (1x8)
       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:579:40: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
INTERN int adpt_idct_1x8[ 4 ][ 1 * 1 * 8 * 8 ]; // precalculated/adapted values for idct (1x8)
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:579:44: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
INTERN int adpt_idct_1x8[ 4 ][ 1 * 1 * 8 * 8 ]; // precalculated/adapted values for idct (1x8)
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:580:8: warning: do not declare C-style arrays, use std::array<> instead [modernize-avoid-c-arrays]
INTERN int adpt_idct_8x1[ 4 ][ 8 * 8 * 1 * 1 ]; // precalculated/adapted values for idct (8x1)
       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:580:32: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
INTERN int adpt_idct_8x1[ 4 ][ 8 * 8 * 1 * 1 ]; // precalculated/adapted values for idct (8x1)
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:580:36: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
INTERN int adpt_idct_8x1[ 4 ][ 8 * 8 * 1 * 1 ]; // precalculated/adapted values for idct (8x1)
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:588:1: warning: static objects are disallowed; if possible, use a constexpr constructor instead [fuchsia-statically-constructed-objects]
INTERN componentInfo cmpnfo[ 4 ];
^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:296:16: note: expanded from macro 'INTERN'
#define INTERN static
               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:588:8: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
INTERN componentInfo cmpnfo[ 4 ];
       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:606:8: warning: do not declare C-style arrays, use std::array<> instead [modernize-avoid-c-arrays]
INTERN int cs_cmp[ 4 ]  = { 0 }; // component numbers  in current scan
       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:623:1: warning: static objects are disallowed; if possible, use a constexpr constructor instead [fuchsia-statically-constructed-objects]
INTERN std::unique_ptr<Reader> str_in;  // input stream
^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:296:16: note: expanded from macro 'INTERN'
#define INTERN static
               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:624:1: warning: static objects are disallowed; if possible, use a constexpr constructor instead [fuchsia-statically-constructed-objects]
INTERN std::unique_ptr<Writer> str_out; // output stream
^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:296:16: note: expanded from macro 'INTERN'
#define INTERN static
               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:627:1: warning: static objects are disallowed; if possible, use a constexpr constructor instead [fuchsia-statically-constructed-objects]
INTERN std::unique_ptr<Reader> str_str; // storage stream
^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:296:16: note: expanded from macro 'INTERN'
#define INTERN static
               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:653:8: warning: do not declare C-style arrays, use std::array<> instead [modernize-avoid-c-arrays]
INTERN char errormessage [ MSG_SIZE ];
       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:688:8: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
INTERN unsigned char nois_trs[ 4 ] = {6,6,6,6}; // bit pattern noise threshold
       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:688:39: warning: 6 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
INTERN unsigned char nois_trs[ 4 ] = {6,6,6,6}; // bit pattern noise threshold
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:688:41: warning: 6 is a magic number; consider replacing it with a named constant [readability-magic-numbers]
INTERN unsigned char nois_trs[ 4 ] = {6,6,6,6}; // bit pattern noise threshold
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:688:43: warning: 6 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
INTERN unsigned char nois_trs[ 4 ] = {6,6,6,6}; // bit pattern noise threshold
                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:688:45: warning: 6 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
INTERN unsigned char nois_trs[ 4 ] = {6,6,6,6}; // bit pattern noise threshold
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:689:8: warning: do not declare C-style arrays, use std::array<> instead [modernize-avoid-c-arrays]
INTERN unsigned char segm_cnt[ 4 ] = {10,10,10,10}; // number of segments
       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:689:39: warning: 10 is a magic number; consider replacing it with a named constant [readability-magic-numbers]
INTERN unsigned char segm_cnt[ 4 ] = {10,10,10,10}; // number of segments
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:689:42: warning: 10 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
INTERN unsigned char segm_cnt[ 4 ] = {10,10,10,10}; // number of segments
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:689:45: warning: 10 is a magic number; consider replacing it with a named constant [readability-magic-numbers]
INTERN unsigned char segm_cnt[ 4 ] = {10,10,10,10}; // number of segments
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:689:48: warning: 10 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
INTERN unsigned char segm_cnt[ 4 ] = {10,10,10,10}; // number of segments
                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:691:8: warning: do not declare C-style arrays, use std::array<> instead [modernize-avoid-c-arrays]
INTERN unsigned char orig_set[ 8 ] = { 0 }; // store array for settings
       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:691:32: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
INTERN unsigned char orig_set[ 8 ] = { 0 }; // store array for settings
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:712:14: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
INTERN const char   pjg_magic[] = { 'J', 'S' };
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:720:5: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
int main( int argc, char** argv )
~~~ ^
auto                              -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:722:2: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
        sprintf( errormessage, "no errormessage specified" );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:722:11: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
        sprintf( errormessage, "no errormessage specified" );
                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:724:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        clock_t begin, end;
        ^~~~~~~~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:743:2: warning: do not call c-style vararg functions [hicpp-vararg]
        fprintf( msgout,  "\n--> %s v%i.%i%s (%s) by %s <--\n",
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:744:27: warning: 10 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        apptitle, appversion / 10, appversion % 10, subversion, versiondate, author );
                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:744:44: warning: 10 is a magic number; consider replacing it with a named constant [readability-magic-numbers]
                        apptitle, appversion / 10, appversion % 10, subversion, versiondate, author );
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:745:2: warning: do not call c-style vararg functions [hicpp-vararg]
        fprintf( msgout, "Copyright %s\nAll rights reserved\n\n", copyright );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:756:3: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                fprintf( msgout,  " custom compression settings: \n" );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:757:3: warning: do not call c-style vararg functions [hicpp-vararg]
                fprintf( msgout,  " -------------------------------------------------\n" );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:758:3: warning: do not call c-style vararg functions [hicpp-vararg]
                fprintf( msgout,  " no of segments    ->  %3i[0] %3i[1] %3i[2] %3i[3]\n",
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:760:3: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                fprintf( msgout,  " noise threshold   ->  %3i[0] %3i[1] %3i[2] %3i[3]\n",
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:762:3: warning: do not call c-style vararg functions [hicpp-vararg]
                fprintf( msgout,  " -------------------------------------------------\n\n" );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:775:4: warning: assigning newly created 'gsl::owner<>' to non-owner 'char *' [cppcoreguidelines-owning-memory]
                        err_list[ file_no ] = static_cast<char*>(calloc( MSG_SIZE, sizeof( char ) ));
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:775:4: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:775:45: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
                        err_list[ file_no ] = static_cast<char*>(calloc( MSG_SIZE, sizeof( char ) ));
                                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:776:4: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        err_tp[ file_no ] = errorlevel;
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:777:9: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        if ( err_list[ file_no ] != nullptr )
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:777:41: warning: statement should be inside braces [google-readability-braces-around-statements]
                        if ( err_list[ file_no ] != nullptr )
                                                             ^
                                                              {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:778:5: warning: Call to function 'strcpy' is insecure as it does not provide bounding of the memory buffer. Replace unbounded copy functions with analogous functions that support length arguments such as 'strlcpy'. CWE-119 [clang-analyzer-security.insecureAPI.strcpy]
                                strcpy( err_list[ file_no ], errormessage );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:778:5: note: Call to function 'strcpy' is insecure as it does not provide bounding of the memory buffer. Replace unbounded copy functions with analogous functions that support length arguments such as 'strlcpy'. CWE-119
/home/mangix/devstuff/packJPG/source/packjpg.cpp:778:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                strcpy( err_list[ file_no ], errormessage );
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:778:34: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [hicpp-no-array-decay]
                                strcpy( err_list[ file_no ], errormessage );
                                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:781:31: warning: statement should be inside braces [google-readability-braces-around-statements]
                if ( errorlevel >= err_tol ) error_cnt++;
                                            ^
                                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:783:26: warning: statement should be inside braces [hicpp-braces-around-statements]
                        if ( errorlevel == 1 ) warn_cnt++;
                                              ^
                                               {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:794:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        fprintf( stderr, "\n\nfiles with errors:\n" );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:795:4: warning: do not call c-style vararg functions [hicpp-vararg]
                        fprintf( stderr, "------------------\n" );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:797:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                if ( err_tp[ file_no ] >= err_tol ) {
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:798:6: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                        fprintf( stderr, "%s (%s)\n", filelist[ file_no ], err_list[ file_no ] );
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:798:36: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                        fprintf( stderr, "%s (%s)\n", filelist[ file_no ], err_list[ file_no ] );
                                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:798:57: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                        fprintf( stderr, "%s (%s)\n", filelist[ file_no ], err_list[ file_no ] );
                                                                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:804:4: warning: do not call c-style vararg functions [hicpp-vararg]
                        fprintf( stderr, "\n\nfiles with warnings:\n" );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:805:4: warning: do not call c-style vararg functions [hicpp-vararg]
                        fprintf( stderr, "------------------\n" );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:807:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                if ( err_tp[ file_no ] == 1 ) {
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:808:6: warning: do not call c-style vararg functions [hicpp-vararg]
                                        fprintf( stderr, "%s (%s)\n", filelist[ file_no ], err_list[ file_no ] );
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:808:36: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                        fprintf( stderr, "%s (%s)\n", filelist[ file_no ], err_list[ file_no ] );
                                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:808:57: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                        fprintf( stderr, "%s (%s)\n", filelist[ file_no ], err_list[ file_no ] );
                                                                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:815:2: warning: do not call c-style vararg functions [hicpp-vararg]
        fprintf( msgout,  "\n\n-> %i file(s) processed, %i error(s), %i warning(s)\n",
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:819:18: warning: 1024.0 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                acc_jpgsize /= 1024.0; acc_pjgsize /= 1024.0;
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:819:41: warning: 1024.0 is a magic number; consider replacing it with a named constant [readability-magic-numbers]
                acc_jpgsize /= 1024.0; acc_pjgsize /= 1024.0;
                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:821:27: warning: narrowing conversion from 'double' to 'int' [bugprone-narrowing-conversions]
                kbps  = ( total > 0 ) ? ( acc_jpgsize / total ) : acc_jpgsize;
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:821:53: warning: narrowing conversion from 'double' to 'int' [cppcoreguidelines-narrowing-conversions]
                kbps  = ( total > 0 ) ? ( acc_jpgsize / total ) : acc_jpgsize;
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:824:3: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                fprintf( msgout,  " --------------------------------- \n" );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:826:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        fprintf( msgout,  " total time        : %8.2f sec\n", total );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:827:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        fprintf( msgout,  " avrg. kbyte per s : %8i byte\n", kbps );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:830:4: warning: do not call c-style vararg functions [hicpp-vararg]
                        fprintf( msgout,  " total time        : %8s sec\n", "N/A" );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:831:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        fprintf( msgout,  " avrg. kbyte per s : %8s byte\n", "N/A" );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:833:3: warning: do not call c-style vararg functions [hicpp-vararg]
                fprintf( msgout,  " avrg. comp. ratio : %8.2f %%\n", cr );              
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:834:3: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                fprintf( msgout,  " --------------------------------- \n" );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:859:3: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                fprintf( msgout, "\n\n< press ENTER >\n" );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1170:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'char **' [cppcoreguidelines-owning-memory]
        filelist = static_cast<char**>(calloc( argc, sizeof( char* ) ));
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1170:33: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
        filelist = static_cast<char**>(calloc( argc, sizeof( char* ) ));
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1171:30: warning: statement should be inside braces [hicpp-braces-around-statements]
        for ( i = 0; i < argc; i++ )
                                    ^
                                     {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1172:3: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                filelist[ i ] = nullptr;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1180:7: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                argv++;
                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1191:13: warning: 'sscanf' used to convert a string to an integer value, but function will not report conversion errors; consider using 'strtol' instead [cert-err34-c]
                else if ( sscanf( (*argv), "-v%i", &tmp_val ) == 1 ){
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1191:13: warning: do not call c-style vararg functions [hicpp-vararg]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1281:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        *(tmp_flp++) = (char*) "-";
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1281:19: warning: C-style casts are discouraged; use static_cast/const_cast/reinterpret_cast [google-readability-casting]
                        *(tmp_flp++) = (char*) "-";
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1281:19: warning: do not use C-style cast to cast away constness [cppcoreguidelines-pro-type-cstyle-cast]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1285:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        *(tmp_flp++) = *argv;
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1290:22: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        for ( file_cnt = 0; filelist[ file_cnt ] != nullptr; file_cnt++ );
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1290:67: warning: statement should be inside braces [readability-braces-around-statements]
        for ( file_cnt = 0; filelist[ file_cnt ] != nullptr; file_cnt++ );
                                                                         ^
                                                                          {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1293:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'char **' [cppcoreguidelines-owning-memory]
        err_list = static_cast<char**>(calloc( file_cnt, sizeof( char* ) ));
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1293:33: warning: Call to 'calloc' has an allocation size of 0 bytes [clang-analyzer-optin.portability.UnixAPI]
        err_list = static_cast<char**>(calloc( file_cnt, sizeof( char* ) ));
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:740:2: note: Calling 'initialize_options'
        initialize_options( argc, argv );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1171:15: note: 'i' is < 'argc'
        for ( i = 0; i < argc; i++ )
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1171:2: note: Loop condition is true.  Entering loop body
        for ( i = 0; i < argc; i++ )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1171:15: note: Assuming 'i' is >= 'argc'
        for ( i = 0; i < argc; i++ )
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1171:2: note: Loop condition is false. Execution continues on line 1175
        for ( i = 0; i < argc; i++ )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1179:2: note: Loop condition is false. Execution continues on line 1290
        while ( --argc > 0 ) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1290:8: note: The value 0 is assigned to 'file_cnt'
        for ( file_cnt = 0; filelist[ file_cnt ] != nullptr; file_cnt++ );
              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1290:2: note: Loop condition is false. Execution continues on line 1293
        for ( file_cnt = 0; filelist[ file_cnt ] != nullptr; file_cnt++ );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1293:33: note: Call to 'calloc' has an allocation size of 0 bytes
        err_list = static_cast<char**>(calloc( file_cnt, sizeof( char* ) ));
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1293:33: warning: do not manage memory manually; consider a container or a smart pointer [hicpp-no-malloc]
        err_list = static_cast<char**>(calloc( file_cnt, sizeof( char* ) ));
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1294:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'int *' [cppcoreguidelines-owning-memory]
        err_tp   = static_cast<int*>(calloc( file_cnt, sizeof( int ) ));
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1294:31: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
        err_tp   = static_cast<int*>(calloc( file_cnt, sizeof( int ) ));
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1303:13: warning: 5 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                orig_set[ 5 ] = segm_cnt[ 1 ];
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1304:13: warning: 6 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                orig_set[ 6 ] = segm_cnt[ 2 ];
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1305:13: warning: 7 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                orig_set[ 7 ] = segm_cnt[ 3 ];
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1308:20: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                for ( i = 0; i < 8; i++ )
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1308:28: warning: statement should be inside braces [google-readability-braces-around-statements]
                for ( i = 0; i < 8; i++ )
                                         ^
                                          {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1309:4: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        orig_set[ i ] = 0;
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1320:25: warning: redundant void argument list in function definition [modernize-redundant-void-arg]
INTERN void process_ui( void )
                        ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1322:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        clock_t begin, end;
        ^~~~~~~~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1325:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int total, bpms;
        ^~~~~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1338:17: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        if ( ( strcmp( filelist[ file_no ], "-" ) == 0 ) && ( action == A_COMPRESS ) ) {
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1340:3: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                filelist[ file_no ] = (char*) "STDIN";
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1340:25: warning: C-style casts are discouraged; use static_cast/const_cast/reinterpret_cast [google-readability-casting]
                filelist[ file_no ] = (char*) "STDIN";
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1340:25: warning: do not use C-style cast to cast away constness [cppcoreguidelines-pro-type-cstyle-cast]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1347:3: warning: do not call c-style vararg functions [hicpp-vararg]
                fprintf( msgout,  "\nProcessing file %i of %i \"%s\" -> ",
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1348:29: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                        file_no + 1, file_cnt, filelist[ file_no ] );
                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1350:23: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( verbosity > 1 )
                                    ^
                                     {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1351:4: warning: do not call c-style vararg functions [hicpp-vararg]
                        fprintf( msgout,  "\n----------------------------------------" );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1357:27: warning: statement should be inside braces [readability-braces-around-statements]
                if ( filetype == F_UNK ) actionmsg = "unknown filetype";
                                        ^
                                         {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1358:7: warning: statement should be inside braces [google-readability-braces-around-statements]
                else switch ( action ) {
                    ^
                     {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1358:8: warning: potential uncovered code path; add a default label [hicpp-multiway-paths-covered]
                else switch ( action ) {
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1369:23: warning: statement should be inside braces [readability-braces-around-statements]
                if ( verbosity < 2 ) fprintf( msgout, "%s -> ", actionmsg );
                                    ^
                                     {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1369:24: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                if ( verbosity < 2 ) fprintf( msgout, "%s -> ", actionmsg );
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1373:3: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                fprintf( msgout, "Processing file %2i of %2i ", file_no + 1, file_cnt );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1375:3: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                fprintf( msgout, "\r" );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1394:37: warning: statement should be inside braces [hicpp-braces-around-statements]
                        if ( file_exists( pjgfilename ) ) remove( pjgfilename );
                                                         ^
                                                          {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1396:37: warning: statement should be inside braces [readability-braces-around-statements]
                        if ( file_exists( jpgfilename ) ) remove( jpgfilename );
                                                         ^
                                                          {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1403:66: warning: 1000 is a magic number; consider replacing it with a named constant [readability-magic-numbers]
        total = static_cast<int>( static_cast<double>(( end - begin ) * 1000) / CLOCKS_PER_SEC );
                                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1405:32: warning: narrowing conversion from 'double' to 'float' [bugprone-narrowing-conversions]
        cr    = ( jpgfilesize > 0 ) ? ( 100.0 * pjgfilesize / jpgfilesize ) : 0;
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1409:23: warning: statement should be inside braces [google-readability-braces-around-statements]
                if ( verbosity > 1 )
                                    ^
                                     {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1410:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        fprintf( msgout,  "\n----------------------------------------" );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1413:3: warning: potential uncovered code path; add a default label [hicpp-multiway-paths-covered]
                switch ( verbosity ) {
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1416:33: warning: statement should be inside braces [google-readability-braces-around-statements]
                                        if ( action == A_COMPRESS ) fprintf( msgout,  "%.2f%%", cr );
                                                                   ^
                                                                    {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1416:34: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                        if ( action == A_COMPRESS ) fprintf( msgout,  "%.2f%%", cr );
                                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1417:10: warning: statement should be inside braces [hicpp-braces-around-statements]
                                        else fprintf( msgout, "DONE" );
                                            ^
                                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1417:11: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                        else fprintf( msgout, "DONE" );
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1419:9: warning: statement should be inside braces [hicpp-braces-around-statements]
                                else fprintf( msgout,  "ERROR" );
                                    ^
                                     {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1419:10: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                else fprintf( msgout,  "ERROR" );
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1420:26: warning: statement should be inside braces [hicpp-braces-around-statements]
                                if ( errorlevel > 0 ) fprintf( msgout,  "\n" );
                                                     ^
                                                      {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1420:27: warning: do not call c-style vararg functions [hicpp-vararg]
                                if ( errorlevel > 0 ) fprintf( msgout,  "\n" );
                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1424:5: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                fprintf( msgout, "%s\n",  ( errorlevel < err_tol ) ? "DONE" : "ERROR" );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1428:32: warning: statement should be inside braces [hicpp-braces-around-statements]
                                if ( errorlevel < err_tol ) fprintf( msgout,  "\n-> %s OK\n", actionmsg );
                                                           ^
                                                            {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1428:33: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                if ( errorlevel < err_tol ) fprintf( msgout,  "\n-> %s OK\n", actionmsg );
                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1429:9: warning: statement should be inside braces [readability-braces-around-statements]
                                else  fprintf( msgout,  "\n-> %s ERROR\n", actionmsg );
                                    ^
                                     {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1429:11: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                else  fprintf( msgout,  "\n-> %s ERROR\n", actionmsg );
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1434:3: warning: potential uncovered code path; add a default label [hicpp-multiway-paths-covered]
                switch ( errorlevel ) {
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1442:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        fprintf( msgout, " %s -> %s:\n", get_status( errorfunction ), errtypemsg  );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1443:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        fprintf( msgout, " %s\n", errormessage );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1443:30: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        fprintf( msgout, " %s\n", errormessage );
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1447:5: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                fprintf( msgout,  " time taken  : %7i msec\n", total );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1448:5: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                fprintf( msgout,  " byte per ms : %7i byte\n", bpms );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1451:5: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                fprintf( msgout,  " time taken  : %7s msec\n", "N/A" );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1452:5: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                fprintf( msgout,  " byte per ms : %7s byte\n", "N/A" );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1454:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        fprintf( msgout,  " comp. ratio : %7.2f %%\n", cr );            
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1456:55: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( ( verbosity > 1 ) && ( action == A_COMPRESS ) )
                                                                    ^
                                                                     {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1457:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        fprintf( msgout,  "\n" );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1463:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        fprintf( msgout, "Processed %2i of %2i files ", file_no + 1, file_cnt );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1465:4: warning: do not call c-style vararg functions [hicpp-vararg]
                        fprintf( msgout, "\r" );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1477:27: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN inline const char* get_status( bool (*function)() )
              ~~~~~~~~~~~ ^
              auto                                         -> const char*
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1481:4: warning: do not use 'else' after 'return' [readability-else-after-return]
        } else if ( function == *check_file ) {
          ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1481:26: warning: redundant repeated dereference of function pointer [readability-redundant-function-ptr-dereference]
        } else if ( function == *check_file ) {
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1483:26: warning: redundant repeated dereference of function pointer [readability-redundant-function-ptr-dereference]
        } else if ( function == *read_jpeg ) {
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1485:26: warning: redundant repeated dereference of function pointer [readability-redundant-function-ptr-dereference]
        } else if ( function == *merge_jpeg ) {
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1487:26: warning: redundant repeated dereference of function pointer [readability-redundant-function-ptr-dereference]
        } else if ( function == *decode_jpeg ) {
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1489:26: warning: redundant repeated dereference of function pointer [readability-redundant-function-ptr-dereference]
        } else if ( function == *recode_jpeg ) {
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1491:26: warning: redundant repeated dereference of function pointer [readability-redundant-function-ptr-dereference]
        } else if ( function == *adapt_icos ) {
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1493:26: warning: redundant repeated dereference of function pointer [readability-redundant-function-ptr-dereference]
        } else if ( function == *predict_dc ) {
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1495:26: warning: redundant repeated dereference of function pointer [readability-redundant-function-ptr-dereference]
        } else if ( function == *unpredict_dc ) {
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1497:26: warning: redundant repeated dereference of function pointer [readability-redundant-function-ptr-dereference]
        } else if ( function == *check_value_range ) {
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1499:26: warning: redundant repeated dereference of function pointer [readability-redundant-function-ptr-dereference]
        } else if ( function == *calc_zdst_lists ) {
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1501:26: warning: redundant repeated dereference of function pointer [readability-redundant-function-ptr-dereference]
        } else if ( function == *pack_pjg ) {
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1503:26: warning: redundant repeated dereference of function pointer [readability-redundant-function-ptr-dereference]
        } else if ( function == *unpack_pjg ) {
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1505:26: warning: redundant repeated dereference of function pointer [readability-redundant-function-ptr-dereference]
        } else if ( function == *swap_streams ) {
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1507:26: warning: redundant repeated dereference of function pointer [readability-redundant-function-ptr-dereference]
        } else if ( function == *compare_output ) {
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1509:26: warning: redundant repeated dereference of function pointer [readability-redundant-function-ptr-dereference]
        } else if ( function == *reset_buffers ) {
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1543:24: warning: redundant void argument list in function definition [modernize-redundant-void-arg]
INTERN void show_help( void )
                       ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1545:2: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
        fprintf( msgout, "\n" );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1546:2: warning: do not call c-style vararg functions [hicpp-vararg]
        fprintf( msgout, "Website: %s\n", website );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1547:2: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
        fprintf( msgout, "Email  : %s\n", email );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1548:2: warning: do not call c-style vararg functions [hicpp-vararg]
        fprintf( msgout, "\n" );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1549:2: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
        fprintf( msgout, "Usage: %s [switches] [filename(s)]", appname );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1550:2: warning: do not call c-style vararg functions [hicpp-vararg]
        fprintf( msgout, "\n" );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1551:2: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
        fprintf( msgout, "\n" );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1552:2: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
        fprintf( msgout, " [-ver]   verify files after processing\n" );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1553:2: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
        fprintf( msgout, " [-v?]    set level of verbosity (max: 2) (def: 0)\n" );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1554:2: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
        fprintf( msgout, " [-np]    no pause after processing files\n" );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1555:2: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
        fprintf( msgout, " [-o]     overwrite existing files\n" );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1556:2: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
        fprintf( msgout, " [-p]     proceed on warnings\n" );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1557:2: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
        fprintf( msgout, " [-d]     discard meta-info\n" );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1577:2: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
        fprintf( msgout, "\n" );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1578:2: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
        fprintf( msgout, "Examples: \"%s -v1 -o baboon.%s\"\n", appname, pjg_ext );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1579:2: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
        fprintf( msgout, "          \"%s -p *.%s\"\n", appname, jpg_ext );      
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1588:27: warning: redundant void argument list in function definition [modernize-redundant-void-arg]
INTERN void process_file( void )
                          ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1591:3: warning: switch could be better written as an if/else statement [hicpp-multiway-paths-covered]
                switch ( action ) {
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1673:3: warning: switch could be better written as an if/else statement [hicpp-multiway-paths-covered]
                switch ( action )
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1764:3: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
                clock_t begin, end;
                ^~~~~~~~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1770:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        fprintf( msgout,  "\n%s ", get_status( function ) );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1771:57: warning: 30 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        for ( int i = strlen( get_status( function ) ); i <= 30; i++ )
                                                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1771:66: warning: statement should be inside braces [google-readability-braces-around-statements]
                        for ( int i = strlen( get_status( function ) ); i <= 30; i++ )
                                                                                      ^
                                                                                       {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1772:5: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                fprintf( msgout,  " " );                        
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1782:60: warning: statement should be inside braces [google-readability-braces-around-statements]
                if ( ( errorlevel > 0 ) && ( errorfunction == nullptr ) )
                                                                         ^
                                                                          {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1787:68: warning: 1000 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        total = static_cast<int>( static_cast<double>(( end - begin ) * 1000) / CLOCKS_PER_SEC );
                                                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1788:25: warning: statement should be inside braces [hicpp-braces-around-statements]
                        if ( verbosity == 2 ) fprintf( msgout,  "%6ims", ( total >= 0 ) ? total : -1 );
                                             ^
                                              {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1788:26: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        if ( verbosity == 2 ) fprintf( msgout,  "%6ims", ( total >= 0 ) ? total : -1 );
                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1792:25: warning: statement should be inside braces [hicpp-braces-around-statements]
                        if ( verbosity == 2 ) fprintf( msgout,  "%8s", "ERROR" );
                                             ^
                                              {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1792:26: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        if ( verbosity == 2 ) fprintf( msgout,  "%8s", "ERROR" );
                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1815:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool check_file( void )
       ~~~~ ^
       auto                    -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1815:25: warning: redundant void argument list in function definition [modernize-redundant-void-arg]
INTERN bool check_file( void )
                        ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1817:2: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
        unsigned char fileid[ 2 ] = { 0, 0 };
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1818:25: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        const char* filename = filelist[ file_no ];
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1824:42: warning: calling a function that uses a default argument is disallowed [fuchsia-default-arguments-calls]
                        str_in = std::make_unique<FileReader>(std::string(filename));
                                                              ^
/usr/bin/../lib/gcc/x86_64-redhat-linux/9/../../../../include/c++/9/bits/basic_string.h:525:39: note: default parameter was declared here
      basic_string(const _CharT* __s, const _Alloc& __a = _Alloc())
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1827:3: warning: Call to function 'strcpy' is insecure as it does not provide bounding of the memory buffer. Replace unbounded copy functions with analogous functions that support length arguments such as 'strlcpy'. CWE-119 [clang-analyzer-security.insecureAPI.strcpy]
                std::strcpy(errormessage, e.what());
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1827:3: note: Call to function 'strcpy' is insecure as it does not provide bounding of the memory buffer. Replace unbounded copy functions with analogous functions that support length arguments such as 'strlcpy'. CWE-119
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1827:15: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                std::strcpy(errormessage, e.what());
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1834:3: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
                free(jpgfilename);
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1834:3: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1838:3: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
                free(pjgfilename);
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1838:3: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1843:21: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
        if ( str_in->read( fileid, 2 ) != 2 ) { 
                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1845:3: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                sprintf( errormessage, "file doesn't contain enough data" );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1845:12: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                sprintf( errormessage, "file doesn't contain enough data" );
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1851:22: warning: 0xFF is a magic number; consider replacing it with a named constant [readability-magic-numbers]
        if ( ( fileid[0] == 0xFF ) && ( fileid[1] == 0xD8 ) ) {
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1851:47: warning: 0xD8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        if ( ( fileid[0] == 0xFF ) && ( fileid[1] == 0xD8 ) ) {
                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1856:4: warning: assigning newly created 'gsl::owner<>' to non-owner 'char *' [cppcoreguidelines-owning-memory]
                        jpgfilename = static_cast<char*>(calloc( strlen( filename ) + 1, sizeof( char ) ));
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1856:37: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
                        jpgfilename = static_cast<char*>(calloc( strlen( filename ) + 1, sizeof( char ) ));
                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1857:4: warning: Call to function 'strcpy' is insecure as it does not provide bounding of the memory buffer. Replace unbounded copy functions with analogous functions that support length arguments such as 'strlcpy'. CWE-119 [clang-analyzer-security.insecureAPI.strcpy]
                        strcpy( jpgfilename, filename );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1857:4: note: Call to function 'strcpy' is insecure as it does not provide bounding of the memory buffer. Replace unbounded copy functions with analogous functions that support length arguments such as 'strlcpy'. CWE-119
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1859:32: warning: do not use const_cast [cppcoreguidelines-pro-type-const-cast]
                                create_filename( filename, const_cast<char*>(pjg_ext) ) :
                                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1860:32: warning: do not use const_cast [cppcoreguidelines-pro-type-const-cast]
                                unique_filename( filename, const_cast<char*>(pjg_ext) );
                                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1871:44: warning: calling a function that uses a default argument is disallowed [fuchsia-default-arguments-calls]
                                str_out = std::make_unique<FileWriter>(std::string(pjgfilename));
                                                                       ^
/usr/bin/../lib/gcc/x86_64-redhat-linux/9/../../../../include/c++/9/bits/basic_string.h:525:39: note: default parameter was declared here
      basic_string(const _CharT* __s, const _Alloc& __a = _Alloc())
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1874:4: warning: Call to function 'strcpy' is insecure as it does not provide bounding of the memory buffer. Replace unbounded copy functions with analogous functions that support length arguments such as 'strlcpy'. CWE-119 [clang-analyzer-security.insecureAPI.strcpy]
                        std::strcpy(errormessage, e.what());
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1874:4: note: Call to function 'strcpy' is insecure as it does not provide bounding of the memory buffer. Replace unbounded copy functions with analogous functions that support length arguments such as 'strlcpy'. CWE-119
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1874:16: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        std::strcpy(errormessage, e.what());
                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1879:28: warning: statement should be inside braces [google-readability-braces-around-statements]
                if ( orig_set[ 0 ] == 0 )
                                         ^
                                          {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1887:30: warning: 5 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        segm_cnt[ 1 ] = orig_set[ 5 ];
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1888:30: warning: 6 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        segm_cnt[ 2 ] = orig_set[ 6 ];
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1889:30: warning: 7 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        segm_cnt[ 3 ] = orig_set[ 7 ];
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1898:4: warning: assigning newly created 'gsl::owner<>' to non-owner 'char *' [cppcoreguidelines-owning-memory]
                        pjgfilename = static_cast<char*>(calloc( strlen( filename ) + 1, sizeof( char ) ));
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1898:37: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
                        pjgfilename = static_cast<char*>(calloc( strlen( filename ) + 1, sizeof( char ) ));
                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1899:4: warning: Call to function 'strcpy' is insecure as it does not provide bounding of the memory buffer. Replace unbounded copy functions with analogous functions that support length arguments such as 'strlcpy'. CWE-119 [clang-analyzer-security.insecureAPI.strcpy]
                        strcpy( pjgfilename, filename );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1899:4: note: Call to function 'strcpy' is insecure as it does not provide bounding of the memory buffer. Replace unbounded copy functions with analogous functions that support length arguments such as 'strlcpy'. CWE-119
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1901:32: warning: do not use const_cast [cppcoreguidelines-pro-type-const-cast]
                                create_filename( filename, const_cast<char*>(jpg_ext) ) :
                                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1902:32: warning: do not use const_cast [cppcoreguidelines-pro-type-const-cast]
                                unique_filename( filename, const_cast<char*>(jpg_ext) );
                                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1912:52: warning: calling a function that uses a default argument is disallowed [fuchsia-default-arguments-calls]
            str_out = std::make_unique<FileWriter>(std::string(jpgfilename));
                                                   ^
/usr/bin/../lib/gcc/x86_64-redhat-linux/9/../../../../include/c++/9/bits/basic_string.h:525:39: note: default parameter was declared here
      basic_string(const _CharT* __s, const _Alloc& __a = _Alloc())
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1920:3: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                sprintf( errormessage, "filetype of file \"%s\" is unknown", filename );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1920:12: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                sprintf( errormessage, "filetype of file \"%s\" is unknown", filename );
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1936:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool swap_streams( void )        
       ~~~~ ^
       auto                      -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1936:27: warning: redundant void argument list in function definition [modernize-redundant-void-arg]
INTERN bool swap_streams( void )        
                          ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1938:2: warning: do not declare C-style arrays, use std::array<> instead [modernize-avoid-c-arrays]
        unsigned char dmp[ 2 ];
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1946:16: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
        str_in->read( dmp, 2 );
                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1961:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool compare_output( void )
       ~~~~ ^
       auto                        -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1961:29: warning: redundant void argument list in function definition [modernize-redundant-void-arg]
INTERN bool compare_output( void )
                            ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1964:9: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
        sprintf(errormessage, "error in comparison stream");
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1964:17: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
        sprintf(errormessage, "error in comparison stream");
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1967:7: warning: do not use 'else' after 'return' [readability-else-after-return]
    } else if (str_in->error()) {
      ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1968:9: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
        sprintf(errormessage, "error in output stream");
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1968:17: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
        sprintf(errormessage, "error in output stream");
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1972:9: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
        sprintf(errormessage, "error in input stream");
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1972:17: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
        sprintf(errormessage, "error in input stream");
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1981:3: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                sprintf( errormessage, "file sizes do not match" );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1981:12: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                sprintf( errormessage, "file sizes do not match" );
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1991:9: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
        sprintf( errormessage, "difference found at 0x%ld", first_diff );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:1991:18: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
        sprintf( errormessage, "difference found at 0x%ld", first_diff );
                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2004:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool reset_buffers( void )
       ~~~~ ^
       auto                       -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2004:28: warning: redundant void argument list in function definition [modernize-redundant-void-arg]
INTERN bool reset_buffers( void )
                           ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2006:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int cmp, bpos;
        ^~~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2013:28: warning: statement should be inside braces [hicpp-braces-around-statements]
        if ( hdrdata  != nullptr ) free ( hdrdata );
                                  ^
                                   {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2013:29: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        if ( hdrdata  != nullptr ) free ( hdrdata );
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2013:29: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2014:28: warning: statement should be inside braces [hicpp-braces-around-statements]
        if ( huffdata != nullptr ) free ( huffdata );
                                  ^
                                   {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2014:29: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        if ( huffdata != nullptr ) free ( huffdata );
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2014:29: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2015:28: warning: statement should be inside braces [hicpp-braces-around-statements]
        if ( grbgdata != nullptr ) free ( grbgdata );
                                  ^
                                   {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2015:29: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        if ( grbgdata != nullptr ) free ( grbgdata );
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2015:29: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2016:28: warning: statement should be inside braces [hicpp-braces-around-statements]
        if ( rst_err  != nullptr ) free ( rst_err );
                                  ^
                                   {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2016:29: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        if ( rst_err  != nullptr ) free ( rst_err );
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2016:29: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2017:28: warning: statement should be inside braces [readability-braces-around-statements]
        if ( rstp     != nullptr ) free ( rstp );
                                  ^
                                   {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2017:29: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        if ( rstp     != nullptr ) free ( rstp );
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2017:29: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2018:28: warning: statement should be inside braces [hicpp-braces-around-statements]
        if ( scnp     != nullptr ) free ( scnp );
                                  ^
                                   {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2018:29: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        if ( scnp     != nullptr ) free ( scnp );
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2018:29: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2028:8: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( zdstdata[ cmp ] != nullptr ) free( zdstdata[cmp] );
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2028:36: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( zdstdata[ cmp ] != nullptr ) free( zdstdata[cmp] );
                                                 ^
                                                  {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2028:37: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
                if ( zdstdata[ cmp ] != nullptr ) free( zdstdata[cmp] );
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2028:37: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2028:43: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( zdstdata[ cmp ] != nullptr ) free( zdstdata[cmp] );
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2029:8: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( eobxhigh[ cmp ] != nullptr ) free( eobxhigh[cmp] );
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2029:36: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( eobxhigh[ cmp ] != nullptr ) free( eobxhigh[cmp] );
                                                 ^
                                                  {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2029:37: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
                if ( eobxhigh[ cmp ] != nullptr ) free( eobxhigh[cmp] );
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2029:37: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2029:43: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( eobxhigh[ cmp ] != nullptr ) free( eobxhigh[cmp] );
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2030:8: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( eobyhigh[ cmp ] != nullptr ) free( eobyhigh[cmp] );
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2030:36: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( eobyhigh[ cmp ] != nullptr ) free( eobyhigh[cmp] );
                                                 ^
                                                  {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2030:37: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
                if ( eobyhigh[ cmp ] != nullptr ) free( eobyhigh[cmp] );
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2030:37: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2030:43: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( eobyhigh[ cmp ] != nullptr ) free( eobyhigh[cmp] );
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2031:8: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( zdstxlow[ cmp ] != nullptr ) free( zdstxlow[cmp] );
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2031:36: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( zdstxlow[ cmp ] != nullptr ) free( zdstxlow[cmp] );
                                                 ^
                                                  {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2031:37: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
                if ( zdstxlow[ cmp ] != nullptr ) free( zdstxlow[cmp] );
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2031:37: warning: do not manage memory manually; use RAII [hicpp-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2031:43: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( zdstxlow[ cmp ] != nullptr ) free( zdstxlow[cmp] );
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2032:8: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( zdstylow[ cmp ] != nullptr ) free( zdstylow[cmp] );
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2032:36: warning: statement should be inside braces [readability-braces-around-statements]
                if ( zdstylow[ cmp ] != nullptr ) free( zdstylow[cmp] );
                                                 ^
                                                  {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2032:37: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
                if ( zdstylow[ cmp ] != nullptr ) free( zdstylow[cmp] );
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2032:37: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2032:43: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( zdstylow[ cmp ] != nullptr ) free( zdstylow[cmp] );
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2033:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                zdstdata[ cmp ] = nullptr;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2034:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                eobxhigh[ cmp ] = nullptr;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2035:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                eobyhigh[ cmp ] = nullptr;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2036:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                zdstxlow[ cmp ] = nullptr;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2037:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                zdstylow[ cmp ] = nullptr;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2038:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                freqscan[ cmp ] = (unsigned char*) stdscan;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2038:21: warning: C-style casts are discouraged; use static_cast/const_cast/reinterpret_cast [google-readability-casting]
                freqscan[ cmp ] = (unsigned char*) stdscan;
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2038:21: warning: do not use C-style cast to cast away constness [cppcoreguidelines-pro-type-cstyle-cast]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2040:26: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                for ( bpos = 0; bpos < 64; bpos++ ) {
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2041:9: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        if ( colldata[ cmp ][ bpos ] != nullptr ) free( colldata[cmp][bpos] );
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2041:45: warning: statement should be inside braces [hicpp-braces-around-statements]
                        if ( colldata[ cmp ][ bpos ] != nullptr ) free( colldata[cmp][bpos] );
                                                                 ^
                                                                  {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2041:46: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
                        if ( colldata[ cmp ][ bpos ] != nullptr ) free( colldata[cmp][bpos] );
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2041:46: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2041:52: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        if ( colldata[ cmp ][ bpos ] != nullptr ) free( colldata[cmp][bpos] );
                                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2042:4: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        colldata[ cmp ][ bpos ] = nullptr;
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2051:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].sfv = -1;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2052:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].sfh = -1;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2053:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].mbs = -1;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2054:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].bcv = -1;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2055:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].bch = -1;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2056:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].bc  = -1;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2057:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].ncv = -1;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2058:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].nch = -1;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2059:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].nc  = -1;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2060:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].sid = -1;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2061:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].jid = -1;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2062:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].qtable = nullptr;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2063:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].huffdc = -1;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2064:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].huffac = -1;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2082:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                htset[ 0 ][ i ] = 0;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2083:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                htset[ 1 ][ i ] = 0;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2084:26: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                for ( bpos = 0; bpos < 64; bpos++ )
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2084:38: warning: statement should be inside braces [google-readability-braces-around-statements]
                for ( bpos = 0; bpos < 64; bpos++ )
                                                   ^
                                                    {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2085:4: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        qtables[ i ][ bpos ] = 0;
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2103:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool read_jpeg( void )
       ~~~~ ^
       auto                   -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2103:24: warning: redundant void argument list in function definition [modernize-redundant-void-arg]
INTERN bool read_jpeg( void )
                       ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2106:25: warning: 1024 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        unsigned int   ssize = 1024; // current size of segment array
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2122:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'MemoryWriter *' [cppcoreguidelines-owning-memory]
        hdrw = new MemoryWriter();
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2126:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'MemoryWriter *' [cppcoreguidelines-owning-memory]
        huffw = new MemoryWriter();
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2130:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'unsigned char *' [cppcoreguidelines-owning-memory]
        segment = static_cast< unsigned char*>(calloc( ssize, sizeof( char ) ));
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2130:41: warning: Result of 'calloc' is converted to a pointer of type 'unsigned char', which is incompatible with sizeof operand type 'char' [clang-analyzer-unix.MallocSizeof]
        segment = static_cast< unsigned char*>(calloc( ssize, sizeof( char ) ));
                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2130:41: note: Result of 'calloc' is converted to a pointer of type 'unsigned char', which is incompatible with sizeof operand type 'char'
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2130:41: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
        segment = static_cast< unsigned char*>(calloc( ssize, sizeof( char ) ));
                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2132:3: warning: Potential leak of memory pointed to by 'hdrw' [clang-analyzer-cplusplus.NewDeleteLeaks]
                sprintf( errormessage, MEM_ERRMSG );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2122:9: note: Memory is allocated
        hdrw = new MemoryWriter();
               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2131:7: note: Assuming the condition is true
        if ( segment == nullptr ) {
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2131:2: note: Taking true branch
        if ( segment == nullptr ) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2132:3: note: Potential leak of memory pointed to by 'hdrw'
                sprintf( errormessage, MEM_ERRMSG );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2132:3: warning: Potential leak of memory pointed to by 'huffw' [clang-analyzer-cplusplus.NewDeleteLeaks]
                sprintf( errormessage, MEM_ERRMSG );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2126:10: note: Memory is allocated
        huffw = new MemoryWriter();
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2131:7: note: Assuming the condition is true
        if ( segment == nullptr ) {
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2131:2: note: Taking true branch
        if ( segment == nullptr ) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2132:3: note: Potential leak of memory pointed to by 'huffw'
                sprintf( errormessage, MEM_ERRMSG );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2132:3: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                sprintf( errormessage, MEM_ERRMSG );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2132:12: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                sprintf( errormessage, MEM_ERRMSG );
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2139:16: warning: 0xDA is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                if ( type == 0xDA ) { // if last marker was sos
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2145:10: warning: implicit conversion bool -> 'int' [readability-implicit-bool-conversion]
                                if ( str_in->read_byte(&tmp) == 0 )
                                     ^
                                     static_cast<int>(      )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2145:40: warning: statement should be inside braces [hicpp-braces-around-statements]
                                if ( str_in->read_byte(&tmp) == 0 )
                                                                   ^
                                                                    {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2149:17: warning: 0xFF is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                if ( tmp != 0xFF ) {
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2151:21: warning: 0xFF is a magic number; consider replacing it with a named constant [readability-magic-numbers]
                                        while ( tmp != 0xFF ) {
                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2153:12: warning: implicit conversion bool -> 'int' [readability-implicit-bool-conversion]
                                                if ( str_in->read_byte(&tmp) == 0 )
                                                     ^
                                                     static_cast<int>(      )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2153:42: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                if ( str_in->read_byte(&tmp) == 0 )
                                                                                   ^
                                                                                    {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2159:17: warning: 0xFF is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                if ( tmp == 0xFF ) {
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2160:11: warning: implicit conversion bool -> 'int' [readability-implicit-bool-conversion]
                                        if ( str_in->read_byte(&tmp) == 0 )
                                             ^
                                             static_cast<int>(      )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2160:41: warning: statement should be inside braces [google-readability-braces-around-statements]
                                        if ( str_in->read_byte(&tmp) == 0 )
                                                                           ^
                                                                            {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2165:26: warning: 0xFF is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                                huffw->write_byte( 0xFF );
                                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2167:23: warning: 0xD0 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                        else if ( tmp == 0xD0 + ( cpos % 8 ) ) { // restart marker
                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2167:39: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                        else if ( tmp == 0xD0 + ( cpos % 8 ) ) { // restart marker
                                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2176:9: warning: assigning newly created 'gsl::owner<>' to non-owner 'unsigned char *' [cppcoreguidelines-owning-memory]
                                                                rst_err = static_cast<unsigned char*>(calloc( scnc + 1, sizeof( char ) ));
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2176:47: warning: Result of 'calloc' is converted to a pointer of type 'unsigned char', which is incompatible with sizeof operand type 'char' [clang-analyzer-unix.MallocSizeof]
                                                                rst_err = static_cast<unsigned char*>(calloc( scnc + 1, sizeof( char ) ));
                                                                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2176:47: note: Result of 'calloc' is converted to a pointer of type 'unsigned char', which is incompatible with sizeof operand type 'char'
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2176:47: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
                                                                rst_err = static_cast<unsigned char*>(calloc( scnc + 1, sizeof( char ) ));
                                                                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2178:10: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                                                        sprintf( errormessage, MEM_ERRMSG );
                                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2178:19: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                                                        sprintf( errormessage, MEM_ERRMSG );
                                                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2188:9: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                                                sprintf( errormessage, MEM_ERRMSG );
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2188:18: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                                                sprintf( errormessage, MEM_ERRMSG );
                                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2192:20: warning: 255 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                                        if ( crst > 255 ) {
                                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2193:9: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                                                sprintf( errormessage, "Severe false use of RST markers (%i)", static_cast<int>(crst) );
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2193:18: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                                                sprintf( errormessage, "Severe false use of RST markers (%i)", static_cast<int>(crst) );
                                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2195:16: warning: 255 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                                                crst = 255;
                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2197:8: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                                        rst_err[ scnc ] = crst;                                                 
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2202:7: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                                segment[ 0 ] = 0xFF;
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2202:22: warning: 0xFF is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                                segment[ 0 ] = 0xFF;
                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2203:7: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                                segment[ 1 ] = tmp;
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2215:42: warning: statement should be inside braces [hicpp-braces-around-statements]
                        if ( str_in->read( segment, 2 ) != 2 ) break;
                                                              ^
                                                               {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2216:9: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        if ( segment[ 0 ] != 0xFF ) {
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2216:25: warning: 0xFF is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        if ( segment[ 0 ] != 0xFF ) {
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2218:5: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                sprintf( errormessage, "size mismatch in marker segment FF %2X", type );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2218:14: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                sprintf( errormessage, "size mismatch in marker segment FF %2X", type );
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2220:18: warning: 0xFE is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                if ( type == 0xFE ) { //  if last marker was COM try again
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2221:44: warning: statement should be inside braces [hicpp-braces-around-statements]
                                        if ( str_in->read( segment, 2 ) != 2 ) break;
                                                                              ^
                                                                               {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2222:11: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                        if ( segment[ 0 ] == 0xFF ) errorlevel = 1;
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2222:27: warning: 0xFF is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                        if ( segment[ 0 ] == 0xFF ) errorlevel = 1;
                                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2222:33: warning: statement should be inside braces [hicpp-braces-around-statements]
                                        if ( segment[ 0 ] == 0xFF ) errorlevel = 1;
                                                                   ^
                                                                    {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2225:6: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
                                        delete ( hdrw );
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2114:2: note: variable declared here
        MemoryWriter* hdrw;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2226:6: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
                                        delete ( huffw );
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2113:2: note: variable declared here
        MemoryWriter* huffw;    
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2227:6: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
                                        free ( segment );
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2227:6: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2234:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                type = segment[ 1 ];
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2237:16: warning: 0xD9 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                if ( type == 0xD9 ) {
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2249:30: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                if ( str_in->read( segment + 2, 2 ) != 2 ) break;
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2249:45: warning: statement should be inside braces [readability-braces-around-statements]
                if ( str_in->read( segment + 2, 2 ) != 2 ) break;
                                                          ^
                                                           {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2250:13: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                len = 2 + B_SHORT( segment[ 2 ], segment[ 3 ] );
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:320:28: note: expanded from macro 'B_SHORT'
#define B_SHORT(v1,v2)  ( ( ((int) v1) << 8 ) + ((int) v2) )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2250:22: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                len = 2 + B_SHORT( segment[ 2 ], segment[ 3 ] );
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2250:36: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                len = 2 + B_SHORT( segment[ 2 ], segment[ 3 ] );
                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2251:17: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( len < 4 ) break;
                              ^
                               {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2257:5: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                sprintf( errormessage, MEM_ERRMSG );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2257:14: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [hicpp-no-array-decay]
                                sprintf( errormessage, MEM_ERRMSG );
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2259:5: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
                                delete ( hdrw );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2114:2: note: variable declared here
        MemoryWriter* hdrw;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2260:5: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
                                delete ( huffw );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2113:2: note: variable declared here
        MemoryWriter* huffw;    
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2267:32: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                if ( str_in->read( ( segment + 4 ), ( len - 4 ) ) !=
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2268:17: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
                        static_cast< unsigned short>( len - 4 ) ) break;
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2268:45: warning: statement should be inside braces [hicpp-braces-around-statements]
                        static_cast< unsigned short>( len - 4 ) ) break;
                                                                 ^
                                                                  {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2274:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete ( hdrw );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2114:2: note: variable declared here
        MemoryWriter* hdrw;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2275:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete ( huffw );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2113:2: note: variable declared here
        MemoryWriter* huffw;    
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2279:3: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                sprintf( errormessage, "unexpected end of data encountered" );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2279:12: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [hicpp-no-array-decay]
                sprintf( errormessage, "unexpected end of data encountered" );
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2285:9: warning: implicit conversion bool -> 'int' [readability-implicit-bool-conversion]
        grbs = str_in->read_byte(&tmp);
               ^
               static_cast<int>(      )
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2287:3: warning: assigning newly created 'gsl::owner<>' to non-owner 'MemoryWriter *' [cppcoreguidelines-owning-memory]
                grbgw = new MemoryWriter();
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2291:19: warning: statement should be inside braces [hicpp-braces-around-statements]
                        if ( len == 0 ) break;
                                       ^
                                        {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2296:3: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
                delete grbgw;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2115:2: note: variable declared here
        MemoryWriter* grbgw;    
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2300:2: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        free( segment );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2300:2: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2307:10: warning: redundant boolean literal in conditional return statement [readability-simplify-boolean-expr]
                return false;
~~~~~~~~~~~~~~~~~~~~~~~^~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2319:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool merge_jpeg( void )
       ~~~~ ^
       auto                    -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2319:25: warning: redundant void argument list in function definition [modernize-redundant-void-arg]
INTERN bool merge_jpeg( void )
                        ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2321:2: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
        unsigned char SOI[ 2 ] = { 0xFF, 0xD8 }; // SOI segment
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2321:29: warning: 0xFF is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        unsigned char SOI[ 2 ] = { 0xFF, 0xD8 }; // SOI segment
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2321:35: warning: 0xD8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        unsigned char SOI[ 2 ] = { 0xFF, 0xD8 }; // SOI segment
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2322:2: warning: do not declare C-style arrays, use std::array<> instead [modernize-avoid-c-arrays]
        unsigned char EOI[ 2 ] = { 0xFF, 0xD9 }; // EOI segment
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2322:29: warning: 0xFF is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        unsigned char EOI[ 2 ] = { 0xFF, 0xD9 }; // EOI segment
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2322:35: warning: 0xD9 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        unsigned char EOI[ 2 ] = { 0xFF, 0xD9 }; // EOI segment
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2323:22: warning: 0xFF is a magic number; consider replacing it with a named constant [readability-magic-numbers]
        unsigned char mrk = 0xFF; // marker start
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2325:22: warning: 0xD0 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        unsigned char rst = 0xD0; // restart marker
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2338:18: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
        str_out->write( SOI, 2 );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2347:30: warning: 0xDA is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                for ( type = 0x00; type != 0xDA; ) {
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2348:42: warning: statement should be inside braces [hicpp-braces-around-statements]
                        if ( static_cast< int>(hpos) >= hdrs ) break;
                                                              ^
                                                               {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2349:11: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        type = hdrdata[ hpos + 1 ];
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2350:14: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                        len = 2 + B_SHORT( hdrdata[ hpos + 2 ], hdrdata[ hpos + 3 ] );
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:320:28: note: expanded from macro 'B_SHORT'
#define B_SHORT(v1,v2)  ( ( ((int) v1) << 8 ) + ((int) v2) )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2350:23: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        len = 2 + B_SHORT( hdrdata[ hpos + 2 ], hdrdata[ hpos + 3 ] );
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2350:44: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        len = 2 + B_SHORT( hdrdata[ hpos + 2 ], hdrdata[ hpos + 3 ] );
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2355:27: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                str_out->write( hdrdata + tmp, ( hpos - tmp ) );
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2358:16: warning: 0xDA is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                if ( type != 0xDA ) break;
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2358:22: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( type != 0xDA ) break;
                                   ^
                                    {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2365:16: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                for ( ipos = scnp[ scan - 1 ]; ipos < scnp[ scan ]; ipos++ ) {
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2365:41: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                for ( ipos = scnp[ scan - 1 ]; ipos < scnp[ scan ]; ipos++ ) {
                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2367:24: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        str_out->write_byte(huffdata[ipos]);
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2369:9: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        if ( huffdata[ ipos ] == 0xFF )
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2369:29: warning: 0xFF is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        if ( huffdata[ ipos ] == 0xFF )
                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2369:35: warning: statement should be inside braces [google-readability-braces-around-statements]
                        if ( huffdata[ ipos ] == 0xFF )
                                                       ^
                                                        {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2373:18: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                if ( ipos == rstp[ rpos ] ) {
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2374:12: warning: 0xD0 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                        rst = 0xD0 + ( cpos % 8 );
                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2374:28: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                        rst = 0xD0 + ( cpos % 8 );
                                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2383:12: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        while ( rst_err[ scan - 1 ] > 0 ) {
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2384:11: warning: 0xD0 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                rst = 0xD0 + ( cpos % 8 );
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2384:27: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                rst = 0xD0 + ( cpos % 8 );
                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2387:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                cpos++; rst_err[ scan - 1 ]--;
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2396:18: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
        str_out->write( EOI, 2 );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2399:17: warning: statement should be inside braces [google-readability-braces-around-statements]
        if ( grbs > 0 )
                       ^
                        {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2404:3: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                sprintf( errormessage, "write error, possibly drive is full" );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2404:12: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                sprintf( errormessage, "write error, possibly drive is full" );
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2421:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool decode_jpeg( void )
       ~~~~ ^
       auto                     -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2421:26: warning: redundant void argument list in function definition [modernize-redundant-void-arg]
INTERN bool decode_jpeg( void )
                         ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2429:2: warning: do not declare C-style arrays, use std::array<> instead [modernize-avoid-c-arrays]
        int lastdc[ 4 ]; // last dc for each component
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2430:2: warning: consider replacing 'short' with 'int16' [google-runtime-int]
        short block[ 64 ]; // store block for coeffs
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2430:2: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2430:15: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        short block[ 64 ]; // store block for coeffs
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2435:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int cmp, bpos, dpos;
        ^~~~~~~~~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2436:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int mcu, sub, csc;
        ^~~~~~~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2437:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int eob, sta;
        ^~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2441:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'BitReader *' [cppcoreguidelines-owning-memory]
        huffr = new BitReader( huffdata, hufs );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2450:30: warning: 0xDA is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                for ( type = 0x00; type != 0xDA; ) {
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2451:42: warning: statement should be inside braces [hicpp-braces-around-statements]
                        if ( static_cast< int>(hpos) >= hdrs ) break;
                                                              ^
                                                               {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2452:11: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        type = hdrdata[ hpos + 1 ];
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2453:14: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                        len = 2 + B_SHORT( hdrdata[ hpos + 2 ], hdrdata[ hpos + 3 ] );
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:320:28: note: expanded from macro 'B_SHORT'
#define B_SHORT(v1,v2)  ( ( ((int) v1) << 8 ) + ((int) v2) )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2453:23: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        len = 2 + B_SHORT( hdrdata[ hpos + 2 ], hdrdata[ hpos + 3 ] );
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2453:44: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        len = 2 + B_SHORT( hdrdata[ hpos + 2 ], hdrdata[ hpos + 3 ] );
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2454:19: warning: 0xC4 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        if ( ( type == 0xC4 ) || ( type == 0xDA ) || ( type == 0xDD ) ) {
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2454:39: warning: 0xDA is a magic number; consider replacing it with a named constant [readability-magic-numbers]
                        if ( ( type == 0xC4 ) || ( type == 0xDA ) || ( type == 0xDD ) ) {
                                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2454:59: warning: 0xDD is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        if ( ( type == 0xC4 ) || ( type == 0xDA ) || ( type == 0xDD ) ) {
                                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2455:41: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                if ( !jpg_parse_jfif( type, len, &( hdrdata[ hpos ] ) ) ) {
                                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2456:13: warning: Potential leak of memory pointed to by 'huffr' [clang-analyzer-cplusplus.NewDeleteLeaks]
                                        return false;
                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2441:10: note: Memory is allocated
        huffr = new BitReader( huffdata, hufs );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2447:2: note: Loop condition is true.  Entering loop body
        while ( true )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2450:3: note: Loop condition is true.  Entering loop body
                for ( type = 0x00; type != 0xDA; ) {
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2451:9: note: Assuming 'hpos' is < 'hdrs'
                        if ( static_cast< int>(hpos) >= hdrs ) break;
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2451:4: note: Taking false branch
                        if ( static_cast< int>(hpos) >= hdrs ) break;
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2454:11: note: Assuming 'type' is equal to 196
                        if ( ( type == 0xC4 ) || ( type == 0xDA ) || ( type == 0xDD ) ) {
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2454:26: note: Left side of '||' is true
                        if ( ( type == 0xC4 ) || ( type == 0xDA ) || ( type == 0xDD ) ) {
                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2455:10: note: Assuming the condition is true
                                if ( !jpg_parse_jfif( type, len, &( hdrdata[ hpos ] ) ) ) {
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2455:5: note: Taking true branch
                                if ( !jpg_parse_jfif( type, len, &( hdrdata[ hpos ] ) ) ) {
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2456:13: note: Potential leak of memory pointed to by 'huffr'
                                        return false;
                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2463:16: warning: 0xDA is a magic number; consider replacing it with a named constant [readability-magic-numbers]
                if ( type != 0xDA ) break;
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2463:22: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( type != 0xDA ) break;
                                   ^
                                    {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2467:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        cmp = cs_cmp[ csc ];
                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2468:32: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        if ( ( ( cs_sal == 0 ) && ( htset[ 0 ][ cmpnfo[cmp].huffdc ] == 0 ) ) ||
                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2468:44: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        if ( ( ( cs_sal == 0 ) && ( htset[ 0 ][ cmpnfo[cmp].huffdc ] == 0 ) ) ||
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2469:29: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                 ( ( cs_sah >  0 ) && ( htset[ 1 ][ cmpnfo[cmp].huffac ] == 0 ) ) ) {
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2469:41: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                 ( ( cs_sah >  0 ) && ( htset[ 1 ][ cmpnfo[cmp].huffac ] == 0 ) ) ) {
                                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2470:5: warning: do not call c-style vararg functions [hicpp-vararg]
                                sprintf( errormessage, "huffman table missing in scan%i", scnc );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2470:14: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [hicpp-no-array-decay]
                                sprintf( errormessage, "huffman table missing in scan%i", scnc );
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2471:5: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
                                delete huffr;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2423:2: note: variable declared here
        BitReader* huffr; // bitwise reader for image data
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2513:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        &(htrees[ 0 ][ cmpnfo[cmp].huffdc ]),
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2513:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        &(htrees[ 0 ][ cmpnfo[cmp].huffdc ]),
                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2514:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        &(htrees[ 1 ][ cmpnfo[cmp].huffdc ]),
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2514:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        &(htrees[ 1 ][ cmpnfo[cmp].huffdc ]),
                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2515:8: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                                        block );
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2518:29: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                if ( ( eob > 1 ) && ( block[ eob - 1 ] == 0 ) ) {
                                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2519:8: warning: do not call c-style vararg functions [hicpp-vararg]
                                                        sprintf( errormessage, "reconstruction of inefficient coding not supported" );
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2519:17: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [hicpp-no-array-decay]
                                                        sprintf( errormessage, "reconstruction of inefficient coding not supported" );
                                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2524:21: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                block[ 0 ] += lastdc[ cmp ];
                                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2524:21: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2525:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                lastdc[ cmp ] = block[ 0 ];
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2528:43: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                for ( bpos = 0; bpos < eob; bpos++ )
                                                                                    ^
                                                                                     {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2529:8: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        colldata[ cmp ][ bpos ][ dpos ] = block[ bpos ];
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2529:8: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2529:42: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        colldata[ cmp ][ bpos ][ dpos ] = block[ bpos ];
                                                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2532:21: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                if ( eob < 0 ) sta = -1;
                                                              ^
                                                               {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2533:11: warning: statement should be inside braces [readability-braces-around-statements]
                                                else sta = jpg_next_mcupos( &mcu, &cmp, &csc, &sub, &dpos, &rstw );
                                                    ^
                                                     {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2541:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        &(htrees[ 0 ][ cmpnfo[cmp].huffdc ]),
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2541:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        &(htrees[ 0 ][ cmpnfo[cmp].huffdc ]),
                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2542:8: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                                        block );
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2545:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                colldata[cmp][0][dpos] = block[0] + lastdc[ cmp ];
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2545:7: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2545:32: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
                                                colldata[cmp][0][dpos] = block[0] + lastdc[ cmp ];
                                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2545:41: warning: The left operand of '+' is a garbage value [clang-analyzer-core.UndefinedBinaryOperatorResult]
                                                colldata[cmp][0][dpos] = block[0] + lastdc[ cmp ];
                                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2447:2: note: Loop condition is true.  Entering loop body
        while ( true )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2450:3: note: Loop condition is true.  Entering loop body
                for ( type = 0x00; type != 0xDA; ) {
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2451:9: note: Assuming 'hpos' is < 'hdrs'
                        if ( static_cast< int>(hpos) >= hdrs ) break;
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2451:4: note: Taking false branch
                        if ( static_cast< int>(hpos) >= hdrs ) break;
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2454:11: note: Assuming 'type' is not equal to 196
                        if ( ( type == 0xC4 ) || ( type == 0xDA ) || ( type == 0xDD ) ) {
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2454:9: note: Left side of '||' is false
                        if ( ( type == 0xC4 ) || ( type == 0xDA ) || ( type == 0xDD ) ) {
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2454:31: note: Assuming 'type' is equal to 218
                        if ( ( type == 0xC4 ) || ( type == 0xDA ) || ( type == 0xDD ) ) {
                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2454:46: note: Left side of '||' is true
                        if ( ( type == 0xC4 ) || ( type == 0xDA ) || ( type == 0xDD ) ) {
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2455:10: note: Assuming the condition is false
                                if ( !jpg_parse_jfif( type, len, &( hdrdata[ hpos ] ) ) ) {
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2455:5: note: Taking false branch
                                if ( !jpg_parse_jfif( type, len, &( hdrdata[ hpos ] ) ) ) {
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2450:3: note: Loop condition is false. Execution continues on line 2463
                for ( type = 0x00; type != 0xDA; ) {
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2463:8: note: 'type' is equal to 218
                if ( type != 0xDA ) break;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2463:3: note: Taking false branch
                if ( type != 0xDA ) break;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2466:18: note: Assuming 'csc' is < 'cs_cmpc'
                for ( csc = 0; csc < cs_cmpc; csc++ ) {
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2466:3: note: Loop condition is true.  Entering loop body
                for ( csc = 0; csc < cs_cmpc; csc++ ) {
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2468:13: note: Assuming 'cs_sal' is equal to 0
                        if ( ( ( cs_sal == 0 ) && ( htset[ 0 ][ cmpnfo[cmp].huffdc ] == 0 ) ) ||
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2468:11: note: Left side of '&&' is true
                        if ( ( ( cs_sal == 0 ) && ( htset[ 0 ][ cmpnfo[cmp].huffdc ] == 0 ) ) ||
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2468:32: note: Assuming the condition is false
                        if ( ( ( cs_sal == 0 ) && ( htset[ 0 ][ cmpnfo[cmp].huffdc ] == 0 ) ) ||
                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2468:9: note: Left side of '||' is false
                        if ( ( ( cs_sal == 0 ) && ( htset[ 0 ][ cmpnfo[cmp].huffdc ] == 0 ) ) ||
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2469:10: note: Assuming 'cs_sah' is <= 0
                                 ( ( cs_sah >  0 ) && ( htset[ 1 ][ cmpnfo[cmp].huffac ] == 0 ) ) ) {
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2469:24: note: Left side of '&&' is false
                                 ( ( cs_sah >  0 ) && ( htset[ 1 ][ cmpnfo[cmp].huffac ] == 0 ) ) ) {
                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2466:18: note: Assuming 'csc' is < 'cs_cmpc'
                for ( csc = 0; csc < cs_cmpc; csc++ ) {
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2466:3: note: Loop condition is true.  Entering loop body
                for ( csc = 0; csc < cs_cmpc; csc++ ) {
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2468:13: note: 'cs_sal' is equal to 0
                        if ( ( ( cs_sal == 0 ) && ( htset[ 0 ][ cmpnfo[cmp].huffdc ] == 0 ) ) ||
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2468:11: note: Left side of '&&' is true
                        if ( ( ( cs_sal == 0 ) && ( htset[ 0 ][ cmpnfo[cmp].huffdc ] == 0 ) ) ||
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2468:32: note: Assuming the condition is false
                        if ( ( ( cs_sal == 0 ) && ( htset[ 0 ][ cmpnfo[cmp].huffdc ] == 0 ) ) ||
                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2468:9: note: Left side of '||' is false
                        if ( ( ( cs_sal == 0 ) && ( htset[ 0 ][ cmpnfo[cmp].huffdc ] == 0 ) ) ||
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2469:10: note: 'cs_sah' is <= 0
                                 ( ( cs_sah >  0 ) && ( htset[ 1 ][ cmpnfo[cmp].huffac ] == 0 ) ) ) {
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2469:24: note: Left side of '&&' is false
                                 ( ( cs_sah >  0 ) && ( htset[ 1 ][ cmpnfo[cmp].huffac ] == 0 ) ) ) {
                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2466:18: note: Assuming 'csc' is >= 'cs_cmpc'
                for ( csc = 0; csc < cs_cmpc; csc++ ) {
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2466:3: note: Loop condition is false. Execution continues on line 2479
                for ( csc = 0; csc < cs_cmpc; csc++ ) {
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2486:3: note: Loop condition is true.  Entering loop body
                while ( true )
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2506:9: note: 'cs_cmpc' is > 1
                        if ( cs_cmpc > 1 )
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2506:4: note: Taking true branch
                        if ( cs_cmpc > 1 )
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2508:10: note: Assuming 'jpegtype' is not equal to 1
                                if ( jpegtype == 1 ) {
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2508:5: note: Taking false branch
                                if ( jpegtype == 1 ) {
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2536:15: note: Assuming 'cs_sah' is equal to 0
                                else if ( cs_sah == 0 ) {
                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2536:10: note: Taking true branch
                                else if ( cs_sah == 0 ) {
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2539:6: note: Loop condition is true.  Entering loop body
                                        while ( sta == 0 ) {
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2540:13: note: Calling 'jpg_decode_dc_prg_fs'
                                                sta = jpg_decode_dc_prg_fs( huffr,
                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4058:7: note: Assuming 'hc' is < 0
        if ( hc < 0 ) return -1; // return error
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4058:2: note: Taking true branch
        if ( hc < 0 ) return -1; // return error
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2540:13: note: Returning from 'jpg_decode_dc_prg_fs'
                                                sta = jpg_decode_dc_prg_fs( huffr,
                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2545:41: note: The left operand of '+' is a garbage value
                                                colldata[cmp][0][dpos] = block[0] + lastdc[ cmp ];
                                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2545:43: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                colldata[cmp][0][dpos] = block[0] + lastdc[ cmp ];
                                                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2546:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                lastdc[ cmp ] = colldata[cmp][0][dpos];
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2546:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                lastdc[ cmp ] = colldata[cmp][0][dpos];
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2546:23: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2549:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                colldata[cmp][0][dpos] <<= cs_sal;
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2549:7: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2549:7: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2549:34: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
                                                colldata[cmp][0][dpos] <<= cs_sal;
                                                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2552:23: warning: statement should be inside braces [readability-braces-around-statements]
                                                if ( sta != -1 )
                                                                ^
                                                                 {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2562:8: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                                        block );
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2565:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                colldata[cmp][0][dpos] += block[0] << cs_sal;
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2565:7: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2565:33: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
                                                colldata[cmp][0][dpos] += block[0] << cs_sal;
                                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2565:33: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2568:23: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                if ( sta != -1 )
                                                                ^
                                                                 {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2580:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        &(htrees[ 0 ][ cmpnfo[cmp].huffdc ]),
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2580:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        &(htrees[ 0 ][ cmpnfo[cmp].huffdc ]),
                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2581:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        &(htrees[ 1 ][ cmpnfo[cmp].huffdc ]),
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2581:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        &(htrees[ 1 ][ cmpnfo[cmp].huffdc ]),
                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2582:8: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                                        block );
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2585:29: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                if ( ( eob > 1 ) && ( block[ eob - 1 ] == 0 ) ) {
                                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2586:8: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                                        sprintf( errormessage, "reconstruction of inefficient coding not supported" );
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2586:17: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                                        sprintf( errormessage, "reconstruction of inefficient coding not supported" );
                                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2591:18: warning: The left expression of the compound assignment is an uninitialized value. The computed value will also be garbage [clang-analyzer-core.uninitialized.Assign]
                                                block[ 0 ] += lastdc[ cmp ];
                                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2447:2: note: Loop condition is true.  Entering loop body
        while ( true )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2450:3: note: Loop condition is true.  Entering loop body
                for ( type = 0x00; type != 0xDA; ) {
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2451:9: note: Assuming 'hpos' is < 'hdrs'
                        if ( static_cast< int>(hpos) >= hdrs ) break;
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2451:4: note: Taking false branch
                        if ( static_cast< int>(hpos) >= hdrs ) break;
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2454:11: note: Assuming 'type' is not equal to 196
                        if ( ( type == 0xC4 ) || ( type == 0xDA ) || ( type == 0xDD ) ) {
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2454:9: note: Left side of '||' is false
                        if ( ( type == 0xC4 ) || ( type == 0xDA ) || ( type == 0xDD ) ) {
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2454:31: note: Assuming 'type' is equal to 218
                        if ( ( type == 0xC4 ) || ( type == 0xDA ) || ( type == 0xDD ) ) {
                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2454:46: note: Left side of '||' is true
                        if ( ( type == 0xC4 ) || ( type == 0xDA ) || ( type == 0xDD ) ) {
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2455:10: note: Assuming the condition is false
                                if ( !jpg_parse_jfif( type, len, &( hdrdata[ hpos ] ) ) ) {
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2455:5: note: Taking false branch
                                if ( !jpg_parse_jfif( type, len, &( hdrdata[ hpos ] ) ) ) {
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2450:3: note: Loop condition is false. Execution continues on line 2463
                for ( type = 0x00; type != 0xDA; ) {
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2463:8: note: 'type' is equal to 218
                if ( type != 0xDA ) break;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2463:3: note: Taking false branch
                if ( type != 0xDA ) break;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2466:18: note: Assuming 'csc' is >= 'cs_cmpc'
                for ( csc = 0; csc < cs_cmpc; csc++ ) {
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2466:3: note: Loop condition is false. Execution continues on line 2479
                for ( csc = 0; csc < cs_cmpc; csc++ ) {
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2486:3: note: Loop condition is true.  Entering loop body
                while ( true )
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2506:9: note: 'cs_cmpc' is <= 1
                        if ( cs_cmpc > 1 )
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2506:4: note: Taking false branch
                        if ( cs_cmpc > 1 )
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2575:10: note: Assuming 'jpegtype' is equal to 1
                                if ( jpegtype == 1 ) {
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2575:5: note: Taking true branch
                                if ( jpegtype == 1 ) {
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2577:6: note: Loop condition is true.  Entering loop body
                                        while ( sta == 0 ) {
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2579:13: note: Calling 'jpg_decode_block_seq'
                                                eob = jpg_decode_block_seq( huffr,
                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3954:7: note: Assuming 'hc' is < 0
        if ( hc < 0 ) return -1; // return error
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3954:2: note: Taking true branch
        if ( hc < 0 ) return -1; // return error
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2579:13: note: Returning from 'jpg_decode_block_seq'
                                                eob = jpg_decode_block_seq( huffr,
                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2585:14: note: 'eob' is <= 1
                                                if ( ( eob > 1 ) && ( block[ eob - 1 ] == 0 ) ) {
                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2585:24: note: Left side of '&&' is false
                                                if ( ( eob > 1 ) && ( block[ eob - 1 ] == 0 ) ) {
                                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2591:18: note: The left expression of the compound assignment is an uninitialized value. The computed value will also be garbage
                                                block[ 0 ] += lastdc[ cmp ];
                                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2591:21: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                block[ 0 ] += lastdc[ cmp ];
                                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2591:21: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2592:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                lastdc[ cmp ] = block[ 0 ];
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2595:43: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                for ( bpos = 0; bpos < eob; bpos++ )
                                                                                    ^
                                                                                     {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2596:8: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        colldata[ cmp ][ bpos ][ dpos ] = block[ bpos ];
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2596:8: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2596:42: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        colldata[ cmp ][ bpos ][ dpos ] = block[ bpos ];
                                                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2599:21: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                if ( eob < 0 ) sta = -1;
                                                              ^
                                                               {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2600:11: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                else sta = jpg_next_mcuposn( &cmp, &dpos, &rstw );
                                                    ^
                                                     {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2609:11: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                                &(htrees[ 0 ][ cmpnfo[cmp].huffdc ]),
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2609:24: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                                &(htrees[ 0 ][ cmpnfo[cmp].huffdc ]),
                                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2610:9: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                                                block );
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2613:8: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        colldata[cmp][0][dpos] = block[0] + lastdc[ cmp ];
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2613:8: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2613:33: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
                                                        colldata[cmp][0][dpos] = block[0] + lastdc[ cmp ];
                                                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2613:42: warning: The left operand of '+' is a garbage value [clang-analyzer-core.UndefinedBinaryOperatorResult]
                                                        colldata[cmp][0][dpos] = block[0] + lastdc[ cmp ];
                                                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2447:2: note: Loop condition is true.  Entering loop body
        while ( true )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2450:3: note: Loop condition is true.  Entering loop body
                for ( type = 0x00; type != 0xDA; ) {
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2451:9: note: Assuming 'hpos' is < 'hdrs'
                        if ( static_cast< int>(hpos) >= hdrs ) break;
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2451:4: note: Taking false branch
                        if ( static_cast< int>(hpos) >= hdrs ) break;
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2454:11: note: Assuming 'type' is not equal to 196
                        if ( ( type == 0xC4 ) || ( type == 0xDA ) || ( type == 0xDD ) ) {
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2454:9: note: Left side of '||' is false
                        if ( ( type == 0xC4 ) || ( type == 0xDA ) || ( type == 0xDD ) ) {
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2454:31: note: Assuming 'type' is equal to 218
                        if ( ( type == 0xC4 ) || ( type == 0xDA ) || ( type == 0xDD ) ) {
                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2454:46: note: Left side of '||' is true
                        if ( ( type == 0xC4 ) || ( type == 0xDA ) || ( type == 0xDD ) ) {
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2455:10: note: Assuming the condition is false
                                if ( !jpg_parse_jfif( type, len, &( hdrdata[ hpos ] ) ) ) {
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2455:5: note: Taking false branch
                                if ( !jpg_parse_jfif( type, len, &( hdrdata[ hpos ] ) ) ) {
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2450:3: note: Loop condition is false. Execution continues on line 2463
                for ( type = 0x00; type != 0xDA; ) {
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2463:8: note: 'type' is equal to 218
                if ( type != 0xDA ) break;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2463:3: note: Taking false branch
                if ( type != 0xDA ) break;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2466:18: note: Assuming 'csc' is >= 'cs_cmpc'
                for ( csc = 0; csc < cs_cmpc; csc++ ) {
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2466:3: note: Loop condition is false. Execution continues on line 2479
                for ( csc = 0; csc < cs_cmpc; csc++ ) {
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2486:3: note: Loop condition is true.  Entering loop body
                while ( true )
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2506:9: note: 'cs_cmpc' is <= 1
                        if ( cs_cmpc > 1 )
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2506:4: note: Taking false branch
                        if ( cs_cmpc > 1 )
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2575:10: note: Assuming 'jpegtype' is not equal to 1
                                if ( jpegtype == 1 ) {
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2575:5: note: Taking false branch
                                if ( jpegtype == 1 ) {
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2603:15: note: Assuming 'cs_to' is equal to 0
                                else if ( cs_to == 0 ) {                                        
                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2603:10: note: Taking true branch
                                else if ( cs_to == 0 ) {                                        
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2604:11: note: Assuming 'cs_sah' is equal to 0
                                        if ( cs_sah == 0 ) {
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2604:6: note: Taking true branch
                                        if ( cs_sah == 0 ) {
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2607:7: note: Loop condition is true.  Entering loop body
                                                while ( sta == 0 ) {
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2608:14: note: Calling 'jpg_decode_dc_prg_fs'
                                                        sta = jpg_decode_dc_prg_fs( huffr,
                                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4058:7: note: Assuming 'hc' is < 0
        if ( hc < 0 ) return -1; // return error
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4058:2: note: Taking true branch
        if ( hc < 0 ) return -1; // return error
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2608:14: note: Returning from 'jpg_decode_dc_prg_fs'
                                                        sta = jpg_decode_dc_prg_fs( huffr,
                                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2613:42: note: The left operand of '+' is a garbage value
                                                        colldata[cmp][0][dpos] = block[0] + lastdc[ cmp ];
                                                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2613:44: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        colldata[cmp][0][dpos] = block[0] + lastdc[ cmp ];
                                                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2614:8: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        lastdc[ cmp ] = colldata[cmp][0][dpos];
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2614:24: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        lastdc[ cmp ] = colldata[cmp][0][dpos];
                                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2614:24: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2617:8: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        colldata[cmp][0][dpos] <<= cs_sal;
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2617:8: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2617:8: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2617:35: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
                                                        colldata[cmp][0][dpos] <<= cs_sal;
                                                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2620:24: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                        if ( sta != -1 )
                                                                        ^
                                                                         {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2630:9: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                                                block );
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2633:8: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        colldata[cmp][0][dpos] += block[0] << cs_sal;
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2633:8: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2633:34: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
                                                        colldata[cmp][0][dpos] += block[0] << cs_sal;
                                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2633:34: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2636:24: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                        if ( sta != -1 )
                                                                        ^
                                                                         {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2649:12: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                                        &(htrees[ 1 ][ cmpnfo[cmp].huffac ]),
                                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2649:25: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                                        &(htrees[ 1 ][ cmpnfo[cmp].huffac ]),
                                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2650:10: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                                                        block, &eobrun, cs_from, cs_to );
                                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2655:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                                                ( peobrun <     hcodes[ 1 ][ cmpnfo[cmp].huffac ].max_eobrun - 1 ) ) {
                                                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2655:36: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                                                ( peobrun <     hcodes[ 1 ][ cmpnfo[cmp].huffac ].max_eobrun - 1 ) ) {
                                                                                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2656:11: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                                                                sprintf( errormessage,
                                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2656:20: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                                                                sprintf( errormessage,
                                                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2662:15: warning: statement should be inside braces [hicpp-braces-around-statements]
                                                                } else peobrun = 0;
                                                                      ^
                                                                       {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2665:51: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                                for ( bpos = cs_from; bpos < eob; bpos++ )
                                                                                                          ^
                                                                                                           {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2666:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                                        colldata[ cmp ][ bpos ][ dpos ] = block[ bpos ] << cs_sal;
                                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2666:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2666:44: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                                        colldata[ cmp ][ bpos ][ dpos ] = block[ bpos ] << cs_sal;
                                                                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2666:44: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2666:44: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2667:14: warning: statement should be inside braces [hicpp-braces-around-statements]
                                                        } else eobrun--;
                                                              ^
                                                               {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2670:22: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                        if ( eob < 0 ) sta = -1;
                                                                      ^
                                                                       {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2671:12: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                        else sta = jpg_skip_eobrun( &cmp, &dpos, &rstw, &eobrun );
                                                            ^
                                                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2674:23: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                        if ( sta == 0 )
                                                                       ^
                                                                        {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2683:53: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                        for ( bpos = cs_from; bpos <= cs_to; bpos++ )
                                                                                                     ^
                                                                                                      {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2684:9: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                                block[ bpos ] = colldata[ cmp ][ bpos ][ dpos ];
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2684:25: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                                block[ bpos ] = colldata[ cmp ][ bpos ][ dpos ];
                                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2684:25: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2689:12: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                                        &(htrees[ 1 ][ cmpnfo[cmp].huffac ]),
                                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2689:25: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                                        &(htrees[ 1 ][ cmpnfo[cmp].huffac ]),
                                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2690:10: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                                                        block, &eobrun, cs_from, cs_to );
                                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2695:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                                                ( peobrun < hcodes[ 1 ][ cmpnfo[cmp].huffac ].max_eobrun - 1 ) ) {
                                                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2695:36: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                                                ( peobrun < hcodes[ 1 ][ cmpnfo[cmp].huffac ].max_eobrun - 1 ) ) {
                                                                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2696:11: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                                                                sprintf( errormessage,
                                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2696:20: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                                                                sprintf( errormessage,
                                                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2704:15: warning: statement should be inside braces [hicpp-braces-around-statements]
                                                                } else peobrun = 0;
                                                                      ^
                                                                       {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2709:10: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                                                        block, &eobrun, cs_from, cs_to );
                                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2714:53: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                        for ( bpos = cs_from; bpos <= cs_to; bpos++ )
                                                                                                     ^
                                                                                                      {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2715:9: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                                colldata[ cmp ][ bpos ][ dpos ] += block[ bpos ] << cs_sal;
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2715:9: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2715:44: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                                colldata[ cmp ][ bpos ][ dpos ] += block[ bpos ] << cs_sal;
                                                                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2715:44: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2715:44: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2718:22: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                        if ( eob < 0 ) sta = -1;
                                                                      ^
                                                                       {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2719:12: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                        else sta = jpg_next_mcuposn( &cmp, &dpos, &rstw );
                                                            ^
                                                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2728:6: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                        sprintf( errormessage, "inconsistent use of padbits" );
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2728:15: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                        sprintf( errormessage, "inconsistent use of padbits" );
                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2734:14: warning: narrowing conversion from 'unsigned char' to signed type 'char' is implementation-defined [bugprone-narrowing-conversions]
                                padbit = huffr->unpad( padbit );
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2739:5: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                sprintf( errormessage, "decode error in scan%i / mcu%i",
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2739:14: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                sprintf( errormessage, "decode error in scan%i / mcu%i",
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2741:5: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
                                delete huffr;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2423:2: note: variable declared here
        BitReader* huffr; // bitwise reader for image data
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2745:4: warning: do not use 'else' after 'return' [readability-else-after-return]
                        else if ( sta == 2 ) { // status 2/3 means done
                        ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2755:3: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                sprintf( errormessage, "coded image data truncated / too short" );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2755:12: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                sprintf( errormessage, "coded image data truncated / too short" );
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2761:3: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                sprintf( errormessage, "surplus data found after coded image data" );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2761:12: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                sprintf( errormessage, "surplus data found after coded image data" );
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2766:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete( huffr );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2423:2: note: variable declared here
        BitReader* huffr; // bitwise reader for image data
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2777:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool recode_jpeg( void )
       ~~~~ ^
       auto                     -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2777:26: warning: redundant void argument list in function definition [modernize-redundant-void-arg]
INTERN bool recode_jpeg( void )
                         ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2785:2: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
        int lastdc[ 4 ]; // last dc for each component0
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2786:2: warning: consider replacing 'short' with 'int16' [google-runtime-int]
        short block[ 64 ]; // store block for coeffs
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2786:2: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2786:15: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        short block[ 64 ]; // store block for coeffs
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2790:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int cmp, bpos, dpos;
        ^~~~~~~~~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2791:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int mcu, sub, csc;
        ^~~~~~~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2792:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int eob, sta;
        ^~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2797:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'BitWriter *' [cppcoreguidelines-owning-memory]
        huffw = new BitWriter(padbit);
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2810:30: warning: 0xDA is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                for ( type = 0x00; type != 0xDA; ) {
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2811:42: warning: statement should be inside braces [hicpp-braces-around-statements]
                        if ( static_cast< int>(hpos) >= hdrs ) break;
                                                              ^
                                                               {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2812:11: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        type = hdrdata[ hpos + 1 ];
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2813:14: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                        len = 2 + B_SHORT( hdrdata[ hpos + 2 ], hdrdata[ hpos + 3 ] );
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:320:28: note: expanded from macro 'B_SHORT'
#define B_SHORT(v1,v2)  ( ( ((int) v1) << 8 ) + ((int) v2) )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2813:23: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        len = 2 + B_SHORT( hdrdata[ hpos + 2 ], hdrdata[ hpos + 3 ] );
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2813:44: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        len = 2 + B_SHORT( hdrdata[ hpos + 2 ], hdrdata[ hpos + 3 ] );
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2814:19: warning: 0xC4 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        if ( ( type == 0xC4 ) || ( type == 0xDA ) || ( type == 0xDD ) ) {
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2814:39: warning: 0xDA is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        if ( ( type == 0xC4 ) || ( type == 0xDA ) || ( type == 0xDD ) ) {
                                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2814:59: warning: 0xDD is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        if ( ( type == 0xC4 ) || ( type == 0xDA ) || ( type == 0xDD ) ) {
                                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2815:41: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                if ( !jpg_parse_jfif( type, len, &( hdrdata[ hpos ] ) ) ) {
                                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2816:13: warning: Potential leak of memory pointed to by 'huffw' [clang-analyzer-cplusplus.NewDeleteLeaks]
                                        return false;
                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2797:10: note: Memory is allocated
        huffw = new BitWriter(padbit);
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2807:2: note: Loop condition is true.  Entering loop body
        while ( true )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2810:3: note: Loop condition is true.  Entering loop body
                for ( type = 0x00; type != 0xDA; ) {
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2811:9: note: Assuming 'hpos' is < 'hdrs'
                        if ( static_cast< int>(hpos) >= hdrs ) break;
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2811:4: note: Taking false branch
                        if ( static_cast< int>(hpos) >= hdrs ) break;
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2814:11: note: Assuming 'type' is equal to 196
                        if ( ( type == 0xC4 ) || ( type == 0xDA ) || ( type == 0xDD ) ) {
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2814:26: note: Left side of '||' is true
                        if ( ( type == 0xC4 ) || ( type == 0xDA ) || ( type == 0xDD ) ) {
                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2815:10: note: Assuming the condition is true
                                if ( !jpg_parse_jfif( type, len, &( hdrdata[ hpos ] ) ) ) {
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2815:5: note: Taking true branch
                                if ( !jpg_parse_jfif( type, len, &( hdrdata[ hpos ] ) ) ) {
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2816:13: note: Potential leak of memory pointed to by 'huffw'
                                        return false;
                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2827:16: warning: 0xDA is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                if ( type != 0xDA ) break;
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2827:22: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( type != 0xDA ) break;
                                   ^
                                    {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2831:25: warning: statement should be inside braces [google-readability-braces-around-statements]
                if ( scnp == nullptr ) scnp = static_cast< unsigned int*>(calloc( scnc + 2, sizeof( int ) ));
                                      ^
                                       {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2831:26: warning: assigning newly created 'gsl::owner<>' to non-owner 'unsigned int *' [cppcoreguidelines-owning-memory]
                if ( scnp == nullptr ) scnp = static_cast< unsigned int*>(calloc( scnc + 2, sizeof( int ) ));
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2831:61: warning: Result of 'calloc' is converted to a pointer of type 'unsigned int', which is incompatible with sizeof operand type 'int' [clang-analyzer-unix.MallocSizeof]
                if ( scnp == nullptr ) scnp = static_cast< unsigned int*>(calloc( scnc + 2, sizeof( int ) ));
                                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2831:61: note: Result of 'calloc' is converted to a pointer of type 'unsigned int', which is incompatible with sizeof operand type 'int'
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2831:61: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
                if ( scnp == nullptr ) scnp = static_cast< unsigned int*>(calloc( scnc + 2, sizeof( int ) ));
                                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2832:7: warning: statement should be inside braces [google-readability-braces-around-statements]
                else scnp = static_cast< unsigned int*>(frealloc( scnp, ( scnc + 2 ) * sizeof( int ) ));
                    ^
                     {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2834:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        sprintf( errormessage, MEM_ERRMSG );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2834:13: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        sprintf( errormessage, MEM_ERRMSG );
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2842:25: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                ( mcuc / rsti ) : ( cmpnfo[ cs_cmp[ 0 ] ].bc / rsti ) );
                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2843:26: warning: statement should be inside braces [google-readability-braces-around-statements]
                        if ( rstp == nullptr ) rstp = static_cast< unsigned int*>(calloc( tmp + 1, sizeof( int ) ));
                                              ^
                                               {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2843:27: warning: assigning newly created 'gsl::owner<>' to non-owner 'unsigned int *' [cppcoreguidelines-owning-memory]
                        if ( rstp == nullptr ) rstp = static_cast< unsigned int*>(calloc( tmp + 1, sizeof( int ) ));
                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2843:62: warning: Result of 'calloc' is converted to a pointer of type 'unsigned int', which is incompatible with sizeof operand type 'int' [clang-analyzer-unix.MallocSizeof]
                        if ( rstp == nullptr ) rstp = static_cast< unsigned int*>(calloc( tmp + 1, sizeof( int ) ));
                                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2843:62: note: Result of 'calloc' is converted to a pointer of type 'unsigned int', which is incompatible with sizeof operand type 'int'
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2843:62: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
                        if ( rstp == nullptr ) rstp = static_cast< unsigned int*>(calloc( tmp + 1, sizeof( int ) ));
                                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2844:8: warning: statement should be inside braces [google-readability-braces-around-statements]
                        else rstp = static_cast< unsigned int*>(frealloc( rstp, ( tmp + 1 ) * sizeof( int ) ));
                            ^
                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2846:5: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                sprintf( errormessage, MEM_ERRMSG );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2846:14: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                sprintf( errormessage, MEM_ERRMSG );
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2860:3: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                scnp[ scnc ] = huffw->num_bytes_written();
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2887:30: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                                for ( bpos = 0; bpos < 64; bpos++ )
                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2887:42: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                for ( bpos = 0; bpos < 64; bpos++ )
                                                                                   ^
                                                                                    {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2888:8: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        block[ bpos ] = colldata[ cmp ][ bpos ][ dpos ];
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2888:24: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        block[ bpos ] = colldata[ cmp ][ bpos ][ dpos ];
                                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2888:24: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2891:21: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                block[ 0 ] -= lastdc[ cmp ];
                                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2891:21: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2892:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                lastdc[ cmp ] = colldata[ cmp ][ 0 ][ dpos ];
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2892:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                lastdc[ cmp ] = colldata[ cmp ][ 0 ][ dpos ];
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2892:23: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2896:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        &(hcodes[ 0 ][ cmpnfo[cmp].huffdc ]),
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2896:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        &(hcodes[ 0 ][ cmpnfo[cmp].huffdc ]),
                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2897:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        &(hcodes[ 1 ][ cmpnfo[cmp].huffac ]),
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2897:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        &(hcodes[ 1 ][ cmpnfo[cmp].huffac ]),
                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2898:8: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                                        block );
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2901:21: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                if ( eob < 0 ) sta = -1;
                                                              ^
                                                               {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2902:11: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                else sta = jpg_next_mcupos( &mcu, &cmp, &csc, &sub, &dpos, &rstw );
                                                    ^
                                                     {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2910:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                tmp = colldata[ cmp ][ 0 ][ dpos ] >> cs_sal;
                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2910:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2910:13: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2911:20: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
                                                block[ 0 ] = tmp - lastdc[ cmp ];
                                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2911:26: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                block[ 0 ] = tmp - lastdc[ cmp ];
                                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2912:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                lastdc[ cmp ] = tmp;
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2916:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        &(hcodes[ 0 ][ cmpnfo[cmp].huffdc ]),
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2916:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        &(hcodes[ 0 ][ cmpnfo[cmp].huffdc ]),
                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2917:8: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                                        block );
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2920:23: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                if ( sta != -1 )
                                                                ^
                                                                 {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2929:20: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                                block[ 0 ] = BITN( colldata[ cmp ][ 0 ][ dpos ], cs_sal );
                                                             ^
/home/mangix/devstuff/packJPG/source/./bitops.h:7:25: note: expanded from macro 'BITN'
#define BITN( c, n )            ( (c >> n) & 0x1 )
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2929:26: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                block[ 0 ] = BITN( colldata[ cmp ][ 0 ][ dpos ], cs_sal );
                                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2929:26: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2929:26: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/./bitops.h:7:26: note: expanded from macro 'BITN'
#define BITN( c, n )            ( (c >> n) & 0x1 )
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2932:42: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                                sta = jpg_encode_dc_prg_sa( huffw, block );
                                                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2935:23: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                if ( sta != -1 )
                                                                ^
                                                                 {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2946:30: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                                for ( bpos = 0; bpos < 64; bpos++ )
                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2946:42: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                for ( bpos = 0; bpos < 64; bpos++ )
                                                                                   ^
                                                                                    {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2947:8: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        block[ bpos ] = colldata[ cmp ][ bpos ][ dpos ];
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2947:24: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        block[ bpos ] = colldata[ cmp ][ bpos ][ dpos ];
                                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2947:24: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2950:21: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                block[ 0 ] -= lastdc[ cmp ];
                                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2950:21: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2951:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                lastdc[ cmp ] = colldata[ cmp ][ 0 ][ dpos ];
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2951:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                lastdc[ cmp ] = colldata[ cmp ][ 0 ][ dpos ];
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2951:23: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2955:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        &(hcodes[ 0 ][ cmpnfo[cmp].huffdc ]),
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2955:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        &(hcodes[ 0 ][ cmpnfo[cmp].huffdc ]),
                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2956:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        &(hcodes[ 1 ][ cmpnfo[cmp].huffac ]),
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2956:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        &(hcodes[ 1 ][ cmpnfo[cmp].huffac ]),
                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2957:8: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                                        block );
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2960:21: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                if ( eob < 0 ) sta = -1;
                                                              ^
                                                               {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2961:11: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                else sta = jpg_next_mcuposn( &cmp, &dpos, &rstw );      
                                                    ^
                                                     {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2970:14: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        tmp = colldata[ cmp ][ 0 ][ dpos ] >> cs_sal;
                                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2970:14: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2970:14: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2971:21: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
                                                        block[ 0 ] = tmp - lastdc[ cmp ];
                                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2971:27: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        block[ 0 ] = tmp - lastdc[ cmp ];
                                                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2972:8: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        lastdc[ cmp ] = tmp;
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2976:11: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                                &(hcodes[ 0 ][ cmpnfo[cmp].huffdc ]),
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2976:24: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                                &(hcodes[ 0 ][ cmpnfo[cmp].huffdc ]),
                                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2977:9: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                                                block );                                                        
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2980:24: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                        if ( sta != -1 )
                                                                        ^
                                                                         {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2989:21: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                                        block[ 0 ] = BITN( colldata[ cmp ][ 0 ][ dpos ], cs_sal );
                                                                     ^
/home/mangix/devstuff/packJPG/source/./bitops.h:7:25: note: expanded from macro 'BITN'
#define BITN( c, n )            ( (c >> n) & 0x1 )
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2989:27: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        block[ 0 ] = BITN( colldata[ cmp ][ 0 ][ dpos ], cs_sal );
                                                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2989:27: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2989:27: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/./bitops.h:7:26: note: expanded from macro 'BITN'
#define BITN( c, n )            ( (c >> n) & 0x1 )
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2992:43: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                                        sta = jpg_encode_dc_prg_sa( huffw, block );
                                                                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2995:24: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                        if ( sta != -1 )
                                                                        ^
                                                                         {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3006:53: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                        for ( bpos = cs_from; bpos <= cs_to; bpos++ )
                                                                                                     ^
                                                                                                      {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3007:9: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                                block[ bpos ] =
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3008:10: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                                                        FDIV2( colldata[ cmp ][ bpos ][ dpos ], cs_sal );
                                                                        ^
/home/mangix/devstuff/packJPG/source/./bitops.h:9:41: note: expanded from macro 'FDIV2'
#define FDIV2( v, p )           ( ( v < 0 ) ? -( (-v) >> p ) : ( v >> p ) )
                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3008:17: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                                        FDIV2( colldata[ cmp ][ bpos ][ dpos ], cs_sal );
                                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3008:17: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3008:17: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/./bitops.h:9:57: note: expanded from macro 'FDIV2'
#define FDIV2( v, p )           ( ( v < 0 ) ? -( (-v) >> p ) : ( v >> p ) )
                                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3012:11: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                                &(hcodes[ 1 ][ cmpnfo[cmp].huffac ]),
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3012:24: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                                &(hcodes[ 1 ][ cmpnfo[cmp].huffac ]),
                                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3013:9: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                                                block, &eobrun, cs_from, cs_to );
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3016:22: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                        if ( eob < 0 ) sta = -1;
                                                                      ^
                                                                       {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3017:12: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                        else sta = jpg_next_mcuposn( &cmp, &dpos, &rstw );
                                                            ^
                                                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3022:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        &(hcodes[ 1 ][ cmpnfo[cmp].huffac ]),
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3022:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        &(hcodes[ 1 ][ cmpnfo[cmp].huffac ]),
                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3030:53: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                        for ( bpos = cs_from; bpos <= cs_to; bpos++ )
                                                                                                     ^
                                                                                                      {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3031:9: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                                block[ bpos ] =
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3032:10: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                                                        FDIV2( colldata[ cmp ][ bpos ][ dpos ], cs_sal );
                                                                        ^
/home/mangix/devstuff/packJPG/source/./bitops.h:9:41: note: expanded from macro 'FDIV2'
#define FDIV2( v, p )           ( ( v < 0 ) ? -( (-v) >> p ) : ( v >> p ) )
                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3032:17: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                                        FDIV2( colldata[ cmp ][ bpos ][ dpos ], cs_sal );
                                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3032:17: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3032:17: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/./bitops.h:9:57: note: expanded from macro 'FDIV2'
#define FDIV2( v, p )           ( ( v < 0 ) ? -( (-v) >> p ) : ( v >> p ) )
                                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3036:11: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                                &(hcodes[ 1 ][ cmpnfo[cmp].huffac ]),
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3036:24: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                                &(hcodes[ 1 ][ cmpnfo[cmp].huffac ]),
                                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3037:9: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                                                block, &eobrun, cs_from, cs_to );
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3040:22: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                        if ( eob < 0 ) sta = -1;
                                                                      ^
                                                                       {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3041:12: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                        else sta = jpg_next_mcuposn( &cmp, &dpos, &rstw );
                                                            ^
                                                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3046:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        &(hcodes[ 1 ][ cmpnfo[cmp].huffac ]),
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3046:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        &(hcodes[ 1 ][ cmpnfo[cmp].huffac ]),
                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3060:5: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                sprintf( errormessage, "encode error in scan%i / mcu%i",
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3060:14: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                sprintf( errormessage, "encode error in scan%i / mcu%i",
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3062:5: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
                                delete huffw;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2779:2: note: variable declared here
        BitWriter*  huffw; // bitwise writer for image data
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3066:4: warning: do not use 'else' after 'return' [readability-else-after-return]
                        else if ( sta == 2 ) { // status 2 means done
                        ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3071:20: warning: statement should be inside braces [google-readability-braces-around-statements]
                                if ( rsti > 0 ) // store rstp & stay in the loop
                                               ^
                                                {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3072:6: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                        rstp[ rstc++ ] = huffw->num_bytes_written() - 1;
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3080:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete huffw;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:2779:2: note: variable declared here
        BitWriter*  huffw; // bitwise writer for image data
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3083:2: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        scnp[ scnc ] = hufs;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3084:24: warning: statement should be inside braces [google-readability-braces-around-statements]
        if ( rstp != nullptr )
                              ^
                               {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3085:3: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                rstp[ rstc ] = hufs;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3096:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool adapt_icos( void )
       ~~~~ ^
       auto                    -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3096:25: warning: redundant void argument list in function definition [modernize-redundant-void-arg]
INTERN bool adapt_icos( void )
                        ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3098:2: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        unsigned short quant[ 64 ]; // local copy of quantization
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3098:2: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3098:24: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        unsigned short quant[ 64 ]; // local copy of quantization
                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3105:26: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                for ( ipos = 0; ipos < 64; ipos++ ) {
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3106:4: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        quant[ ipos ] = QUANT( cmp, zigzag[ ipos ] );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3106:20: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        quant[ ipos ] = QUANT( cmp, zigzag[ ipos ] );
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3106:20: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        quant[ ipos ] = QUANT( cmp, zigzag[ ipos ] );
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3106:32: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        quant[ ipos ] = QUANT( cmp, zigzag[ ipos ] );
                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3107:9: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        if ( quant[ ipos ] >= 2048 ) // if this is true, it can be safely assumed (for 8 bit JPEG), that all coefficients are zero
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3107:26: warning: 2048 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        if ( quant[ ipos ] >= 2048 ) // if this is true, it can be safely assumed (for 8 bit JPEG), that all coefficients are zero
                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3107:32: warning: statement should be inside braces [google-readability-braces-around-statements]
                        if ( quant[ ipos ] >= 2048 ) // if this is true, it can be safely assumed (for 8 bit JPEG), that all coefficients are zero
                                                    ^
                                                     {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3108:5: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                quant[ ipos ] = 0;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3111:26: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                for ( ipos = 0; ipos < 64 * 64; ipos++ )
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3111:31: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                for ( ipos = 0; ipos < 64 * 64; ipos++ )
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3111:43: warning: statement should be inside braces [google-readability-braces-around-statements]
                for ( ipos = 0; ipos < 64 * 64; ipos++ )
                                                        ^
                                                         {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3112:4: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        adpt_idct_8x8[ cmp ][ ipos ] = icos_idct_8x8[ ipos ] * quant[ ipos % 64 ];
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3112:35: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        adpt_idct_8x8[ cmp ][ ipos ] = icos_idct_8x8[ ipos ] * quant[ ipos % 64 ];
                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3112:59: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        adpt_idct_8x8[ cmp ][ ipos ] = icos_idct_8x8[ ipos ] * quant[ ipos % 64 ];
                                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3112:73: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        adpt_idct_8x8[ cmp ][ ipos ] = icos_idct_8x8[ ipos ] * quant[ ipos % 64 ];
                                                                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3114:26: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                for ( ipos = 0; ipos < 8 * 8; ipos++ )
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3114:30: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                for ( ipos = 0; ipos < 8 * 8; ipos++ )
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3114:41: warning: statement should be inside braces [google-readability-braces-around-statements]
                for ( ipos = 0; ipos < 8 * 8; ipos++ )
                                                      ^
                                                       {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3115:4: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        adpt_idct_1x8[ cmp ][ ipos ] = icos_idct_1x8[ ipos ] * quant[ ( ipos % 8 ) * 8 ];
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3115:35: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        adpt_idct_1x8[ cmp ][ ipos ] = icos_idct_1x8[ ipos ] * quant[ ( ipos % 8 ) * 8 ];
                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3115:59: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        adpt_idct_1x8[ cmp ][ ipos ] = icos_idct_1x8[ ipos ] * quant[ ( ipos % 8 ) * 8 ];
                                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3115:75: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        adpt_idct_1x8[ cmp ][ ipos ] = icos_idct_1x8[ ipos ] * quant[ ( ipos % 8 ) * 8 ];
                                                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3115:81: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        adpt_idct_1x8[ cmp ][ ipos ] = icos_idct_1x8[ ipos ] * quant[ ( ipos % 8 ) * 8 ];
                                                                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3117:26: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                for ( ipos = 0; ipos < 8 * 8; ipos++ )
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3117:30: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                for ( ipos = 0; ipos < 8 * 8; ipos++ )
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3117:41: warning: statement should be inside braces [google-readability-braces-around-statements]
                for ( ipos = 0; ipos < 8 * 8; ipos++ )
                                                      ^
                                                       {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3118:4: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        adpt_idct_8x1[ cmp ][ ipos ] = icos_idct_1x8[ ipos ] * quant[ ipos % 8 ];
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3118:35: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        adpt_idct_8x1[ cmp ][ ipos ] = icos_idct_1x8[ ipos ] * quant[ ipos % 8 ];
                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3118:59: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        adpt_idct_8x1[ cmp ][ ipos ] = icos_idct_1x8[ ipos ] * quant[ ipos % 8 ];
                                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3118:73: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        adpt_idct_8x1[ cmp ][ ipos ] = icos_idct_1x8[ ipos ] * quant[ ipos % 8 ];
                                                                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3130:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool predict_dc( void )
       ~~~~ ^
       auto                    -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3130:25: warning: redundant void argument list in function definition [modernize-redundant-void-arg]
INTERN bool predict_dc( void )
                        ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3132:2: warning: consider replacing 'short' with 'int16' [google-runtime-int]
        signed short* coef;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3136:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int cmp, dpos;  
        ^~~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3141:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                absmaxp = MAX_V( cmp, 0 );
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:26: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3141:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                absmaxp = MAX_V( cmp, 0 );
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:26: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3145:16: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                for ( dpos = cmpnfo[cmp].bc - 1; dpos > 0; dpos-- )     {
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3146:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        coef = &(colldata[cmp][0][dpos]);
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3146:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3150:15: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
                        (*coef) -= dc_1ddct_predictor( cmp, dpos ); // 1d dct
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3154:28: warning: statement should be inside braces [google-readability-braces-around-statements]
                        if ( (*coef) > absmaxp ) (*coef) -= corr_f;
                                                ^
                                                 {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3154:40: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
                        if ( (*coef) > absmaxp ) (*coef) -= corr_f;
                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3155:33: warning: statement should be inside braces [google-readability-braces-around-statements]
                        else if ( (*coef) < absmaxn ) (*coef) += corr_f;
                                                     ^
                                                      {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3155:45: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
                        else if ( (*coef) < absmaxn ) (*coef) += corr_f;
                                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3167:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool unpredict_dc( void )
       ~~~~ ^
       auto                      -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3167:27: warning: redundant void argument list in function definition [modernize-redundant-void-arg]
INTERN bool unpredict_dc( void )
                          ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3169:2: warning: consider replacing 'short' with 'int16' [google-runtime-int]
        signed short* coef;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3173:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int cmp, dpos;
        ^~~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3178:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                absmaxp = MAX_V( cmp, 0 );
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:26: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3178:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                absmaxp = MAX_V( cmp, 0 );
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:26: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3182:26: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                for ( dpos = 1; dpos < cmpnfo[cmp].bc; dpos++ ) {
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3183:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        coef = &(colldata[cmp][0][dpos]);
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3183:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3187:15: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
                        (*coef) += dc_1ddct_predictor( cmp, dpos ); // 1d dct predictor
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3191:28: warning: statement should be inside braces [google-readability-braces-around-statements]
                        if ( (*coef) > absmaxp ) (*coef) -= corr_f;
                                                ^
                                                 {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3191:40: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
                        if ( (*coef) > absmaxp ) (*coef) -= corr_f;
                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3192:33: warning: statement should be inside braces [google-readability-braces-around-statements]
                        else if ( (*coef) < absmaxn ) (*coef) += corr_f;
                                                     ^
                                                      {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3192:45: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
                        else if ( (*coef) < absmaxn ) (*coef) += corr_f;
                                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3205:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool check_value_range( void )
       ~~~~ ^
       auto                           -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3205:32: warning: redundant void argument list in function definition [modernize-redundant-void-arg]
INTERN bool check_value_range( void )
                               ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3208:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int cmp, bpos, dpos;
        ^~~~~~~~~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3211:36: warning: statement should be inside braces [google-readability-braces-around-statements]
        for ( cmp = 0; cmp < cmpc; cmp++ )
                                          ^
                                           {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3212:25: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        for ( bpos = 0; bpos < 64; bpos++ ) {
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3213:12: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                absmax = MAX_V( cmp, bpos );
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:26: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3213:12: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                absmax = MAX_V( cmp, bpos );
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:26: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3214:26: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                for ( dpos = 0; dpos < cmpnfo[cmp].bc; dpos++ )
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3214:50: warning: statement should be inside braces [google-readability-braces-around-statements]
                for ( dpos = 0; dpos < cmpnfo[cmp].bc; dpos++ )
                                                               ^
                                                                {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3215:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( ( colldata[cmp][bpos][dpos] > absmax ) ||
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3215:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3216:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                         ( colldata[cmp][bpos][dpos] < -absmax ) ) {
                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3216:7: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3217:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        sprintf( errormessage, "value out of range error: cmp%i, frq%i, val %i, max %i",
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3217:13: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        sprintf( errormessage, "value out of range error: cmp%i, frq%i, val %i, max %i",
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3218:17: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                        cmp, bpos, colldata[cmp][bpos][dpos], absmax );
                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3218:17: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3225:2: warning: misleading indentation: statement is indented too deeply [readability-misleading-indentation]
        return true;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3211:2: note: did you mean this line to be inside this 'for'
        for ( cmp = 0; cmp < cmpc; cmp++ )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3233:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool calc_zdst_lists( void )
       ~~~~ ^
       auto                         -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3233:30: warning: redundant void argument list in function definition [modernize-redundant-void-arg]
INTERN bool calc_zdst_lists( void )
                             ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3235:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int cmp, bpos, dpos;
        ^~~~~~~~~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3236:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int b_x, b_y;
        ^~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3243:11: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                memset( zdstdata[cmp], 0, cmpnfo[cmp].bc * sizeof( char ) );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3243:29: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                memset( zdstdata[cmp], 0, cmpnfo[cmp].bc * sizeof( char ) );
                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3246:26: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                for ( bpos = 1; bpos < 64; bpos++ ) {
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3247:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        b_x = unzigzag[ bpos ] % 8;
                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3247:29: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        b_x = unzigzag[ bpos ] % 8;
                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3248:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        b_y = unzigzag[ bpos ] / 8;
                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3248:29: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        b_y = unzigzag[ bpos ] / 8;
                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3250:28: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                for ( dpos = 0; dpos < cmpnfo[cmp].bc; dpos++ )
                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3250:52: warning: statement should be inside braces [google-readability-braces-around-statements]
                                for ( dpos = 0; dpos < cmpnfo[cmp].bc; dpos++ )
                                                                               ^
                                                                                {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3251:11: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                        if ( colldata[cmp][bpos][dpos] != 0 ) zdstylow[cmp][dpos]++;
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3251:11: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3251:43: warning: statement should be inside braces [hicpp-braces-around-statements]
                                        if ( colldata[cmp][bpos][dpos] != 0 ) zdstylow[cmp][dpos]++;
                                                                             ^
                                                                              {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3251:44: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                        if ( colldata[cmp][bpos][dpos] != 0 ) zdstylow[cmp][dpos]++;
                                                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3251:44: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3254:28: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                for ( dpos = 0; dpos < cmpnfo[cmp].bc; dpos++ )
                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3254:52: warning: statement should be inside braces [google-readability-braces-around-statements]
                                for ( dpos = 0; dpos < cmpnfo[cmp].bc; dpos++ )
                                                                               ^
                                                                                {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3255:11: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                        if ( colldata[cmp][bpos][dpos] != 0 ) zdstxlow[cmp][dpos]++;
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3255:11: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3255:43: warning: statement should be inside braces [hicpp-braces-around-statements]
                                        if ( colldata[cmp][bpos][dpos] != 0 ) zdstxlow[cmp][dpos]++;
                                                                             ^
                                                                              {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3255:44: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                        if ( colldata[cmp][bpos][dpos] != 0 ) zdstxlow[cmp][dpos]++;
                                                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3255:44: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3258:28: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                for ( dpos = 0; dpos < cmpnfo[cmp].bc; dpos++ )
                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3258:52: warning: statement should be inside braces [google-readability-braces-around-statements]
                                for ( dpos = 0; dpos < cmpnfo[cmp].bc; dpos++ )
                                                                               ^
                                                                                {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3259:11: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                        if ( colldata[cmp][bpos][dpos] != 0 ) zdstdata[cmp][dpos]++;
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3259:11: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3259:43: warning: statement should be inside braces [hicpp-braces-around-statements]
                                        if ( colldata[cmp][bpos][dpos] != 0 ) zdstdata[cmp][dpos]++;
                                                                             ^
                                                                              {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3259:44: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                        if ( colldata[cmp][bpos][dpos] != 0 ) zdstdata[cmp][dpos]++;
                                                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3259:44: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3273:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pack_pjg( void )
       ~~~~ ^
       auto                  -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3273:23: warning: redundant void argument list in function definition [modernize-redundant-void-arg]
INTERN bool pack_pjg( void )
                      ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3283:18: warning: do not use reinterpret_cast [cppcoreguidelines-pro-type-reinterpret-cast]
        str_out->write( reinterpret_cast<const unsigned char*>(pjg_magic), 2 );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3289:19: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                str_out->write( nois_trs, 4 );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3290:19: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                str_out->write( segm_cnt, 4 );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3299:2: warning: initializing non-owner 'ArithmeticEncoder *' with a newly created 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        auto encoder = new ArithmeticEncoder(*str_out);
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3299:2: note: type deduction did not result in an owner
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3302:18: warning: statement should be inside braces [google-readability-braces-around-statements]
        if ( disc_meta )
                        ^
                         {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3303:31: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( !jpg_rebuild_header() ) return false;      
                                            ^
                                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3303:39: warning: Potential leak of memory pointed to by 'encoder' [clang-analyzer-cplusplus.NewDeleteLeaks]
                if ( !jpg_rebuild_header() ) return false;      
                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3286:7: note: Assuming 'auto_set' is true
        if ( !auto_set ) {
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3286:2: note: Taking false branch
        if ( !auto_set ) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3299:17: note: Memory is allocated
        auto encoder = new ArithmeticEncoder(*str_out);
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3302:7: note: Assuming 'disc_meta' is true
        if ( disc_meta )
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3302:2: note: Taking true branch
        if ( disc_meta )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3303:8: note: Assuming the condition is true
                if ( !jpg_rebuild_header() ) return false;      
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3303:3: note: Taking true branch
                if ( !jpg_rebuild_header() ) return false;      
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3303:39: note: Potential leak of memory pointed to by 'encoder'
                if ( !jpg_rebuild_header() ) return false;      
                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3305:31: warning: statement should be inside braces [hicpp-braces-around-statements]
        if ( !pjg_optimize_header() ) return false;     
                                     ^
                                      {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3307:21: warning: statement should be inside braces [hicpp-braces-around-statements]
        if ( padbit == -1 )     padbit = 1;
                           ^
                            {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3311:54: warning: statement should be inside braces [hicpp-braces-around-statements]
        if ( !pjg_encode_generic( encoder, hdrdata, hdrs ) ) return false;
                                                            ^
                                                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3318:43: warning: statement should be inside braces [hicpp-braces-around-statements]
        if ( !pjg_encode_bit( encoder, padbit ) ) return false; 
                                                 ^
                                                  {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3320:67: warning: statement should be inside braces [hicpp-braces-around-statements]
        if ( !pjg_encode_bit( encoder, ( rst_err == nullptr ) ? 0 : 1 ) ) return false;
                                                                         ^
                                                                          {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3322:27: warning: statement should be inside braces [google-readability-braces-around-statements]
        if ( rst_err != nullptr )
                                 ^
                                  {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3323:55: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( !pjg_encode_generic( encoder, rst_err, scnc ) ) return false;
                                                                    ^
                                                                     {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3329:45: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( !pjg_encode_zstscan( encoder, cmp ) ) return false;
                                                          ^
                                                           {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3331:47: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( !pjg_encode_zdst_high( encoder, cmp ) ) return false;
                                                            ^
                                                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3333:45: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( !pjg_encode_ac_high( encoder, cmp ) ) return false;
                                                          ^
                                                           {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3335:46: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( !pjg_encode_zdst_low( encoder, cmp ) ) return false;
                                                           ^
                                                            {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3337:44: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( !pjg_encode_ac_low( encoder, cmp ) ) return false;
                                                         ^
                                                          {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3339:40: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( !pjg_encode_dc( encoder, cmp ) ) return false;             
                                                     ^
                                                      {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3372:57: warning: statement should be inside braces [hicpp-braces-around-statements]
        if ( !pjg_encode_bit( encoder, ( grbs > 0 ) ? 1 : 0 ) ) return false;
                                                               ^
                                                                {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3374:17: warning: statement should be inside braces [google-readability-braces-around-statements]
        if ( grbs > 0 )
                       ^
                        {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3375:56: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( !pjg_encode_generic( encoder, grbgdata, grbs ) ) return false;
                                                                     ^
                                                                      {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3378:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete( encoder );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3299:2: note: variable declared here
        auto encoder = new ArithmeticEncoder(*str_out);
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3383:3: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                sprintf( errormessage, "write error, possibly drive is full" );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3383:12: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                sprintf( errormessage, "write error, possibly drive is full" );
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3400:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool unpack_pjg( void )
       ~~~~ ^
       auto                    -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3400:25: warning: redundant void argument list in function definition [modernize-redundant-void-arg]
INTERN bool unpack_pjg( void )
                        ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3412:18: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        str_in->read( nois_trs, 4 );
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3413:18: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        str_in->read( segm_cnt, 4 );
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3416:22: warning: 0x14 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                else if ( hcode >= 0x14 ) {
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3419:5: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                sprintf( errormessage, "incompatible file, use %s v%i.%i",
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3419:14: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                sprintf( errormessage, "incompatible file, use %s v%i.%i",
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3420:23: warning: 10 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                        appname, hcode / 10, hcode % 10 );
                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3420:35: warning: 10 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                        appname, hcode / 10, hcode % 10 );
                                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3424:4: warning: do not use 'else' after 'return' [readability-else-after-return]
                        else break;
                        ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3424:8: warning: statement should be inside braces [hicpp-braces-around-statements]
                        else break;
                            ^
                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3427:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        sprintf( errormessage, "unknown header code, use newer version of %s", appname );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3427:13: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        sprintf( errormessage, "unknown header code, use newer version of %s", appname );
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3435:2: warning: initializing non-owner 'ArithmeticDecoder *' with a newly created 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        auto decoder = new ArithmeticDecoder(*str_in);
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3435:2: note: type deduction did not result in an owner
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3438:56: warning: statement should be inside braces [hicpp-braces-around-statements]
        if ( !pjg_decode_generic( decoder, &hdrdata, &hdrs ) ) return false;
                                                              ^
                                                               {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3443:11: warning: narrowing conversion from 'unsigned char' to signed type 'char' is implementation-defined [bugprone-narrowing-conversions]
        padbit = cb;
                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3445:40: warning: statement should be inside braces [hicpp-braces-around-statements]
        if ( !pjg_decode_bit( decoder, &cb ) ) return false;
                                              ^
                                               {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3447:16: warning: statement should be inside braces [google-readability-braces-around-statements]
        if ( cb == 1 )
                      ^
                       {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3448:59: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( !pjg_decode_generic( decoder, &rst_err, nullptr ) ) return false;
                                                                        ^
                                                                         {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3451:33: warning: statement should be inside braces [hicpp-braces-around-statements]
        if ( !pjg_unoptimize_header() ) return false;   
                                       ^
                                        {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3453:18: warning: statement should be inside braces [google-readability-braces-around-statements]
        if ( disc_meta )
                        ^
                         {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3454:31: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( !jpg_rebuild_header() ) return false;
                                            ^
                                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3456:29: warning: statement should be inside braces [hicpp-braces-around-statements]
        if ( !jpg_setup_imginfo() ) return false;
                                   ^
                                    {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3461:45: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( !pjg_decode_zstscan( decoder, cmp ) ) return false;                
                                                          ^
                                                           {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3463:47: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( !pjg_decode_zdst_high( decoder, cmp ) ) return false;
                                                            ^
                                                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3465:45: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( !pjg_decode_ac_high( decoder, cmp ) ) return false;
                                                          ^
                                                           {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3467:46: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( !pjg_decode_zdst_low( decoder, cmp ) ) return false;
                                                           ^
                                                            {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3469:44: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( !pjg_decode_ac_low( decoder, cmp ) ) return false; 
                                                         ^
                                                          {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3471:40: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( !pjg_decode_dc( decoder, cmp ) ) return false;     
                                                     ^
                                                      {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3475:40: warning: statement should be inside braces [hicpp-braces-around-statements]
        if ( !pjg_decode_bit( decoder, &cb ) ) return false;
                                              ^
                                               {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3478:16: warning: statement should be inside braces [google-readability-braces-around-statements]
        if ( cb == 0 ) grbs = 0;
                      ^
                       {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3479:62: warning: statement should be inside braces [google-readability-braces-around-statements]
        else if ( !pjg_decode_generic( decoder, &grbgdata, &grbs ) ) return false;
                                                                    ^
                                                                     {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3482:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete( decoder );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3435:2: note: variable declared here
        auto decoder = new ArithmeticDecoder(*str_in);
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3500:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool jpg_setup_imginfo( void )
       ~~~~ ^
       auto                           -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3500:32: warning: redundant void argument list in function definition [modernize-redundant-void-arg]
INTERN bool jpg_setup_imginfo( void )
                               ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3506:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int cmp, bpos;
        ^~~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3511:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                type = hdrdata[ hpos + 1 ];
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3512:13: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                len = 2 + B_SHORT( hdrdata[ hpos + 2 ], hdrdata[ hpos + 3 ] );
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:320:28: note: expanded from macro 'B_SHORT'
#define B_SHORT(v1,v2)  ( ( ((int) v1) << 8 ) + ((int) v2) )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3512:22: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                len = 2 + B_SHORT( hdrdata[ hpos + 2 ], hdrdata[ hpos + 3 ] );
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3512:43: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                len = 2 + B_SHORT( hdrdata[ hpos + 2 ], hdrdata[ hpos + 3 ] );
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3514:18: warning: 0xDA is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                if ( ( type != 0xDA ) && ( type != 0xC4 ) && ( type != 0xDD ) ) {
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3514:38: warning: 0xC4 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                if ( ( type != 0xDA ) && ( type != 0xC4 ) && ( type != 0xDD ) ) {
                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3514:58: warning: 0xDD is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                if ( ( type != 0xDA ) && ( type != 0xC4 ) && ( type != 0xDD ) ) {
                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3515:40: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        if ( !jpg_parse_jfif( type, len, &( hdrdata[ hpos ] ) ) )
                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3515:61: warning: statement should be inside braces [google-readability-braces-around-statements]
                        if ( !jpg_parse_jfif( type, len, &( hdrdata[ hpos ] ) ) )
                                                                                 ^
                                                                                  {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3523:3: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                sprintf( errormessage, "header contains incomplete information" );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3523:12: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                sprintf( errormessage, "header contains incomplete information" );
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3528:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( ( cmpnfo[cmp].sfv == 0 ) ||
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3529:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                         ( cmpnfo[cmp].sfh == 0 ) ||
                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3530:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                         ( cmpnfo[cmp].qtable == nullptr ) ||
                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3531:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                         ( cmpnfo[cmp].qtable[0] == 0 ) ||
                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3531:7: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3533:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        sprintf( errormessage, "header information is incomplete" );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3533:13: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        sprintf( errormessage, "header information is incomplete" );
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3541:8: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( cmpnfo[ cmp ].sfh > sfhm ) sfhm = cmpnfo[ cmp ].sfh;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3541:34: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( cmpnfo[ cmp ].sfh > sfhm ) sfhm = cmpnfo[ cmp ].sfh;
                                               ^
                                                {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3541:42: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( cmpnfo[ cmp ].sfh > sfhm ) sfhm = cmpnfo[ cmp ].sfh;
                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3542:8: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( cmpnfo[ cmp ].sfv > sfvm ) sfvm = cmpnfo[ cmp ].sfv;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3542:34: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( cmpnfo[ cmp ].sfv > sfvm ) sfvm = cmpnfo[ cmp ].sfv;
                                               ^
                                                {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3542:42: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( cmpnfo[ cmp ].sfv > sfvm ) sfvm = cmpnfo[ cmp ].sfv;
                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3544:90: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        mcuv = static_cast< int>(std::ceil( static_cast<float>(imgheight) / static_cast<float>( 8 * sfhm ) ));
                                                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3545:90: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        mcuh = static_cast< int>(std::ceil( static_cast<float>(imgwidth)  / static_cast<float>( 8 * sfvm ) ));
                                                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3548:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].mbs = cmpnfo[ cmp ].sfv * cmpnfo[ cmp ].sfh;              
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3548:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].mbs = cmpnfo[ cmp ].sfv * cmpnfo[ cmp ].sfh;              
                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3548:43: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].mbs = cmpnfo[ cmp ].sfv * cmpnfo[ cmp ].sfh;              
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3549:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].bcv = mcuv * cmpnfo[ cmp ].sfh;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3549:30: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].bcv = mcuv * cmpnfo[ cmp ].sfh;
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3550:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].bch = mcuh * cmpnfo[ cmp ].sfv;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3550:30: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].bch = mcuh * cmpnfo[ cmp ].sfv;
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3551:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].bc  = cmpnfo[ cmp ].bcv * cmpnfo[ cmp ].bch;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3551:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].bc  = cmpnfo[ cmp ].bcv * cmpnfo[ cmp ].bch;
                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3551:43: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].bc  = cmpnfo[ cmp ].bcv * cmpnfo[ cmp ].bch;
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3552:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].ncv = static_cast< int>(ceil( static_cast<float>(imgheight) * 
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3553:29: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        ( static_cast<float>(cmpnfo[ cmp ].sfh) / ( 8.0 * sfhm ) ) ));
                                                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3553:52: warning: 8.0 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                                        ( static_cast<float>(cmpnfo[ cmp ].sfh) / ( 8.0 * sfhm ) ) ));
                                                                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3554:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].nch = static_cast< int>(ceil( static_cast<float>(imgwidth) * 
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3555:29: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                        ( static_cast<float>(cmpnfo[ cmp ].sfv) / ( 8.0 * sfvm ) ) ));
                                                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3555:52: warning: 8.0 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                                        ( static_cast<float>(cmpnfo[ cmp ].sfv) / ( 8.0 * sfvm ) ) ));
                                                                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3556:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].nc  = cmpnfo[ cmp ].ncv * cmpnfo[ cmp ].nch;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3556:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].nc  = cmpnfo[ cmp ].ncv * cmpnfo[ cmp ].nch;
                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3556:43: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                cmpnfo[ cmp ].nc  = cmpnfo[ cmp ].ncv * cmpnfo[ cmp ].nch;
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3561:37: warning: statement should be inside braces [hicpp-braces-around-statements]
                for ( cmp = 0; cmp < cmpc; cmp++ ) cmpnfo[ cmp ].sid = cmp;
                                                  ^
                                                   {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3561:38: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                for ( cmp = 0; cmp < cmpc; cmp++ ) cmpnfo[ cmp ].sid = cmp;
                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3564:37: warning: statement should be inside braces [hicpp-braces-around-statements]
                for ( cmp = 0; cmp < cmpc; cmp++ ) cmpnfo[ cmp ].sid = 0;
                                                  ^
                                                   {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3564:38: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                for ( cmp = 0; cmp < cmpc; cmp++ ) cmpnfo[ cmp ].sid = 0;
                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3571:26: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                for ( bpos = 0; bpos < 64; bpos++ ) {
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3572:4: warning: assigning newly created 'gsl::owner<>' to non-owner 'short *' [cppcoreguidelines-owning-memory]
                        colldata[cmp][bpos] = static_cast<short int*>(calloc ( cmpnfo[cmp].bc, sizeof( short ) ));
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3572:4: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3572:38: warning: consider replacing 'short' with 'int16' [google-runtime-int]
                        colldata[cmp][bpos] = static_cast<short int*>(calloc ( cmpnfo[cmp].bc, sizeof( short ) ));
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3572:50: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
                        colldata[cmp][bpos] = static_cast<short int*>(calloc ( cmpnfo[cmp].bc, sizeof( short ) ));
                                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3572:59: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        colldata[cmp][bpos] = static_cast<short int*>(calloc ( cmpnfo[cmp].bc, sizeof( short ) ));
                                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3572:83: warning: consider replacing 'short' with 'int16' [google-runtime-int]
                        colldata[cmp][bpos] = static_cast<short int*>(calloc ( cmpnfo[cmp].bc, sizeof( short ) ));
                                                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3573:8: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        if (colldata[cmp][bpos] == nullptr) {
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3574:5: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                sprintf( errormessage, MEM_ERRMSG );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3574:14: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                sprintf( errormessage, MEM_ERRMSG );
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3581:3: warning: assigning newly created 'gsl::owner<>' to non-owner 'unsigned char *' [cppcoreguidelines-owning-memory]
                zdstdata[cmp] = static_cast<unsigned char*>(calloc( cmpnfo[cmp].bc, sizeof( char ) ));
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3581:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3581:47: warning: Result of 'calloc' is converted to a pointer of type 'unsigned char', which is incompatible with sizeof operand type 'char' [clang-analyzer-unix.MallocSizeof]
                zdstdata[cmp] = static_cast<unsigned char*>(calloc( cmpnfo[cmp].bc, sizeof( char ) ));
                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3581:47: note: Result of 'calloc' is converted to a pointer of type 'unsigned char', which is incompatible with sizeof operand type 'char'
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3581:47: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
                zdstdata[cmp] = static_cast<unsigned char*>(calloc( cmpnfo[cmp].bc, sizeof( char ) ));
                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3581:55: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                zdstdata[cmp] = static_cast<unsigned char*>(calloc( cmpnfo[cmp].bc, sizeof( char ) ));
                                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3582:3: warning: assigning newly created 'gsl::owner<>' to non-owner 'unsigned char *' [cppcoreguidelines-owning-memory]
                eobxhigh[cmp] = static_cast<unsigned char*>(calloc( cmpnfo[cmp].bc, sizeof( char ) ));
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3582:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3582:47: warning: Result of 'calloc' is converted to a pointer of type 'unsigned char', which is incompatible with sizeof operand type 'char' [clang-analyzer-unix.MallocSizeof]
                eobxhigh[cmp] = static_cast<unsigned char*>(calloc( cmpnfo[cmp].bc, sizeof( char ) ));
                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3582:47: note: Result of 'calloc' is converted to a pointer of type 'unsigned char', which is incompatible with sizeof operand type 'char'
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3582:47: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
                eobxhigh[cmp] = static_cast<unsigned char*>(calloc( cmpnfo[cmp].bc, sizeof( char ) ));
                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3582:55: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                eobxhigh[cmp] = static_cast<unsigned char*>(calloc( cmpnfo[cmp].bc, sizeof( char ) ));
                                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3583:3: warning: assigning newly created 'gsl::owner<>' to non-owner 'unsigned char *' [cppcoreguidelines-owning-memory]
                eobyhigh[cmp] = static_cast<unsigned char*>(calloc( cmpnfo[cmp].bc, sizeof( char ) ));
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3583:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3583:47: warning: Result of 'calloc' is converted to a pointer of type 'unsigned char', which is incompatible with sizeof operand type 'char' [clang-analyzer-unix.MallocSizeof]
                eobyhigh[cmp] = static_cast<unsigned char*>(calloc( cmpnfo[cmp].bc, sizeof( char ) ));
                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3583:47: note: Result of 'calloc' is converted to a pointer of type 'unsigned char', which is incompatible with sizeof operand type 'char'
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3583:47: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
                eobyhigh[cmp] = static_cast<unsigned char*>(calloc( cmpnfo[cmp].bc, sizeof( char ) ));
                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3583:55: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                eobyhigh[cmp] = static_cast<unsigned char*>(calloc( cmpnfo[cmp].bc, sizeof( char ) ));
                                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3584:3: warning: assigning newly created 'gsl::owner<>' to non-owner 'unsigned char *' [cppcoreguidelines-owning-memory]
                zdstxlow[cmp] = static_cast<unsigned char*>(calloc( cmpnfo[cmp].bc, sizeof( char ) ));
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3584:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3584:47: warning: Result of 'calloc' is converted to a pointer of type 'unsigned char', which is incompatible with sizeof operand type 'char' [clang-analyzer-unix.MallocSizeof]
                zdstxlow[cmp] = static_cast<unsigned char*>(calloc( cmpnfo[cmp].bc, sizeof( char ) ));
                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3584:47: note: Result of 'calloc' is converted to a pointer of type 'unsigned char', which is incompatible with sizeof operand type 'char'
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3584:47: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
                zdstxlow[cmp] = static_cast<unsigned char*>(calloc( cmpnfo[cmp].bc, sizeof( char ) ));
                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3584:55: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                zdstxlow[cmp] = static_cast<unsigned char*>(calloc( cmpnfo[cmp].bc, sizeof( char ) ));
                                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3585:3: warning: assigning newly created 'gsl::owner<>' to non-owner 'unsigned char *' [cppcoreguidelines-owning-memory]
                zdstylow[cmp] = static_cast<unsigned char*>(calloc( cmpnfo[cmp].bc, sizeof( char ) ));
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3585:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3585:47: warning: Result of 'calloc' is converted to a pointer of type 'unsigned char', which is incompatible with sizeof operand type 'char' [clang-analyzer-unix.MallocSizeof]
                zdstylow[cmp] = static_cast<unsigned char*>(calloc( cmpnfo[cmp].bc, sizeof( char ) ));
                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3585:47: note: Result of 'calloc' is converted to a pointer of type 'unsigned char', which is incompatible with sizeof operand type 'char'
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3585:47: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
                zdstylow[cmp] = static_cast<unsigned char*>(calloc( cmpnfo[cmp].bc, sizeof( char ) ));
                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3585:55: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                zdstylow[cmp] = static_cast<unsigned char*>(calloc( cmpnfo[cmp].bc, sizeof( char ) ));
                                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3586:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( ( zdstdata[cmp] == nullptr ) ||
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3587:6: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        ( eobxhigh[cmp] == nullptr ) || ( eobyhigh[cmp] == nullptr ) ||
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3587:38: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        ( eobxhigh[cmp] == nullptr ) || ( eobyhigh[cmp] == nullptr ) ||
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3588:6: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        ( zdstxlow[cmp] == nullptr ) || ( zdstylow[cmp] == nullptr ) ) {
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3588:38: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        ( zdstxlow[cmp] == nullptr ) || ( zdstylow[cmp] == nullptr ) ) {
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3589:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        sprintf( errormessage, MEM_ERRMSG );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3589:13: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        sprintf( errormessage, MEM_ERRMSG );
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3599:5: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                conf_sets[ i ][ cmpnfo[cmp].sid ] > static_cast<unsigned int>(cmpnfo[ cmp ].bc);
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3599:21: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                conf_sets[ i ][ cmpnfo[cmp].sid ] > static_cast<unsigned int>(cmpnfo[ cmp ].bc);
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3599:67: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                conf_sets[ i ][ cmpnfo[cmp].sid ] > static_cast<unsigned int>(cmpnfo[ cmp ].bc);
                                                                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3600:10: warning: statement should be inside braces [hicpp-braces-around-statements]
                                i++ );
                                     ^
                                      {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3601:4: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        segm_cnt[ cmp ] = conf_segm[ i ][ cmpnfo[cmp].sid ];
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3601:22: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        segm_cnt[ cmp ] = conf_segm[ i ][ cmpnfo[cmp].sid ];
                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3601:38: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        segm_cnt[ cmp ] = conf_segm[ i ][ cmpnfo[cmp].sid ];
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3602:4: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        nois_trs[ cmp ] = conf_ntrs[ i ][ cmpnfo[cmp].sid ];
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3602:22: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        nois_trs[ cmp ] = conf_ntrs[ i ][ cmpnfo[cmp].sid ];
                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3602:38: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        nois_trs[ cmp ] = conf_ntrs[ i ][ cmpnfo[cmp].sid ];
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3614:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool jpg_parse_jfif( unsigned char type, unsigned int len, unsigned char* segment )
       ~~~~ ^
       auto                                                                                -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3617:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int lval, rval; // temporary variables
        ^~~~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3625:8: warning: 0xC4 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xC4: // DHT segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3628:19: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                lval = LBITS( segment[ hpos ], 4 );
                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3628:19: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/./bitops.h:5:26: note: expanded from macro 'LBITS'
#define LBITS( c, n )           ( c >> (8 - n) )
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3629:12: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                rval = RBITS( segment[ hpos ], 4 );
                                       ^
/home/mangix/devstuff/packJPG/source/./bitops.h:4:32: note: expanded from macro 'RBITS'
#define RBITS( c, n )           ( c & ( 0xFF >> (8 - n) ) )
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3629:19: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                rval = RBITS( segment[ hpos ], 4 );
                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3629:19: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/./bitops.h:4:26: note: expanded from macro 'RBITS'
#define RBITS( c, n )           ( c & ( 0xFF >> (8 - n) ) )
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3630:70: warning: statement should be inside braces [google-readability-braces-around-statements]
                                if ( ((lval < 0) || (lval >= 2)) || ((rval < 0) || (rval >= 4)) )
                                                                                                 ^
                                                                                                  {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3635:28: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                jpg_build_huffcodes( &(segment[ hpos + 0 ]), &(segment[ hpos + 16 ]),
                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3635:52: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                jpg_build_huffcodes( &(segment[ hpos + 0 ]), &(segment[ hpos + 16 ]),
                                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3635:68: warning: 16 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                jpg_build_huffcodes( &(segment[ hpos + 0 ]), &(segment[ hpos + 16 ]),
                                                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3636:8: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                        &(hcodes[ lval ][ rval ]), &(htrees[ lval ][ rval ]) );
                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3636:35: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                        &(hcodes[ lval ][ rval ]), &(htrees[ lval ][ rval ]) );
                                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3637:5: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                htset[ lval ][ rval ] = 1;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3639:12: warning: 16 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                skip = 16;
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3640:22: warning: 16 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                for ( i = 0; i < 16; i++ )              
                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3640:31: warning: statement should be inside braces [google-readability-braces-around-statements]
                                for ( i = 0; i < 16; i++ )              
                                                          ^
                                                           {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3641:32: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                        skip += static_cast< int>(segment[ hpos + i ]);                         
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3647:5: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                sprintf( errormessage, "size mismatch in dht marker" );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3647:14: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                sprintf( errormessage, "size mismatch in dht marker" );
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3653:8: warning: 0xDB is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xDB: // DQT segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3656:19: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                lval = LBITS( segment[ hpos ], 4 );
                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3656:19: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/./bitops.h:5:26: note: expanded from macro 'LBITS'
#define LBITS( c, n )           ( c >> (8 - n) )
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3657:12: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                rval = RBITS( segment[ hpos ], 4 );
                                       ^
/home/mangix/devstuff/packJPG/source/./bitops.h:4:32: note: expanded from macro 'RBITS'
#define RBITS( c, n )           ( c & ( 0xFF >> (8 - n) ) )
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3657:19: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                rval = RBITS( segment[ hpos ], 4 );
                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3657:19: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/./bitops.h:4:26: note: expanded from macro 'RBITS'
#define RBITS( c, n )           ( c & ( 0xFF >> (8 - n) ) )
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3658:37: warning: statement should be inside braces [hicpp-braces-around-statements]
                                if ( (lval < 0) || (lval >= 2) ) break;
                                                                ^
                                                                 {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3659:37: warning: statement should be inside braces [hicpp-braces-around-statements]
                                if ( (rval < 0) || (rval >= 4) ) break;
                                                                ^
                                                                 {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3662:23: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                        for ( i = 0; i < 64; i++ ) {
                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3663:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                qtables[ rval ][ i ] = static_cast< unsigned short>(segment[ hpos + i ]);
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3663:43: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
                                                qtables[ rval ][ i ] = static_cast< unsigned short>(segment[ hpos + i ]);
                                                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3663:59: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                                qtables[ rval ][ i ] = static_cast< unsigned short>(segment[ hpos + i ]);
                                                                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3664:12: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                if ( qtables[ rval ][ i ] == 0 ) break;
                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3664:39: warning: statement should be inside braces [hicpp-braces-around-statements]
                                                if ( qtables[ rval ][ i ] == 0 ) break;
                                                                                ^
                                                                                 {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3666:14: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                        hpos += 64;
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3669:23: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                        for ( i = 0; i < 64; i++ ) {
                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3670:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                qtables[ rval ][ i ] =
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3671:8: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                                        B_SHORT( segment[ hpos + (2*i) ], segment[ hpos + (2*i) + 1 ] );
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:320:28: note: expanded from macro 'B_SHORT'
#define B_SHORT(v1,v2)  ( ( ((int) v1) << 8 ) + ((int) v2) )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3671:17: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                                        B_SHORT( segment[ hpos + (2*i) ], segment[ hpos + (2*i) + 1 ] );
                                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3671:42: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                                        B_SHORT( segment[ hpos + (2*i) ], segment[ hpos + (2*i) + 1 ] );
                                                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3672:12: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                if ( qtables[ rval ][ i ] == 0 ) break;
                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3672:39: warning: statement should be inside braces [hicpp-braces-around-statements]
                                                if ( qtables[ rval ][ i ] == 0 ) break;
                                                                                ^
                                                                                 {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3674:14: warning: 128 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                        hpos += 128;
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3680:5: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                sprintf( errormessage, "size mismatch in dqt marker" );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3680:14: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                sprintf( errormessage, "size mismatch in dqt marker" );
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3686:8: warning: 0xDD is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xDD: // DRI segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3688:11: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                        rsti = B_SHORT( segment[ hpos ], segment[ hpos + 1 ] );                 
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:320:28: note: expanded from macro 'B_SHORT'
#define B_SHORT(v1,v2)  ( ( ((int) v1) << 8 ) + ((int) v2) )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3688:20: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        rsti = B_SHORT( segment[ hpos ], segment[ hpos + 1 ] );                 
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3688:37: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        rsti = B_SHORT( segment[ hpos ], segment[ hpos + 1 ] );                 
                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3691:8: warning: 0xDA is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xDA: // SOS segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3693:14: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        cs_cmpc = segment[ hpos ];
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3695:5: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                sprintf( errormessage, "%i components in scan, only %i are allowed",
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3695:14: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                sprintf( errormessage, "%i components in scan, only %i are allowed",
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3702:22: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                for ( cmp = 0; ( segment[ hpos ] != cmpnfo[ cmp ].jid ) && ( cmp < cmpc ); cmp++ );
                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3702:41: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                for ( cmp = 0; ( segment[ hpos ] != cmpnfo[ cmp ].jid ) && ( cmp < cmpc ); cmp++ );
                                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3702:87: warning: statement should be inside braces [hicpp-braces-around-statements]
                                for ( cmp = 0; ( segment[ hpos ] != cmpnfo[ cmp ].jid ) && ( cmp < cmpc ); cmp++ );
                                                                                                                  ^
                                                                                                                   {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3704:6: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                        sprintf( errormessage, "component id mismatch in start-of-scan" );
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3704:15: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                        sprintf( errormessage, "component id mismatch in start-of-scan" );
                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3708:5: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                cs_cmp[ i ] = cmp;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3709:5: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                cmpnfo[ cmp ].huffdc = LBITS( segment[ hpos + 1 ], 4 );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3709:35: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                cmpnfo[ cmp ].huffdc = LBITS( segment[ hpos + 1 ], 4 );
                                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3709:35: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/./bitops.h:5:26: note: expanded from macro 'LBITS'
#define LBITS( c, n )           ( c >> (8 - n) )
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3710:5: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                cmpnfo[ cmp ].huffac = RBITS( segment[ hpos + 1 ], 4 );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3710:28: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                cmpnfo[ cmp ].huffac = RBITS( segment[ hpos + 1 ], 4 );
                                                       ^
/home/mangix/devstuff/packJPG/source/./bitops.h:4:32: note: expanded from macro 'RBITS'
#define RBITS( c, n )           ( c & ( 0xFF >> (8 - n) ) )
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3710:35: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                cmpnfo[ cmp ].huffac = RBITS( segment[ hpos + 1 ], 4 );
                                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3710:35: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/./bitops.h:4:26: note: expanded from macro 'RBITS'
#define RBITS( c, n )           ( c & ( 0xFF >> (8 - n) ) )
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3711:12: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                if ( ( cmpnfo[ cmp ].huffdc < 0 ) || ( cmpnfo[ cmp ].huffdc >= 4 ) ||
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3711:44: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                if ( ( cmpnfo[ cmp ].huffdc < 0 ) || ( cmpnfo[ cmp ].huffdc >= 4 ) ||
                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3712:9: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                         ( cmpnfo[ cmp ].huffac < 0 ) || ( cmpnfo[ cmp ].huffac >= 4 ) ) {
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3712:41: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                         ( cmpnfo[ cmp ].huffac < 0 ) || ( cmpnfo[ cmp ].huffac >= 4 ) ) {
                                                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3713:6: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                        sprintf( errormessage, "huffman table number mismatch" );
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3713:15: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                        sprintf( errormessage, "huffman table number mismatch" );
                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3719:14: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        cs_from = segment[ hpos + 0 ];
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3720:14: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        cs_to   = segment[ hpos + 1 ];
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3721:21: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        cs_sah  = LBITS( segment[ hpos + 2 ], 4 );
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3721:21: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/./bitops.h:5:26: note: expanded from macro 'LBITS'
#define LBITS( c, n )           ( c >> (8 - n) )
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3722:14: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                        cs_sal  = RBITS( segment[ hpos + 2 ], 4 );
                                  ^
/home/mangix/devstuff/packJPG/source/./bitops.h:4:32: note: expanded from macro 'RBITS'
#define RBITS( c, n )           ( c & ( 0xFF >> (8 - n) ) )
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3722:21: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        cs_sal  = RBITS( segment[ hpos + 2 ], 4 );
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3722:21: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/./bitops.h:4:26: note: expanded from macro 'RBITS'
#define RBITS( c, n )           ( c & ( 0xFF >> (8 - n) ) )
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3724:44: warning: 63 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        if ( ( cs_from > cs_to ) || ( cs_from > 63 ) || ( cs_to > 63 ) ) {
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3724:62: warning: 63 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        if ( ( cs_from > cs_to ) || ( cs_from > 63 ) || ( cs_to > 63 ) ) {
                                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3725:5: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                sprintf( errormessage, "spectral selection parameter out of range" );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3725:14: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                sprintf( errormessage, "spectral selection parameter out of range" );
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3729:21: warning: 12 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        if ( ( cs_sah >= 12 ) || ( cs_sal >= 12 ) ) {
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3729:41: warning: 12 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        if ( ( cs_sah >= 12 ) || ( cs_sal >= 12 ) ) {
                                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3730:5: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                sprintf( errormessage, "successive approximation parameter out of range" );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3730:14: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                sprintf( errormessage, "successive approximation parameter out of range" );
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3736:8: warning: 0xC0 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xC0: // SOF0 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3739:8: warning: 0xC1 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xC1: // SOF1 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3742:8: warning: 0xC2 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xC2: // SOF2 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3746:17: warning: 0xC2 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        if ( type == 0xC2 )
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3746:23: warning: statement should be inside braces [google-readability-braces-around-statements]
                        if ( type == 0xC2 )
                                           ^
                                            {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3748:8: warning: statement should be inside braces [google-readability-braces-around-statements]
                        else
                            ^
                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3752:11: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        lval = segment[ hpos ];
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3753:17: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        if ( lval != 8 ) {
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3754:5: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                sprintf( errormessage, "%i bit data precision is not supported", lval );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3754:14: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                sprintf( errormessage, "%i bit data precision is not supported", lval );
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3760:16: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                        imgheight = B_SHORT( segment[ hpos + 1 ], segment[ hpos + 2 ] );
                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:320:28: note: expanded from macro 'B_SHORT'
#define B_SHORT(v1,v2)  ( ( ((int) v1) << 8 ) + ((int) v2) )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3760:25: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        imgheight = B_SHORT( segment[ hpos + 1 ], segment[ hpos + 2 ] );
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3760:46: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        imgheight = B_SHORT( segment[ hpos + 1 ], segment[ hpos + 2 ] );
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3761:16: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                        imgwidth  = B_SHORT( segment[ hpos + 3 ], segment[ hpos + 4 ] );
                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:320:28: note: expanded from macro 'B_SHORT'
#define B_SHORT(v1,v2)  ( ( ((int) v1) << 8 ) + ((int) v2) )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3761:25: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        imgwidth  = B_SHORT( segment[ hpos + 3 ], segment[ hpos + 4 ] );
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3761:46: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        imgwidth  = B_SHORT( segment[ hpos + 3 ], segment[ hpos + 4 ] );
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3762:16: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        cmpc      = segment[ hpos + 5 ];
                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3762:32: warning: 5 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        cmpc      = segment[ hpos + 5 ];
                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3764:5: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                sprintf( errormessage, "resolution is %ix%i, possible malformed JPEG", imgwidth, imgheight );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3764:14: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                sprintf( errormessage, "resolution is %ix%i, possible malformed JPEG", imgwidth, imgheight );
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3769:5: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                                sprintf( errormessage, "image has %i components, max 4 are supported", cmpc );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3769:14: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                sprintf( errormessage, "image has %i components, max 4 are supported", cmpc );
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3774:12: warning: 6 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        hpos += 6;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3777:5: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                cmpnfo[ cmp ].jid = segment[ hpos ];
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3777:25: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                cmpnfo[ cmp ].jid = segment[ hpos ];
                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3778:5: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                cmpnfo[ cmp ].sfv = LBITS( segment[ hpos + 1 ], 4 );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3778:32: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                cmpnfo[ cmp ].sfv = LBITS( segment[ hpos + 1 ], 4 );
                                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3778:32: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/./bitops.h:5:26: note: expanded from macro 'LBITS'
#define LBITS( c, n )           ( c >> (8 - n) )
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3779:5: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                cmpnfo[ cmp ].sfh = RBITS( segment[ hpos + 1 ], 4 );                            
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3779:25: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                cmpnfo[ cmp ].sfh = RBITS( segment[ hpos + 1 ], 4 );                            
                                                    ^
/home/mangix/devstuff/packJPG/source/./bitops.h:4:32: note: expanded from macro 'RBITS'
#define RBITS( c, n )           ( c & ( 0xFF >> (8 - n) ) )
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3779:32: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                cmpnfo[ cmp ].sfh = RBITS( segment[ hpos + 1 ], 4 );                            
                                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3779:32: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/./bitops.h:4:26: note: expanded from macro 'RBITS'
#define RBITS( c, n )           ( c & ( 0xFF >> (8 - n) ) )
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3780:5: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                cmpnfo[ cmp ].qtable = qtables[ segment[ hpos + 2 ] ];
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3780:28: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                cmpnfo[ cmp ].qtable = qtables[ segment[ hpos + 2 ] ];
                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3780:28: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3780:37: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                cmpnfo[ cmp ].qtable = qtables[ segment[ hpos + 2 ] ];
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3786:8: warning: 0xC3 is a magic number; consider replacing it with a named constant [readability-magic-numbers]
                case 0xC3: // SOF3 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3788:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        sprintf( errormessage, "sof3 marker found, image is coded lossless" );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3788:13: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        sprintf( errormessage, "sof3 marker found, image is coded lossless" );
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3792:8: warning: 0xC5 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xC5: // SOF5 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3794:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        sprintf( errormessage, "sof5 marker found, image is coded diff. sequential" );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3794:13: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        sprintf( errormessage, "sof5 marker found, image is coded diff. sequential" );
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3798:8: warning: 0xC6 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xC6: // SOF6 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3800:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        sprintf( errormessage, "sof6 marker found, image is coded diff. progressive" );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3800:13: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        sprintf( errormessage, "sof6 marker found, image is coded diff. progressive" );
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3804:8: warning: 0xC7 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xC7: // SOF7 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3806:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        sprintf( errormessage, "sof7 marker found, image is coded diff. lossless" );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3806:13: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        sprintf( errormessage, "sof7 marker found, image is coded diff. lossless" );
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3810:8: warning: 0xC9 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xC9: // SOF9 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3812:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        sprintf( errormessage, "sof9 marker found, image is coded arithm. sequential" );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3812:13: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        sprintf( errormessage, "sof9 marker found, image is coded arithm. sequential" );
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3816:8: warning: 0xCA is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xCA: // SOF10 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3818:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        sprintf( errormessage, "sof10 marker found, image is coded arithm. progressive" );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3818:13: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        sprintf( errormessage, "sof10 marker found, image is coded arithm. progressive" );
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3822:8: warning: 0xCB is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xCB: // SOF11 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3824:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        sprintf( errormessage, "sof11 marker found, image is coded arithm. lossless" );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3824:13: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        sprintf( errormessage, "sof11 marker found, image is coded arithm. lossless" );
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3828:8: warning: 0xCD is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xCD: // SOF13 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3830:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        sprintf( errormessage, "sof13 marker found, image is coded arithm. diff. sequential" );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3830:13: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        sprintf( errormessage, "sof13 marker found, image is coded arithm. diff. sequential" );
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3834:8: warning: 0xCE is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xCE: // SOF14 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3836:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        sprintf( errormessage, "sof14 marker found, image is coded arithm. diff. progressive" );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3836:13: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        sprintf( errormessage, "sof14 marker found, image is coded arithm. diff. progressive" );
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3840:8: warning: 0xCF is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xCF: // SOF15 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3842:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        sprintf( errormessage, "sof15 marker found, image is coded arithm. diff. lossless" );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3842:13: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        sprintf( errormessage, "sof15 marker found, image is coded arithm. diff. lossless" );
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3846:8: warning: 0xE0 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xE0: // APP0 segment      
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3847:8: warning: 0xE1 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xE1: // APP1 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3848:8: warning: 0xE2 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xE2: // APP2 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3849:8: warning: 0xE3 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xE3: // APP3 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3850:8: warning: 0xE4 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xE4: // APP4 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3851:8: warning: 0xE5 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xE5: // APP5 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3852:8: warning: 0xE6 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xE6: // APP6 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3853:8: warning: 0xE7 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xE7: // APP7 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3854:8: warning: 0xE8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xE8: // APP8 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3855:8: warning: 0xE9 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xE9: // APP9 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3856:8: warning: 0xEA is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xEA: // APP10 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3857:8: warning: 0xEB is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xEB: // APP11 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3858:8: warning: 0xEC is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xEC: // APP12 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3859:8: warning: 0xED is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xED: // APP13 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3860:8: warning: 0xEE is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xEE: // APP14 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3861:8: warning: 0xEF is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xEF: // APP15 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3862:8: warning: 0xFE is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xFE: // COM segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3866:8: warning: 0xD0 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xD0: // RST0 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3867:8: warning: 0xD1 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xD1: // RST1 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3868:8: warning: 0xD2 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xD2: // RST2 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3869:8: warning: 0xD3 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xD3: // RST3 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3870:8: warning: 0xD4 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xD4: // RST4 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3871:8: warning: 0xD5 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xD5: // RST5 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3872:8: warning: 0xD6 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xD6: // RST6 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3873:8: warning: 0xD7 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xD7: // RST7 segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3875:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        sprintf( errormessage, "rst marker found out of place" );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3875:13: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        sprintf( errormessage, "rst marker found out of place" );
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3879:8: warning: 0xD8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xD8: // SOI segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3881:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        sprintf( errormessage, "soi marker found out of place" );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3881:13: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        sprintf( errormessage, "soi marker found out of place" );
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3885:8: warning: 0xD9 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                case 0xD9: // EOI segment
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3887:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        sprintf( errormessage, "eoi marker found out of place" );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3887:13: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        sprintf( errormessage, "eoi marker found out of place" );
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3893:4: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                        sprintf( errormessage, "unknown marker found: FF %2X", type );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3893:13: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        sprintf( errormessage, "unknown marker found: FF %2X", type );
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3903:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool jpg_rebuild_header( void )
       ~~~~ ^
       auto                            -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3903:33: warning: redundant void argument list in function definition [modernize-redundant-void-arg]
INTERN bool jpg_rebuild_header( void )
                                ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3913:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'MemoryWriter *' [cppcoreguidelines-owning-memory]
        hdrw = new MemoryWriter();
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3917:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                type = hdrdata[ hpos + 1 ];
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3918:13: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                len = 2 + B_SHORT( hdrdata[ hpos + 2 ], hdrdata[ hpos + 3 ] );
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:320:28: note: expanded from macro 'B_SHORT'
#define B_SHORT(v1,v2)  ( ( ((int) v1) << 8 ) + ((int) v2) )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3918:22: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                len = 2 + B_SHORT( hdrdata[ hpos + 2 ], hdrdata[ hpos + 3 ] );
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3918:43: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                len = 2 + B_SHORT( hdrdata[ hpos + 2 ], hdrdata[ hpos + 3 ] );
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3920:18: warning: 0xDA is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                if ( ( type == 0xDA ) || ( type == 0xC4 ) || ( type == 0xDB ) ||
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3920:38: warning: 0xC4 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                if ( ( type == 0xDA ) || ( type == 0xC4 ) || ( type == 0xDB ) ||
                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3920:58: warning: 0xDB is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                if ( ( type == 0xDA ) || ( type == 0xC4 ) || ( type == 0xDB ) ||
                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3921:15: warning: 0xC0 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                         ( type == 0xC0 ) || ( type == 0xC1 ) || ( type == 0xC2 ) ||
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3921:35: warning: 0xC1 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                         ( type == 0xC0 ) || ( type == 0xC1 ) || ( type == 0xC2 ) ||
                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3921:55: warning: 0xC2 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                         ( type == 0xC0 ) || ( type == 0xC1 ) || ( type == 0xC2 ) ||
                                                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3922:15: warning: 0xDD is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                         ( type == 0xDD ) ) {
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3923:19: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        hdrw->write( &(hdrdata[ hpos ]), len );
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3929:2: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        free( hdrdata );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3929:2: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3932:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete( hdrw );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3905:2: note: variable declared here
        MemoryWriter* hdrw; // new header writer
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3942:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_decode_block_seq( BitReader* huffr, huffTree* dctree, huffTree* actree, short* block )
       ~~~ ^
       auto                                                                                           -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3942:88: warning: consider replacing 'short' with 'int16' [google-runtime-int]
INTERN int jpg_decode_block_seq( BitReader* huffr, huffTree* dctree, huffTree* actree, short* block )
                                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3944:2: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        unsigned short n;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3947:12: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        int eob = 64;
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3954:15: warning: statement should be inside braces [google-readability-braces-around-statements]
        if ( hc < 0 ) return -1; // return error
                     ^
                      {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3955:2: warning: do not use 'else' after 'return' [readability-else-after-return]
        else s = static_cast< unsigned char>(hc);
        ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3955:6: warning: statement should be inside braces [google-readability-braces-around-statements]
        else s = static_cast< unsigned char>(hc);
            ^
             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3957:2: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        block[ 0 ] = DEVLI( s, n );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3957:15: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
        block[ 0 ] = DEVLI( s, n );
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:310:32: note: expanded from macro 'DEVLI'
#define DEVLI(s,n)              ( ( n >= ( 1 << (s - 1) ) ) ? n : n + 1 - ( 1 << s ) )
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3960:25: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        for ( bpos = 1; bpos < 64; )
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3966:15: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                        z = LBITS( hc, 4 );
                                   ^
/home/mangix/devstuff/packJPG/source/./bitops.h:5:26: note: expanded from macro 'LBITS'
#define LBITS( c, n )           ( c >> (8 - n) )
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3967:8: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                        s = RBITS( hc, 4 );
                            ^
/home/mangix/devstuff/packJPG/source/./bitops.h:4:32: note: expanded from macro 'RBITS'
#define RBITS( c, n )           ( c & ( 0xFF >> (8 - n) ) )
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3967:15: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                        s = RBITS( hc, 4 );
                                   ^
/home/mangix/devstuff/packJPG/source/./bitops.h:4:26: note: expanded from macro 'RBITS'
#define RBITS( c, n )           ( c & ( 0xFF >> (8 - n) ) )
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3969:25: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        if ( ( z + bpos ) >= 64 )
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3969:29: warning: statement should be inside braces [google-readability-braces-around-statements]
                        if ( ( z + bpos ) >= 64 )
                                                 ^
                                                  {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3972:5: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                block[ bpos++ ] = 0;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3975:4: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        block[ bpos++ ] = static_cast< short>DEVLI( s, n ); // decode cvli
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3975:35: warning: consider replacing 'short' with 'int16' [google-runtime-int]
                        block[ bpos++ ] = static_cast< short>DEVLI( s, n ); // decode cvli
                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3975:41: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                        block[ bpos++ ] = static_cast< short>DEVLI( s, n ); // decode cvli
                                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:310:32: note: expanded from macro 'DEVLI'
#define DEVLI(s,n)              ( ( n >= ( 1 << (s - 1) ) ) ? n : n + 1 - ( 1 << s ) )
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3997:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_encode_block_seq( BitWriter* huffw, huffCodes* dctbl, huffCodes* actbl, short* block )
       ~~~ ^
       auto                                                                                           -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3997:88: warning: consider replacing 'short' with 'int16' [google-runtime-int]
INTERN int jpg_encode_block_seq( BitWriter* huffw, huffCodes* dctbl, huffCodes* actbl, short* block )
                                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3997:95: warning: pointer parameter 'block' can be pointer to const [readability-non-const-parameter]
INTERN int jpg_encode_block_seq( BitWriter* huffw, huffCodes* dctbl, huffCodes* actbl, short* block )
                                                                                              ^
                                                                                       const 
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3999:2: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        unsigned short n;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4007:6: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
        s = BITLEN2048N( block[ 0 ] );
            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:322:27: note: expanded from macro 'BITLEN2048N'
#define BITLEN2048N(v)  ( (pbitlen_n2048_2047+2048)[ v ] )
                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4007:6: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        s = BITLEN2048N( block[ 0 ] );
            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:322:26: note: expanded from macro 'BITLEN2048N'
#define BITLEN2048N(v)  ( (pbitlen_n2048_2047+2048)[ v ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4007:19: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        s = BITLEN2048N( block[ 0 ] );
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4008:6: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
        n = ENVLI( s, block[ 0 ] );
            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:309:53: note: expanded from macro 'ENVLI'
#define ENVLI(s,v)              ( ( v > 0 ) ? v : ( v - 1 ) + ( 1 << s ) )
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4008:16: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        n = ENVLI( s, block[ 0 ] );
                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4009:20: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        huffw->write_u16( dctbl->cval[ s ], dctbl->clen[ s ] );
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4009:38: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        huffw->write_u16( dctbl->cval[ s ], dctbl->clen[ s ] );
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4014:25: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        for ( bpos = 1; bpos < 64; bpos++ )
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4017:8: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                if ( block[ bpos ] != 0 ) {
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4019:17: warning: 16 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        while ( z >= 16 ) {
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4020:36: warning: 0xF0 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                huffw->write_u16( actbl->cval[ 0xF0 ], actbl->clen[ 0xF0 ] );
                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4020:57: warning: 0xF0 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                huffw->write_u16( actbl->cval[ 0xF0 ], actbl->clen[ 0xF0 ] );
                                                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4021:10: warning: 16 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                z -= 16;
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4024:8: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        s = BITLEN2048N( block[ bpos ] );
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:322:27: note: expanded from macro 'BITLEN2048N'
#define BITLEN2048N(v)  ( (pbitlen_n2048_2047+2048)[ v ] )
                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4024:8: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        s = BITLEN2048N( block[ bpos ] );
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:322:26: note: expanded from macro 'BITLEN2048N'
#define BITLEN2048N(v)  ( (pbitlen_n2048_2047+2048)[ v ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4024:21: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        s = BITLEN2048N( block[ bpos ] );
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4025:8: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                        n = ENVLI( s, block[ bpos ] );
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:309:53: note: expanded from macro 'ENVLI'
#define ENVLI(s,v)              ( ( v > 0 ) ? v : ( v - 1 ) + ( 1 << s ) )
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4025:18: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        n = ENVLI( s, block[ bpos ] );
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4026:13: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                        hc = ( ( z << 4 ) + s );
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4028:22: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        huffw->write_u16( actbl->cval[ hc ], actbl->clen[ hc ] );
                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4028:41: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        huffw->write_u16( actbl->cval[ hc ], actbl->clen[ hc ] );
                                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4038:14: warning: statement should be inside braces [google-readability-braces-around-statements]
        if ( z > 0 )
                    ^
                     {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4042:9: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        return 64 - z;
               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4049:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_decode_dc_prg_fs( BitReader* huffr, huffTree* dctree, short* block )
       ~~~ ^
       auto                                                                         -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4049:70: warning: consider replacing 'short' with 'int16' [google-runtime-int]
INTERN int jpg_decode_dc_prg_fs( BitReader* huffr, huffTree* dctree, short* block )
                                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4051:2: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        unsigned short n;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4058:15: warning: statement should be inside braces [google-readability-braces-around-statements]
        if ( hc < 0 ) return -1; // return error
                     ^
                      {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4059:2: warning: do not use 'else' after 'return' [readability-else-after-return]
        else s = static_cast< unsigned char>(hc);
        ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4059:6: warning: statement should be inside braces [google-readability-braces-around-statements]
        else s = static_cast< unsigned char>(hc);
            ^
             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4061:2: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        block[ 0 ] = DEVLI( s, n );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4061:15: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
        block[ 0 ] = DEVLI( s, n );
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:310:32: note: expanded from macro 'DEVLI'
#define DEVLI(s,n)              ( ( n >= ( 1 << (s - 1) ) ) ? n : n + 1 - ( 1 << s ) )
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4072:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_encode_dc_prg_fs( BitWriter* huffw, huffCodes* dctbl, short* block )
       ~~~ ^
       auto                                                                         -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4072:70: warning: consider replacing 'short' with 'int16' [google-runtime-int]
INTERN int jpg_encode_dc_prg_fs( BitWriter* huffw, huffCodes* dctbl, short* block )
                                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4072:77: warning: pointer parameter 'block' can be pointer to const [readability-non-const-parameter]
INTERN int jpg_encode_dc_prg_fs( BitWriter* huffw, huffCodes* dctbl, short* block )
                                                                            ^
                                                                     const 
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4074:2: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        unsigned short n;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4079:6: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
        s = BITLEN2048N( block[ 0 ] );
            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:322:27: note: expanded from macro 'BITLEN2048N'
#define BITLEN2048N(v)  ( (pbitlen_n2048_2047+2048)[ v ] )
                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4079:6: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        s = BITLEN2048N( block[ 0 ] );
            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:322:26: note: expanded from macro 'BITLEN2048N'
#define BITLEN2048N(v)  ( (pbitlen_n2048_2047+2048)[ v ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4079:19: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        s = BITLEN2048N( block[ 0 ] );
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4080:6: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
        n = ENVLI( s, block[ 0 ] );
            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:309:53: note: expanded from macro 'ENVLI'
#define ENVLI(s,v)              ( ( v > 0 ) ? v : ( v - 1 ) + ( 1 << s ) )
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4080:16: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        n = ENVLI( s, block[ 0 ] );
                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4081:20: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        huffw->write_u16( dctbl->cval[ s ], dctbl->clen[ s ] );
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4081:38: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        huffw->write_u16( dctbl->cval[ s ], dctbl->clen[ s ] );
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4093:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_decode_ac_prg_fs( BitReader* huffr, huffTree* actree, short* block, int* eobrun, int from, int to )
       ~~~ ^
       auto                                                                                                        -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4093:70: warning: consider replacing 'short' with 'int16' [google-runtime-int]
INTERN int jpg_decode_ac_prg_fs( BitReader* huffr, huffTree* actree, short* block, int* eobrun, int from, int to )
                                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4095:2: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        unsigned short n;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4110:16: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( hc < 0 ) return -1;
                             ^
                              {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4111:14: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                l = LBITS( hc, 4 );
                           ^
/home/mangix/devstuff/packJPG/source/./bitops.h:5:26: note: expanded from macro 'LBITS'
#define LBITS( c, n )           ( c >> (8 - n) )
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4112:7: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                r = RBITS( hc, 4 );
                    ^
/home/mangix/devstuff/packJPG/source/./bitops.h:4:32: note: expanded from macro 'RBITS'
#define RBITS( c, n )           ( c & ( 0xFF >> (8 - n) ) )
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4112:14: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                r = RBITS( hc, 4 );
                           ^
/home/mangix/devstuff/packJPG/source/./bitops.h:4:26: note: expanded from macro 'RBITS'
#define RBITS( c, n )           ( c & ( 0xFF >> (8 - n) ) )
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4114:15: warning: 15 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                if ( ( l == 15 ) || ( r > 0 ) ) { // decode run/level combination
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4118:28: warning: statement should be inside braces [google-readability-braces-around-statements]
                        if ( ( z + bpos ) > to )
                                                ^
                                                 {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4121:5: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                block[ bpos++ ] = 0;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4124:4: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        block[ bpos++ ] = static_cast< short>DEVLI( s, n ); // decode cvli
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4124:35: warning: consider replacing 'short' with 'int16' [google-runtime-int]
                        block[ bpos++ ] = static_cast< short>DEVLI( s, n ); // decode cvli
                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4124:41: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                        block[ bpos++ ] = static_cast< short>DEVLI( s, n ); // decode cvli
                                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:310:32: note: expanded from macro 'DEVLI'
#define DEVLI(s,n)              ( ( n >= ( 1 << (s - 1) ) ) ? n : n + 1 - ( 1 << s ) )
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4130:16: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                        (*eobrun) = E_DEVLI( s, n );                    
                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:312:30: note: expanded from macro 'E_DEVLI'
#define E_DEVLI(s,n)    ( n + ( 1 << s ) )
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4146:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_encode_ac_prg_fs( BitWriter* huffw, huffCodes* actbl, short* block, int* eobrun, int from, int to )
       ~~~ ^
       auto                                                                                                        -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4146:70: warning: consider replacing 'short' with 'int16' [google-runtime-int]
INTERN int jpg_encode_ac_prg_fs( BitWriter* huffw, huffCodes* actbl, short* block, int* eobrun, int from, int to )
                                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4146:77: warning: pointer parameter 'block' can be pointer to const [readability-non-const-parameter]
INTERN int jpg_encode_ac_prg_fs( BitWriter* huffw, huffCodes* actbl, short* block, int* eobrun, int from, int to )
                                                                            ^
                                                                     const 
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4148:2: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        unsigned short n;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4159:8: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                if ( block[ bpos ] != 0 ) {
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4163:17: warning: 16 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        while ( z >= 16 ) {
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4164:36: warning: 0xF0 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                huffw->write_u16( actbl->cval[ 0xF0 ], actbl->clen[ 0xF0 ] );
                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4164:57: warning: 0xF0 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                huffw->write_u16( actbl->cval[ 0xF0 ], actbl->clen[ 0xF0 ] );
                                                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4165:10: warning: 16 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                z -= 16;
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4168:8: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        s = BITLEN2048N( block[ bpos ] );
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:322:27: note: expanded from macro 'BITLEN2048N'
#define BITLEN2048N(v)  ( (pbitlen_n2048_2047+2048)[ v ] )
                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4168:8: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        s = BITLEN2048N( block[ bpos ] );
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:322:26: note: expanded from macro 'BITLEN2048N'
#define BITLEN2048N(v)  ( (pbitlen_n2048_2047+2048)[ v ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4168:21: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        s = BITLEN2048N( block[ bpos ] );
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4169:8: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                        n = ENVLI( s, block[ bpos ] );
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:309:53: note: expanded from macro 'ENVLI'
#define ENVLI(s,v)              ( ( v > 0 ) ? v : ( v - 1 ) + ( 1 << s ) )
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4169:18: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        n = ENVLI( s, block[ bpos ] );
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4170:13: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                        hc = ( ( z << 4 ) + s );
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4172:22: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        huffw->write_u16( actbl->cval[ hc ], actbl->clen[ hc ] );
                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4172:41: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        huffw->write_u16( actbl->cval[ hc ], actbl->clen[ hc ] );
                                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4186:40: warning: statement should be inside braces [google-readability-braces-around-statements]
                if ( (*eobrun) == actbl->max_eobrun )
                                                     ^
                                                      {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4190:2: warning: do not use 'else' after 'return' [readability-else-after-return]
        else {
        ^~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4199:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_decode_dc_prg_sa( BitReader* huffr, short* block )
       ~~~ ^
       auto                                                       -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4199:52: warning: consider replacing 'short' with 'int16' [google-runtime-int]
INTERN int jpg_decode_dc_prg_sa( BitReader* huffr, short* block )
                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4202:2: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        block[ 0 ] = huffr->read( 1 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4202:15: warning: narrowing conversion from 'unsigned int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
        block[ 0 ] = huffr->read( 1 );
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4212:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_encode_dc_prg_sa( BitWriter* huffw, short* block )
       ~~~ ^
       auto                                                       -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4212:52: warning: consider replacing 'short' with 'int16' [google-runtime-int]
INTERN int jpg_encode_dc_prg_sa( BitWriter* huffw, short* block )
                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4215:20: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        huffw->write_u16( block[ 0 ], 1 );
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4225:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_decode_ac_prg_sa( BitReader* huffr, huffTree* actree, short* block, int* eobrun, int from, int to )
       ~~~ ^
       auto                                                                                                        -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4225:70: warning: consider replacing 'short' with 'int16' [google-runtime-int]
INTERN int jpg_decode_ac_prg_sa( BitReader* huffr, huffTree* actree, short* block, int* eobrun, int from, int to )
                                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4227:2: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        unsigned short n;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4239:23: warning: statement should be inside braces [google-readability-braces-around-statements]
        if ( (*eobrun) == 0 ) while ( bpos <= to )
                             ^
                              {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4243:16: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( hc < 0 ) return -1;
                             ^
                              {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4244:14: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                l = LBITS( hc, 4 );
                           ^
/home/mangix/devstuff/packJPG/source/./bitops.h:5:26: note: expanded from macro 'LBITS'
#define LBITS( c, n )           ( c >> (8 - n) )
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4245:7: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                r = RBITS( hc, 4 );
                    ^
/home/mangix/devstuff/packJPG/source/./bitops.h:4:32: note: expanded from macro 'RBITS'
#define RBITS( c, n )           ( c & ( 0xFF >> (8 - n) ) )
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4245:14: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                r = RBITS( hc, 4 );
                           ^
/home/mangix/devstuff/packJPG/source/./bitops.h:4:26: note: expanded from macro 'RBITS'
#define RBITS( c, n )           ( c & ( 0xFF >> (8 - n) ) )
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4247:15: warning: 15 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                if ( ( l == 15 ) || ( r > 0 ) ) { // decode run/level combination
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4248:8: warning: narrowing conversion from 'int' to signed type 'signed char' is implementation-defined [bugprone-narrowing-conversions]
                        z = l;
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4250:17: warning: statement should be inside braces [google-readability-braces-around-statements]
                        if ( s == 0 ) v = 0;
                                     ^
                                      {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4255:8: warning: statement should be inside braces [hicpp-braces-around-statements]
                        else return -1; // decoding error
                            ^
                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4258:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                if ( block[ bpos ] == 0 ) { // skip zeroes / write value
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4259:18: warning: statement should be inside braces [google-readability-braces-around-statements]
                                        if ( z > 0 ) z--;
                                                    ^
                                                     {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4261:7: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                                block[ bpos++ ] = v;
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4267:6: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                        block[ bpos ] = ( block[ bpos ] > 0 ) ? n : -n;
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4267:24: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                        block[ bpos ] = ( block[ bpos ] > 0 ) ? n : -n;
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4267:46: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
                                        block[ bpos ] = ( block[ bpos ] > 0 ) ? n : -n;
                                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4267:50: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
                                        block[ bpos ] = ( block[ bpos ] > 0 ) ? n : -n;
                                                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4269:24: warning: statement should be inside braces [hicpp-braces-around-statements]
                                if ( bpos++ >= to ) return -1; // error check                                   
                                                   ^
                                                    {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4276:16: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                        (*eobrun) = E_DEVLI( s, n );
                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:312:30: note: expanded from macro 'E_DEVLI'
#define E_DEVLI(s,n)    ( n + ( 1 << s ) )
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4284:9: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        if ( block[ bpos ] != 0 ) {
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4286:5: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                block[ bpos ] = ( block[ bpos ] > 0 ) ? n : -n;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4286:23: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                block[ bpos ] = ( block[ bpos ] > 0 ) ? n : -n;
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4286:45: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
                                block[ bpos ] = ( block[ bpos ] > 0 ) ? n : -n;
                                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4286:49: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
                                block[ bpos ] = ( block[ bpos ] > 0 ) ? n : -n;
                                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4299:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_encode_ac_prg_sa( BitWriter* huffw, std::vector<std::uint8_t>& storw, huffCodes* actbl, short* block, int* eobrun, int from, int to )
       ~~~ ^
       auto                                                                                                                                          -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4299:104: warning: consider replacing 'short' with 'int16' [google-runtime-int]
INTERN int jpg_encode_ac_prg_sa( BitWriter* huffw, std::vector<std::uint8_t>& storw, huffCodes* actbl, short* block, int* eobrun, int from, int to )
                                                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4299:111: warning: pointer parameter 'block' can be pointer to const [readability-non-const-parameter]
INTERN int jpg_encode_ac_prg_sa( BitWriter* huffw, std::vector<std::uint8_t>& storw, huffCodes* actbl, short* block, int* eobrun, int from, int to )
                                                                                                              ^
                                                                                                       const 
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4301:2: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        unsigned short n;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4310:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                if ( ( block[ bpos ] == 1 ) || ( block[ bpos ] == -1 ) ) {
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4310:36: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                if ( ( block[ bpos ] == 1 ) || ( block[ bpos ] == -1 ) ) {
                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4327:8: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                if ( block[ bpos ] == 0 ) {
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4329:14: warning: 16 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        if ( z == 16 ) { // write zeroes if needed
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4330:36: warning: 0xF0 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                huffw->write_u16( actbl->cval[ 0xF0 ], actbl->clen[ 0xF0 ] );
                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4330:57: warning: 0xF0 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                huffw->write_u16( actbl->cval[ 0xF0 ], actbl->clen[ 0xF0 ] );
                                                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4336:15: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                else if ( ( block[ bpos ] == 1 ) || ( block[ bpos ] == -1 ) ) {
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4336:41: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                else if ( ( block[ bpos ] == 1 ) || ( block[ bpos ] == -1 ) ) {
                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4338:8: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        s = BITLEN2048N( block[ bpos ] );
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:322:27: note: expanded from macro 'BITLEN2048N'
#define BITLEN2048N(v)  ( (pbitlen_n2048_2047+2048)[ v ] )
                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4338:8: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        s = BITLEN2048N( block[ bpos ] );
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:322:26: note: expanded from macro 'BITLEN2048N'
#define BITLEN2048N(v)  ( (pbitlen_n2048_2047+2048)[ v ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4338:21: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        s = BITLEN2048N( block[ bpos ] );
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4339:8: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                        n = ENVLI( s, block[ bpos ] );
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:309:53: note: expanded from macro 'ENVLI'
#define ENVLI(s,v)              ( ( v > 0 ) ? v : ( v - 1 ) + ( 1 << s ) )
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4339:18: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        n = ENVLI( s, block[ bpos ] );
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4340:13: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                        hc = ( ( z << 4 ) + s );
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4342:22: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        huffw->write_u16( actbl->cval[ hc ], actbl->clen[ hc ] );
                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4342:41: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        huffw->write_u16( actbl->cval[ hc ], actbl->clen[ hc ] );
                                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4350:8: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        n = block[ bpos ] & 0x1;
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4350:8: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4358:8: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                if ( block[ bpos ] != 0 ) { // store correction bits
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4359:8: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        n = block[ bpos ] & 0x1;
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4359:8: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4382:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_decode_eobrun_sa( BitReader* huffr, short* block, int* eobrun, int from, int to )
       ~~~ ^
       auto                                                                                      -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4382:52: warning: consider replacing 'short' with 'int16' [google-runtime-int]
INTERN int jpg_decode_eobrun_sa( BitReader* huffr, short* block, int* eobrun, int from, int to )
                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4382:71: warning: parameter 'eobrun' is unused [misc-unused-parameters]
INTERN int jpg_decode_eobrun_sa( BitReader* huffr, short* block, int* eobrun, int from, int to )
                                                                 ~~~~~^~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4384:2: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        unsigned short n;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4390:8: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                if ( block[ bpos ] != 0 ) {
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4392:4: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        block[ bpos ] = ( block[ bpos ] > 0 ) ? n : -n;
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4392:22: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        block[ bpos ] = ( block[ bpos ] > 0 ) ? n : -n;
                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4392:44: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
                        block[ bpos ] = ( block[ bpos ] > 0 ) ? n : -n;
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4392:48: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
                        block[ bpos ] = ( block[ bpos ] > 0 ) ? n : -n;
                                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4404:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_encode_eobrun( BitWriter* huffw, huffCodes* actbl, int* eobrun )
       ~~~ ^
       auto                                                                     -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4406:2: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        unsigned short n;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4413:35: warning: 0xE0 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        huffw->write_u16( actbl->cval[ 0xE0 ], actbl->clen[ 0xE0 ] );
                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4413:56: warning: 0xE0 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        huffw->write_u16( actbl->cval[ 0xE0 ], actbl->clen[ 0xE0 ] );
                                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4414:22: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                        huffw->write_u16( E_ENVLI( 14, 32767 ), 14 );
                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:311:30: note: expanded from macro 'E_ENVLI'
#define E_ENVLI(s,v)    ( v - ( 1 << s ) )
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4414:44: warning: 14 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        huffw->write_u16( E_ENVLI( 14, 32767 ), 14 );
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4417:14: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                BITLEN( s, (*eobrun) );
                           ^
/home/mangix/devstuff/packJPG/source/./bitops.h:8:40: note: expanded from macro 'BITLEN'
#define BITLEN( l, v )          for ( l = 0; ( v >> l ) > 0; l++ )
                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4419:7: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                n = E_ENVLI( s, (*eobrun) );
                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:311:30: note: expanded from macro 'E_ENVLI'
#define E_ENVLI(s,v)    ( v - ( 1 << s ) )
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4420:10: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                hc = ( s << 4 );
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4421:21: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                huffw->write_u16( actbl->cval[ hc ], actbl->clen[ hc ] );
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4421:40: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                huffw->write_u16( actbl->cval[ hc ], actbl->clen[ hc ] );
                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4434:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_encode_crbits( BitWriter* huffw, std::vector<std::uint8_t>& storw )
       ~~~ ^
       auto                                                                        -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4447:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_next_huffcode( BitReader *huffw, huffTree *ctree )
       ~~~ ^
       auto                                                       -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4452:17: warning: 256 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        while ( node < 256 ) {
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4454:5: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                ctree->r[ node ] : ctree->l[ node ];
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4454:24: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                ctree->r[ node ] : ctree->l[ node ];
                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4455:19: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( node == 0 ) break;
                                ^
                                 {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4458:18: warning: 256 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        return ( node - 256 );
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4465:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_next_mcupos( int* mcu, int* cmp, int* csc, int* sub, int* dpos, int* rstw )
       ~~~ ^
       auto                                                                                -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4471:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        if ( ( ++(*sub) ) >= cmpnfo[(*cmp)].mbs ) {
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4478:25: warning: statement should be inside braces [google-readability-braces-around-statements]
                        if ( (*mcu) >= mcuc ) sta = 2;
                                             ^
                                              {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4479:24: warning: statement should be inside braces [google-readability-braces-around-statements]
                        else if ( rsti > 0 )
                                            ^
                                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4480:26: warning: statement should be inside braces [hicpp-braces-around-statements]
                                if ( --(*rstw) == 0 ) sta = 1;
                                                     ^
                                                      {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4483:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        (*cmp) = cs_cmp[(*csc)];
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4488:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        if ( cmpnfo[(*cmp)].sfh > 1 ) { // to fix mcu order
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4489:34: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                (*dpos)  = ( (*mcu) / mcuh ) * cmpnfo[(*cmp)].sfh + ( (*sub) / cmpnfo[(*cmp)].sfv );
                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4489:66: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                (*dpos)  = ( (*mcu) / mcuh ) * cmpnfo[(*cmp)].sfh + ( (*sub) / cmpnfo[(*cmp)].sfv );
                                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4490:14: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                (*dpos) *= cmpnfo[(*cmp)].bch;
                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4491:34: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                (*dpos) += ( (*mcu) % mcuh ) * cmpnfo[(*cmp)].sfv + ( (*sub) % cmpnfo[(*cmp)].sfv );
                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4491:66: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                (*dpos) += ( (*mcu) % mcuh ) * cmpnfo[(*cmp)].sfv + ( (*sub) % cmpnfo[(*cmp)].sfv );
                                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4493:12: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        else if ( cmpnfo[(*cmp)].sfv > 1 ) {
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4495:24: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                (*dpos) = ( (*mcu) * cmpnfo[(*cmp)].mbs ) + (*sub);
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4510:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_next_mcuposn( int* cmp, int* dpos, int* rstw )
       ~~~ ^
       auto                                                   -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4510:35: warning: pointer parameter 'cmp' can be pointer to const [readability-non-const-parameter]
INTERN int jpg_next_mcuposn( int* cmp, int* dpos, int* rstw )
                                  ^
                             const 
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4516:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        if ( cmpnfo[(*cmp)].bch != cmpnfo[(*cmp)].nch ) {
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4516:29: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        if ( cmpnfo[(*cmp)].bch != cmpnfo[(*cmp)].nch ) {
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4517:18: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( (*dpos) % cmpnfo[(*cmp)].bch == cmpnfo[(*cmp)].nch )
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4517:40: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( (*dpos) % cmpnfo[(*cmp)].bch == cmpnfo[(*cmp)].nch )
                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4517:60: warning: statement should be inside braces [google-readability-braces-around-statements]
                if ( (*dpos) % cmpnfo[(*cmp)].bch == cmpnfo[(*cmp)].nch )
                                                                         ^
                                                                          {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4518:17: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        (*dpos) += ( cmpnfo[(*cmp)].bch - cmpnfo[(*cmp)].nch );
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4518:38: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        (*dpos) += ( cmpnfo[(*cmp)].bch - cmpnfo[(*cmp)].nch );
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4522:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        if ( cmpnfo[(*cmp)].bcv != cmpnfo[(*cmp)].ncv ) {
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4522:29: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        if ( cmpnfo[(*cmp)].bcv != cmpnfo[(*cmp)].ncv ) {
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4523:18: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( (*dpos) / cmpnfo[(*cmp)].bch == cmpnfo[(*cmp)].ncv )
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4523:40: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( (*dpos) / cmpnfo[(*cmp)].bch == cmpnfo[(*cmp)].ncv )
                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4523:60: warning: statement should be inside braces [google-readability-braces-around-statements]
                if ( (*dpos) / cmpnfo[(*cmp)].bch == cmpnfo[(*cmp)].ncv )
                                                                         ^
                                                                          {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4524:14: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        (*dpos) = cmpnfo[(*cmp)].bc;
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4528:18: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        if ( (*dpos) >= cmpnfo[(*cmp)].bc ) return 2;
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4528:37: warning: statement should be inside braces [google-readability-braces-around-statements]
        if ( (*dpos) >= cmpnfo[(*cmp)].bc ) return 2;
                                           ^
                                            {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4529:2: warning: do not use 'else' after 'return' [readability-else-after-return]
        else if ( rsti > 0 )
        ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4529:22: warning: statement should be inside braces [google-readability-braces-around-statements]
        else if ( rsti > 0 )
                            ^
                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4530:24: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( --(*rstw) == 0 ) return 1;
                                     ^
                                      {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4540:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int jpg_skip_eobrun( int* cmp, int* dpos, int* rstw, int* eobrun )
       ~~~ ^
       auto                                                               -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4540:34: warning: pointer parameter 'cmp' can be pointer to const [readability-non-const-parameter]
INTERN int jpg_skip_eobrun( int* cmp, int* dpos, int* rstw, int* eobrun )
                                 ^
                            const 
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4546:30: warning: statement should be inside braces [google-readability-braces-around-statements]
                        if ( (*eobrun) > (*rstw) )
                                                  ^
                                                   {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4548:4: warning: do not use 'else' after 'return' [readability-else-after-return]
                        else
                        ^~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4548:8: warning: statement should be inside braces [google-readability-braces-around-statements]
                        else
                            ^
                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4553:8: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( cmpnfo[(*cmp)].bch != cmpnfo[(*cmp)].nch ) {
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4553:30: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( cmpnfo[(*cmp)].bch != cmpnfo[(*cmp)].nch ) {
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4554:31: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        (*dpos) += ( ( ( (*dpos) % cmpnfo[(*cmp)].bch ) + (*eobrun) ) /
                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4555:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                cmpnfo[(*cmp)].nch ) * ( cmpnfo[(*cmp)].bch - cmpnfo[(*cmp)].nch );
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4555:32: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                cmpnfo[(*cmp)].nch ) * ( cmpnfo[(*cmp)].bch - cmpnfo[(*cmp)].nch );
                                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4555:53: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                cmpnfo[(*cmp)].nch ) * ( cmpnfo[(*cmp)].bch - cmpnfo[(*cmp)].nch );
                                                                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4559:8: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( cmpnfo[(*cmp)].bcv != cmpnfo[(*cmp)].ncv ) {
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4559:30: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( cmpnfo[(*cmp)].bcv != cmpnfo[(*cmp)].ncv ) {
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4560:19: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        if ( (*dpos) / cmpnfo[(*cmp)].bch >= cmpnfo[(*cmp)].ncv )
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4560:41: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        if ( (*dpos) / cmpnfo[(*cmp)].bch >= cmpnfo[(*cmp)].ncv )
                                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4560:61: warning: statement should be inside braces [google-readability-braces-around-statements]
                        if ( (*dpos) / cmpnfo[(*cmp)].bch >= cmpnfo[(*cmp)].ncv )
                                                                                 ^
                                                                                  {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4561:18: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                (*dpos) += ( cmpnfo[(*cmp)].bcv - cmpnfo[(*cmp)].ncv ) *
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4561:39: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                (*dpos) += ( cmpnfo[(*cmp)].bcv - cmpnfo[(*cmp)].ncv ) *
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4562:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                cmpnfo[(*cmp)].bch;
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4572:19: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( (*dpos) == cmpnfo[(*cmp)].bc ) return 2;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4572:38: warning: statement should be inside braces [google-readability-braces-around-statements]
                if ( (*dpos) == cmpnfo[(*cmp)].bc ) return 2;
                                                   ^
                                                    {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4573:3: warning: do not use 'else' after 'return' [readability-else-after-return]
                else if ( (*dpos) > cmpnfo[(*cmp)].bc ) return -1;
                ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4573:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                else if ( (*dpos) > cmpnfo[(*cmp)].bc ) return -1;
                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4573:42: warning: statement should be inside braces [google-readability-braces-around-statements]
                else if ( (*dpos) > cmpnfo[(*cmp)].bc ) return -1;
                                                       ^
                                                        {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4574:23: warning: statement should be inside braces [google-readability-braces-around-statements]
                else if ( rsti > 0 ) 
                                    ^
                                     {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4575:23: warning: statement should be inside braces [hicpp-braces-around-statements]
                        if ( (*rstw) == 0 ) return 1;
                                           ^
                                            {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4585:49: warning: pointer parameter 'clen' can be pointer to const [readability-non-const-parameter]
INTERN void jpg_build_huffcodes( unsigned char *clen, unsigned char *cval,      huffCodes *hc, huffTree *ht )
                                                ^
                                 const 
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4585:70: warning: pointer parameter 'cval' can be pointer to const [readability-non-const-parameter]
INTERN void jpg_build_huffcodes( unsigned char *clen, unsigned char *cval,      huffCodes *hc, huffTree *ht )
                                                                     ^
                                                      const 
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4590:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int i, j, k;
        ^~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4594:10: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
        memset( hc->clen, 0, 256 * sizeof( short ) );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4594:23: warning: 256 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        memset( hc->clen, 0, 256 * sizeof( short ) );
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4594:37: warning: consider replacing 'short' with 'int16' [google-runtime-int]
        memset( hc->clen, 0, 256 * sizeof( short ) );
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4595:10: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
        memset( hc->cval, 0, 256 * sizeof( short ) );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4595:23: warning: 256 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        memset( hc->cval, 0, 256 * sizeof( short ) );
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4595:37: warning: consider replacing 'short' with 'int16' [google-runtime-int]
        memset( hc->cval, 0, 256 * sizeof( short ) );
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4596:10: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
        memset( ht->l, 0, 256 * sizeof( short ) );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4596:20: warning: 256 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        memset( ht->l, 0, 256 * sizeof( short ) );
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4596:34: warning: consider replacing 'short' with 'int16' [google-runtime-int]
        memset( ht->l, 0, 256 * sizeof( short ) );
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4597:10: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
        memset( ht->r, 0, 256 * sizeof( short ) );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4597:20: warning: 256 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        memset( ht->r, 0, 256 * sizeof( short ) );
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4597:34: warning: consider replacing 'short' with 'int16' [google-runtime-int]
        memset( ht->r, 0, 256 * sizeof( short ) );
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4606:18: warning: 16 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        for( i = 0; i < 16; i++ ) {
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4607:36: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                for( j = 0; j < static_cast<int>(clen[ i ]); j++ ) {
                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4608:4: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        hc->clen[ static_cast<int>(cval[k]) ] = 1 + i;
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4608:31: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        hc->clen[ static_cast<int>(cval[k]) ] = 1 + i;
                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4609:4: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        hc->cval[ static_cast<int>(cval[k]) ] = code;
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4609:31: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        hc->cval[ static_cast<int>(cval[k]) ] = code;
                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4614:10: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                code = code << 1;
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4619:12: warning: 14 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        for ( i = 14; i >= 0; i-- ) {
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4620:8: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( hc->clen[ i << 4 ] > 0 ) {
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4620:18: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                if ( hc->clen[ i << 4 ] > 0 ) {
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4621:23: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                        hc->max_eobrun = ( 2 << i ) - 1;
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4632:19: warning: 256 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        for ( i = 0; i < 256; i++ )     {
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4636:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                for ( j = hc->clen[ i ] - 1; j > 0; j-- ) {
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4637:9: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                        if ( BITN( hc->cval[ i ], j ) == 1 ) {
                             ^
/home/mangix/devstuff/packJPG/source/./bitops.h:7:25: note: expanded from macro 'BITN'
#define BITN( c, n )            ( (c >> n) & 0x1 )
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4637:15: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        if ( BITN( hc->cval[ i ], j ) == 1 ) {
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4637:15: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/./bitops.h:7:26: note: expanded from macro 'BITN'
#define BITN( c, n )            ( (c >> n) & 0x1 )
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4638:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                if ( ht->r[ node ] == 0 )
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4638:30: warning: statement should be inside braces [google-readability-braces-around-statements]
                                if ( ht->r[ node ] == 0 )
                                                         ^
                                                          {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4639:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                         ht->r[ node ] = nextfree++;
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4640:12: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                node = ht->r[ node ];
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4643:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                if ( ht->l[ node ] == 0 )
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4643:30: warning: statement should be inside braces [google-readability-braces-around-statements]
                                if ( ht->l[ node ] == 0 )
                                                         ^
                                                          {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4644:6: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                        ht->l[ node ] = nextfree++;
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4645:12: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                node = ht->l[ node ];
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4649:8: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( hc->clen[ i ] > 0 ) {
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4650:9: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                        if ( BITN( hc->cval[ i ], 0 ) == 1 )
                             ^
/home/mangix/devstuff/packJPG/source/./bitops.h:7:25: note: expanded from macro 'BITN'
#define BITN( c, n )            ( (c >> n) & 0x1 )
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4650:15: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        if ( BITN( hc->cval[ i ], 0 ) == 1 )
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4650:15: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/./bitops.h:7:26: note: expanded from macro 'BITN'
#define BITN( c, n )            ( (c >> n) & 0x1 )
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4650:40: warning: statement should be inside braces [google-readability-braces-around-statements]
                        if ( BITN( hc->cval[ i ], 0 ) == 1 )
                                                            ^
                                                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4651:5: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                ht->r[ node ] = i + 256;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4651:25: warning: 256 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                ht->r[ node ] = i + 256;
                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4652:8: warning: statement should be inside braces [google-readability-braces-around-statements]
                        else
                            ^
                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4653:5: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                ht->l[ node ] = i + 256;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4653:25: warning: 256 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                ht->l[ node ] = i + 256;
                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4666:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_encode_zstscan( ArithmeticEncoder* enc, int cmp )
       ~~~~ ^
       auto                                                       -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4670:2: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
        unsigned char freqlist[ 64 ];
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4670:26: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        unsigned char freqlist[ 64 ];
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4673:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int c, i;
        ^~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4677:25: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
        pjg_get_zerosort_scan( zsrtscan[cmp], cmp );
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4677:25: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4680:19: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        for ( i = 0; i < 64; i++ )
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4680:28: warning: statement should be inside braces [google-readability-braces-around-statements]
        for ( i = 0; i < 64; i++ )
                                  ^
                                   {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4681:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                freqlist[ i ] = stdscan[ i ];
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4681:19: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                freqlist[ i ] = stdscan[ i ];
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4684:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_s *' [cppcoreguidelines-owning-memory]
        model = INIT_MODEL_S( 64, 64, 1 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4687:19: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        for ( i = 1; i < 64; i++ )
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4690:26: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                model->exclude_symbols(64 - i);
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4694:20: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                for ( c = i; c < 64; c++ ) {
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4696:18: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        for ( tpos++; freqlist[ tpos ] == 0; tpos++ );
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4696:49: warning: statement should be inside braces [hicpp-braces-around-statements]
                        for ( tpos++; freqlist[ tpos ] == 0; tpos++ );
                                                                     ^
                                                                      {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4698:9: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        if ( freqlist[ tpos ] != zsrtscan[ cmp ][ c ] ) break;                          
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4698:29: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        if ( freqlist[ tpos ] != zsrtscan[ cmp ][ c ] ) break;                          
                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4698:51: warning: statement should be inside braces [hicpp-braces-around-statements]
                        if ( freqlist[ tpos ] != zsrtscan[ cmp ][ c ] ) break;                          
                                                                       ^
                                                                        {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4700:13: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                if ( c == 64 ) {
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4710:19: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                for ( tpos = 0; freqlist[ tpos ] != zsrtscan[ cmp ][ i ]; tpos++ )
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4710:39: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                for ( tpos = 0; freqlist[ tpos ] != zsrtscan[ cmp ][ i ]; tpos++ )
                                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4710:69: warning: statement should be inside braces [google-readability-braces-around-statements]
                for ( tpos = 0; freqlist[ tpos ] != zsrtscan[ cmp ][ i ]; tpos++ )
                                                                                  ^
                                                                                   {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4711:9: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        if ( freqlist[ tpos ] != 0 ) cpos++;
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4711:32: warning: statement should be inside braces [hicpp-braces-around-statements]
                        if ( freqlist[ tpos ] != 0 ) cpos++;
                                                    ^
                                                     {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4713:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                freqlist[ tpos ] = 0;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4721:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete( model );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4668:2: note: variable declared here
        model_s* model;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4724:2: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        freqscan[ cmp ] = zsrtscan[ cmp ];
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4724:20: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
        freqscan[ cmp ] = zsrtscan[ cmp ];
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4724:20: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4734:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_encode_zdst_high( ArithmeticEncoder* enc, int cmp )
       ~~~~ ^
       auto                                                         -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4740:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int a, b;
        ^~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4746:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_s *' [cppcoreguidelines-owning-memory]
        model = INIT_MODEL_S( 49 + 1, 25 + 1, 1 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4747:11: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        zdstls = zdstdata[ cmp ];
                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4748:6: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        w = cmpnfo[cmp].bch;
            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4749:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        bc = cmpnfo[cmp].bc;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4755:20: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                a = ( a >= 0 ) ? zdstls[ a ] : 0;
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4756:20: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                b = ( b >= 0 ) ? zdstls[ b ] : 0;
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4760:27: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                encode_ari( enc, model, zdstls[ dpos ] );
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4764:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete( model );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4736:2: note: variable declared here
        model_s* model;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4774:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_encode_zdst_low( ArithmeticEncoder* enc, int cmp )
       ~~~~ ^
       auto                                                        -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4789:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_s *' [cppcoreguidelines-owning-memory]
        model = INIT_MODEL_S( 8, 8, 2 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4790:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        zdstls_x = zdstxlow[ cmp ];
                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4791:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        zdstls_y = zdstylow[ cmp ];
                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4792:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        ctx_eobx = eobxhigh[ cmp ];
                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4793:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        ctx_eoby = eobyhigh[ cmp ];
                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4794:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        ctx_zdst = zdstdata[ cmp ];
                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4795:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        bc = cmpnfo[cmp].bc;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4799:27: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                model->shift_context( ( ctx_zdst[dpos] + 3 ) / 7 ); // shift context
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4799:50: warning: 7 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                model->shift_context( ( ctx_zdst[dpos] + 3 ) / 7 ); // shift context
                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4800:25: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                model->shift_context( ctx_eobx[dpos] ); // shift context
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4801:27: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                encode_ari( enc, model, zdstls_x[ dpos ] ); // encode symbol
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4805:27: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                model->shift_context( ( ctx_zdst[dpos] + 3 ) / 7 ); // shift context
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4805:50: warning: 7 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                model->shift_context( ( ctx_zdst[dpos] + 3 ) / 7 ); // shift context
                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4806:25: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                model->shift_context( ctx_eoby[dpos] ); // shift context
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4807:27: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                encode_ari( enc, model, zdstls_y[ dpos ] ); // encode symbol
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4811:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete( model );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4776:2: note: variable declared here
        model_s* model;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4821:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_encode_dc( ArithmeticEncoder* enc, int cmp )
       ~~~~ ^
       auto                                                  -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4830:2: warning: consider replacing 'short' with 'int16' [google-runtime-int]
        signed short* coeffs; // pointer to current coefficent data
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4832:2: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        unsigned short* absv_store; // absolute coefficients values storage
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4833:2: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        unsigned short* c_absc[ 6 ]; // quick access array for contexts
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4833:2: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4833:26: warning: 6 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        unsigned short* c_absc[ 6 ]; // quick access array for contexts
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4834:2: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
        int c_weight[ 6 ]; // weighting for contexts
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4834:16: warning: 6 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        int c_weight[ 6 ]; // weighting for contexts
                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4843:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int clen, absv, sgn;
        ^~~~~~~~~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4845:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int bt, bp;
        ^~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4847:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int p_x, p_y;
        ^~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4849:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int w, bc;
        ^~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4853:13: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
        segm_tab = segm_tables[ segm_cnt[ cmp ] - 1 ];
                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4853:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4853:26: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        segm_tab = segm_tables[ segm_cnt[ cmp ] - 1 ];
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4856:12: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        max_val = MAX_V( cmp, 0 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:26: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4856:12: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        max_val = MAX_V( cmp, 0 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:26: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4857:12: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        max_len = BITLEN1024P( max_val );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:321:26: note: expanded from macro 'BITLEN1024P'
#define BITLEN1024P(v)  ( pbitlen_0_1024[ v ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4860:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_s *' [cppcoreguidelines-owning-memory]
        mod_len = INIT_MODEL_S( max_len + 1, ( segm_cnt[cmp] > max_len ) ? segm_cnt[cmp] : max_len + 1, 2 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4860:41: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        mod_len = INIT_MODEL_S( max_len + 1, ( segm_cnt[cmp] > max_len ) ? segm_cnt[cmp] : max_len + 1, 2 );
                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4860:69: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        mod_len = INIT_MODEL_S( max_len + 1, ( segm_cnt[cmp] > max_len ) ? segm_cnt[cmp] : max_len + 1, 2 );
                                                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4861:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_b *' [cppcoreguidelines-owning-memory]
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4861:28: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4861:51: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:42: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4861:60: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4862:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_b *' [cppcoreguidelines-owning-memory]
        mod_sgn = INIT_MODEL_B( 1, 0 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4865:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        bc = cmpnfo[cmp].bc;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4866:6: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        w = cmpnfo[cmp].bch;
            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4869:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'unsigned short *' [cppcoreguidelines-owning-memory]
        absv_store = static_cast<unsigned short*>(calloc ( bc, sizeof( short ) ));
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4869:27: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        absv_store = static_cast<unsigned short*>(calloc ( bc, sizeof( short ) ));
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4869:44: warning: Result of 'calloc' is converted to a pointer of type 'unsigned short', which is incompatible with sizeof operand type 'short' [clang-analyzer-unix.MallocSizeof]
        absv_store = static_cast<unsigned short*>(calloc ( bc, sizeof( short ) ));
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4869:44: note: Result of 'calloc' is converted to a pointer of type 'unsigned short', which is incompatible with sizeof operand type 'short'
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4869:44: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
        absv_store = static_cast<unsigned short*>(calloc ( bc, sizeof( short ) ));
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4869:65: warning: consider replacing 'short' with 'int16' [google-runtime-int]
        absv_store = static_cast<unsigned short*>(calloc ( bc, sizeof( short ) ));
                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4871:3: warning: Potential leak of memory pointed to by 'mod_len' [clang-analyzer-cplusplus.NewDeleteLeaks]
                sprintf( errormessage, MEM_ERRMSG );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3286:7: note: Assuming 'auto_set' is true
        if ( !auto_set ) {
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3286:2: note: Taking false branch
        if ( !auto_set ) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3302:7: note: Assuming 'disc_meta' is false
        if ( disc_meta )
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3302:2: note: Taking false branch
        if ( disc_meta )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3305:7: note: Assuming the condition is false
        if ( !pjg_optimize_header() ) return false;     
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3305:2: note: Taking false branch
        if ( !pjg_optimize_header() ) return false;     
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3307:7: note: Assuming the condition is false
        if ( padbit == -1 )     padbit = 1;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3307:2: note: Taking false branch
        if ( padbit == -1 )     padbit = 1;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3311:7: note: Assuming the condition is false
        if ( !pjg_encode_generic( encoder, hdrdata, hdrs ) ) return false;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3311:2: note: Taking false branch
        if ( !pjg_encode_generic( encoder, hdrdata, hdrs ) ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3318:2: note: Taking false branch
        if ( !pjg_encode_bit( encoder, padbit ) ) return false; 
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3320:35: note: Assuming the condition is false
        if ( !pjg_encode_bit( encoder, ( rst_err == nullptr ) ? 0 : 1 ) ) return false;
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3320:33: note: '?' condition is false
        if ( !pjg_encode_bit( encoder, ( rst_err == nullptr ) ? 0 : 1 ) ) return false;
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3320:2: note: Taking false branch
        if ( !pjg_encode_bit( encoder, ( rst_err == nullptr ) ? 0 : 1 ) ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3322:7: note: Assuming the condition is false
        if ( rst_err != nullptr )
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3322:2: note: Taking false branch
        if ( rst_err != nullptr )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3326:17: note: Assuming 'cmp' is < 'cmpc'
        for ( cmp = 0; cmp < cmpc; cmp++ ) {            
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3326:2: note: Loop condition is true.  Entering loop body
        for ( cmp = 0; cmp < cmpc; cmp++ ) {            
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3329:8: note: Assuming the condition is false
                if ( !pjg_encode_zstscan( encoder, cmp ) ) return false;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3329:3: note: Taking false branch
                if ( !pjg_encode_zstscan( encoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3331:8: note: Assuming the condition is false
                if ( !pjg_encode_zdst_high( encoder, cmp ) ) return false;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3331:3: note: Taking false branch
                if ( !pjg_encode_zdst_high( encoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3333:8: note: Assuming the condition is false
                if ( !pjg_encode_ac_high( encoder, cmp ) ) return false;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3333:3: note: Taking false branch
                if ( !pjg_encode_ac_high( encoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3335:8: note: Assuming the condition is false
                if ( !pjg_encode_zdst_low( encoder, cmp ) ) return false;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3335:3: note: Taking false branch
                if ( !pjg_encode_zdst_low( encoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3337:8: note: Assuming the condition is false
                if ( !pjg_encode_ac_low( encoder, cmp ) ) return false;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3337:3: note: Taking false branch
                if ( !pjg_encode_ac_low( encoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3339:9: note: Calling 'pjg_encode_dc'
                if ( !pjg_encode_dc( encoder, cmp ) ) return false;             
                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4856:12: note: Assuming the condition is false
        max_val = MAX_V( cmp, 0 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:26: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:22: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4856:12: note: '?' condition is false
        max_val = MAX_V( cmp, 0 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:24: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4860:12: note: Memory is allocated
        mod_len = INIT_MODEL_S( max_len + 1, ( segm_cnt[cmp] > max_len ) ? segm_cnt[cmp] : max_len + 1, 2 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:298:29: note: expanded from macro 'INIT_MODEL_S'
#define INIT_MODEL_S(a,b,c) new model_s( a, b, c, 255 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4860:41: note: Assuming the condition is false
        mod_len = INIT_MODEL_S( max_len + 1, ( segm_cnt[cmp] > max_len ) ? segm_cnt[cmp] : max_len + 1, 2 );
                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:298:45: note: expanded from macro 'INIT_MODEL_S'
#define INIT_MODEL_S(a,b,c) new model_s( a, b, c, 255 )
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4860:39: note: '?' condition is false
        mod_len = INIT_MODEL_S( max_len + 1, ( segm_cnt[cmp] > max_len ) ? segm_cnt[cmp] : max_len + 1, 2 );
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4861:28: note: Assuming the condition is true
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:42: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4861:26: note: '?' condition is true
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4870:7: note: Assuming the condition is true
        if ( absv_store == nullptr ) {
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4870:2: note: Taking true branch
        if ( absv_store == nullptr ) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4871:3: note: Potential leak of memory pointed to by 'mod_len'
                sprintf( errormessage, MEM_ERRMSG );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4871:3: warning: Potential leak of memory pointed to by 'mod_res' [clang-analyzer-cplusplus.NewDeleteLeaks]
                sprintf( errormessage, MEM_ERRMSG );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3286:7: note: Assuming 'auto_set' is true
        if ( !auto_set ) {
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3286:2: note: Taking false branch
        if ( !auto_set ) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3302:7: note: Assuming 'disc_meta' is false
        if ( disc_meta )
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3302:2: note: Taking false branch
        if ( disc_meta )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3305:7: note: Assuming the condition is false
        if ( !pjg_optimize_header() ) return false;     
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3305:2: note: Taking false branch
        if ( !pjg_optimize_header() ) return false;     
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3307:7: note: Assuming the condition is false
        if ( padbit == -1 )     padbit = 1;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3307:2: note: Taking false branch
        if ( padbit == -1 )     padbit = 1;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3311:7: note: Assuming the condition is false
        if ( !pjg_encode_generic( encoder, hdrdata, hdrs ) ) return false;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3311:2: note: Taking false branch
        if ( !pjg_encode_generic( encoder, hdrdata, hdrs ) ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3318:2: note: Taking false branch
        if ( !pjg_encode_bit( encoder, padbit ) ) return false; 
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3320:35: note: Assuming the condition is false
        if ( !pjg_encode_bit( encoder, ( rst_err == nullptr ) ? 0 : 1 ) ) return false;
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3320:33: note: '?' condition is false
        if ( !pjg_encode_bit( encoder, ( rst_err == nullptr ) ? 0 : 1 ) ) return false;
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3320:2: note: Taking false branch
        if ( !pjg_encode_bit( encoder, ( rst_err == nullptr ) ? 0 : 1 ) ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3322:7: note: Assuming the condition is false
        if ( rst_err != nullptr )
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3322:2: note: Taking false branch
        if ( rst_err != nullptr )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3326:17: note: Assuming 'cmp' is < 'cmpc'
        for ( cmp = 0; cmp < cmpc; cmp++ ) {            
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3326:2: note: Loop condition is true.  Entering loop body
        for ( cmp = 0; cmp < cmpc; cmp++ ) {            
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3329:8: note: Assuming the condition is false
                if ( !pjg_encode_zstscan( encoder, cmp ) ) return false;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3329:3: note: Taking false branch
                if ( !pjg_encode_zstscan( encoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3331:8: note: Assuming the condition is false
                if ( !pjg_encode_zdst_high( encoder, cmp ) ) return false;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3331:3: note: Taking false branch
                if ( !pjg_encode_zdst_high( encoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3333:8: note: Assuming the condition is false
                if ( !pjg_encode_ac_high( encoder, cmp ) ) return false;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3333:3: note: Taking false branch
                if ( !pjg_encode_ac_high( encoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3335:8: note: Assuming the condition is false
                if ( !pjg_encode_zdst_low( encoder, cmp ) ) return false;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3335:3: note: Taking false branch
                if ( !pjg_encode_zdst_low( encoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3337:8: note: Assuming the condition is false
                if ( !pjg_encode_ac_low( encoder, cmp ) ) return false;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3337:3: note: Taking false branch
                if ( !pjg_encode_ac_low( encoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3339:9: note: Calling 'pjg_encode_dc'
                if ( !pjg_encode_dc( encoder, cmp ) ) return false;             
                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4856:12: note: Assuming the condition is false
        max_val = MAX_V( cmp, 0 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:26: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:22: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4856:12: note: '?' condition is false
        max_val = MAX_V( cmp, 0 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:24: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4860:41: note: Assuming the condition is false
        mod_len = INIT_MODEL_S( max_len + 1, ( segm_cnt[cmp] > max_len ) ? segm_cnt[cmp] : max_len + 1, 2 );
                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:298:45: note: expanded from macro 'INIT_MODEL_S'
#define INIT_MODEL_S(a,b,c) new model_s( a, b, c, 255 )
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4860:39: note: '?' condition is false
        mod_len = INIT_MODEL_S( max_len + 1, ( segm_cnt[cmp] > max_len ) ? segm_cnt[cmp] : max_len + 1, 2 );
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4861:12: note: Memory is allocated
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:29: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4861:28: note: Assuming the condition is true
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:42: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4861:26: note: '?' condition is true
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4870:7: note: Assuming the condition is true
        if ( absv_store == nullptr ) {
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4870:2: note: Taking true branch
        if ( absv_store == nullptr ) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4871:3: note: Potential leak of memory pointed to by 'mod_res'
                sprintf( errormessage, MEM_ERRMSG );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4871:3: warning: Potential leak of memory pointed to by 'mod_sgn' [clang-analyzer-cplusplus.NewDeleteLeaks]
                sprintf( errormessage, MEM_ERRMSG );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3286:7: note: Assuming 'auto_set' is true
        if ( !auto_set ) {
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3286:2: note: Taking false branch
        if ( !auto_set ) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3302:7: note: Assuming 'disc_meta' is false
        if ( disc_meta )
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3302:2: note: Taking false branch
        if ( disc_meta )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3305:7: note: Assuming the condition is false
        if ( !pjg_optimize_header() ) return false;     
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3305:2: note: Taking false branch
        if ( !pjg_optimize_header() ) return false;     
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3307:7: note: Assuming the condition is false
        if ( padbit == -1 )     padbit = 1;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3307:2: note: Taking false branch
        if ( padbit == -1 )     padbit = 1;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3311:7: note: Assuming the condition is false
        if ( !pjg_encode_generic( encoder, hdrdata, hdrs ) ) return false;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3311:2: note: Taking false branch
        if ( !pjg_encode_generic( encoder, hdrdata, hdrs ) ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3318:2: note: Taking false branch
        if ( !pjg_encode_bit( encoder, padbit ) ) return false; 
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3320:35: note: Assuming the condition is false
        if ( !pjg_encode_bit( encoder, ( rst_err == nullptr ) ? 0 : 1 ) ) return false;
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3320:33: note: '?' condition is false
        if ( !pjg_encode_bit( encoder, ( rst_err == nullptr ) ? 0 : 1 ) ) return false;
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3320:2: note: Taking false branch
        if ( !pjg_encode_bit( encoder, ( rst_err == nullptr ) ? 0 : 1 ) ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3322:7: note: Assuming the condition is false
        if ( rst_err != nullptr )
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3322:2: note: Taking false branch
        if ( rst_err != nullptr )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3326:17: note: Assuming 'cmp' is < 'cmpc'
        for ( cmp = 0; cmp < cmpc; cmp++ ) {            
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3326:2: note: Loop condition is true.  Entering loop body
        for ( cmp = 0; cmp < cmpc; cmp++ ) {            
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3329:8: note: Assuming the condition is false
                if ( !pjg_encode_zstscan( encoder, cmp ) ) return false;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3329:3: note: Taking false branch
                if ( !pjg_encode_zstscan( encoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3331:8: note: Assuming the condition is false
                if ( !pjg_encode_zdst_high( encoder, cmp ) ) return false;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3331:3: note: Taking false branch
                if ( !pjg_encode_zdst_high( encoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3333:8: note: Assuming the condition is false
                if ( !pjg_encode_ac_high( encoder, cmp ) ) return false;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3333:3: note: Taking false branch
                if ( !pjg_encode_ac_high( encoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3335:8: note: Assuming the condition is false
                if ( !pjg_encode_zdst_low( encoder, cmp ) ) return false;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3335:3: note: Taking false branch
                if ( !pjg_encode_zdst_low( encoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3337:8: note: Assuming the condition is false
                if ( !pjg_encode_ac_low( encoder, cmp ) ) return false;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3337:3: note: Taking false branch
                if ( !pjg_encode_ac_low( encoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3339:9: note: Calling 'pjg_encode_dc'
                if ( !pjg_encode_dc( encoder, cmp ) ) return false;             
                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4856:12: note: Assuming the condition is false
        max_val = MAX_V( cmp, 0 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:26: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:22: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4856:12: note: '?' condition is false
        max_val = MAX_V( cmp, 0 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:24: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4860:41: note: Assuming the condition is false
        mod_len = INIT_MODEL_S( max_len + 1, ( segm_cnt[cmp] > max_len ) ? segm_cnt[cmp] : max_len + 1, 2 );
                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:298:45: note: expanded from macro 'INIT_MODEL_S'
#define INIT_MODEL_S(a,b,c) new model_s( a, b, c, 255 )
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4860:39: note: '?' condition is false
        mod_len = INIT_MODEL_S( max_len + 1, ( segm_cnt[cmp] > max_len ) ? segm_cnt[cmp] : max_len + 1, 2 );
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4861:28: note: Assuming the condition is true
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:42: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4861:26: note: '?' condition is true
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4862:12: note: Memory is allocated
        mod_sgn = INIT_MODEL_B( 1, 0 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:29: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4870:7: note: Assuming the condition is true
        if ( absv_store == nullptr ) {
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4870:2: note: Taking true branch
        if ( absv_store == nullptr ) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4871:3: note: Potential leak of memory pointed to by 'mod_sgn'
                sprintf( errormessage, MEM_ERRMSG );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4871:3: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                sprintf( errormessage, MEM_ERRMSG );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4871:12: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                sprintf( errormessage, MEM_ERRMSG );
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4877:21: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
        pjg_aavrg_prepare( c_absc, c_weight, absv_store, cmp );
                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4877:29: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
        pjg_aavrg_prepare( c_absc, c_weight, absv_store, cmp );
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4880:11: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        coeffs = colldata[ cmp ][ 0 ];
                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4881:11: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        zdstls = zdstdata[ cmp ];       
                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4893:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                snum = segm_tab[ zdstls[dpos] ];
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4893:20: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                snum = segm_tab[ zdstls[dpos] ];
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4895:32: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                ctx_avr = pjg_aavrg_context( c_absc, c_weight, dpos, p_y, p_x, r_x ); // AVERAGE context
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4895:40: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                ctx_avr = pjg_aavrg_context( c_absc, c_weight, dpos, p_y, p_x, r_x ); // AVERAGE context
                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4896:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                ctx_len = BITLEN1024P( ctx_avr ); // BITLENGTH context
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:321:26: note: expanded from macro 'BITLEN1024P'
#define BITLEN1024P(v)  ( pbitlen_0_1024[ v ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4901:8: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                if ( coeffs[ dpos ] == 0 ) {
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4907:16: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        absv = ABS( coeffs[dpos] );
                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4908:11: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        clen = BITLEN1024P( absv );
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:321:26: note: expanded from macro 'BITLEN1024P'
#define BITLEN1024P(v)  ( pbitlen_0_1024[ v ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4909:12: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        sgn = ( coeffs[dpos] > 0 ) ? 0 : 1;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4917:10: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                bt = BITN( absv, bp );
                                     ^
/home/mangix/devstuff/packJPG/source/./bitops.h:7:25: note: expanded from macro 'BITN'
#define BITN( c, n )            ( (c >> n) & 0x1 )
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4917:16: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                bt = BITN( absv, bp );
                                           ^
/home/mangix/devstuff/packJPG/source/./bitops.h:7:26: note: expanded from macro 'BITN'
#define BITN( c, n )            ( (c >> n) & 0x1 )
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4923:4: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        absv_store[ dpos ] = absv;
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4928:2: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        free( absv_store );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4928:2: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4929:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete ( mod_len );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4825:2: note: variable declared here
        model_s* mod_len;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4930:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete ( mod_res );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4827:2: note: variable declared here
        model_b* mod_res;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4931:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete ( mod_sgn );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4826:2: note: variable declared here
        model_b* mod_sgn;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4941:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_encode_ac_high( ArithmeticEncoder* enc, int cmp )
       ~~~~ ^
       auto                                                       -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4952:2: warning: consider replacing 'short' with 'int16' [google-runtime-int]
        signed short* coeffs; // pointer to current coefficent data
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4954:2: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        unsigned short* absv_store; // absolute coefficients values storage
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4955:2: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        unsigned short* c_absc[ 6 ]; // quick access array for contexts
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4955:2: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4955:26: warning: 6 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        unsigned short* c_absc[ 6 ]; // quick access array for contexts
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4956:2: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
        int c_weight[ 6 ]; // weighting for contexts
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4956:16: warning: 6 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        int c_weight[ 6 ]; // weighting for contexts
                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4969:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int bpos, dpos;
        ^~~~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4970:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int clen, absv, sgn;
        ^~~~~~~~~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4972:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int bt, bp;
        ^~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4975:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int b_x, b_y;
        ^~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4976:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int p_x, p_y;
        ^~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4978:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int w, bc;
        ^~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4982:13: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
        segm_tab = segm_tables[ segm_cnt[ cmp ] - 1 ];
                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4982:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4982:26: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        segm_tab = segm_tables[ segm_cnt[ cmp ] - 1 ];
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4985:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_s *' [cppcoreguidelines-owning-memory]
        mod_len = INIT_MODEL_S( 11, ( segm_cnt[cmp] > 11 ) ? segm_cnt[cmp] : 11, 2 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4985:32: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        mod_len = INIT_MODEL_S( 11, ( segm_cnt[cmp] > 11 ) ? segm_cnt[cmp] : 11, 2 );
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4985:55: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        mod_len = INIT_MODEL_S( 11, ( segm_cnt[cmp] > 11 ) ? segm_cnt[cmp] : 11, 2 );
                                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4986:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_b *' [cppcoreguidelines-owning-memory]
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4986:28: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4986:51: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:42: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4986:60: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4987:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_b *' [cppcoreguidelines-owning-memory]
        mod_sgn = INIT_MODEL_B( 9, 1 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4990:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        bc = cmpnfo[cmp].bc;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4991:6: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        w = cmpnfo[cmp].bch;
            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4994:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'unsigned short *' [cppcoreguidelines-owning-memory]
        absv_store = static_cast<unsigned short*>(calloc ( bc, sizeof( short ) ));      
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4994:27: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        absv_store = static_cast<unsigned short*>(calloc ( bc, sizeof( short ) ));      
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4994:44: warning: Result of 'calloc' is converted to a pointer of type 'unsigned short', which is incompatible with sizeof operand type 'short' [clang-analyzer-unix.MallocSizeof]
        absv_store = static_cast<unsigned short*>(calloc ( bc, sizeof( short ) ));      
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4994:44: note: Result of 'calloc' is converted to a pointer of type 'unsigned short', which is incompatible with sizeof operand type 'short'
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4994:44: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
        absv_store = static_cast<unsigned short*>(calloc ( bc, sizeof( short ) ));      
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4994:65: warning: consider replacing 'short' with 'int16' [google-runtime-int]
        absv_store = static_cast<unsigned short*>(calloc ( bc, sizeof( short ) ));      
                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4995:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'unsigned char *' [cppcoreguidelines-owning-memory]
        sgn_store = static_cast<unsigned char*>(calloc ( bc, sizeof( char ) ));
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4995:42: warning: Result of 'calloc' is converted to a pointer of type 'unsigned char', which is incompatible with sizeof operand type 'char' [clang-analyzer-unix.MallocSizeof]
        sgn_store = static_cast<unsigned char*>(calloc ( bc, sizeof( char ) ));
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4995:42: note: Result of 'calloc' is converted to a pointer of type 'unsigned char', which is incompatible with sizeof operand type 'char'
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4995:42: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
        sgn_store = static_cast<unsigned char*>(calloc ( bc, sizeof( char ) ));
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4996:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'unsigned char *' [cppcoreguidelines-owning-memory]
        zdstls = static_cast<unsigned char*>(calloc ( bc, sizeof( char ) ));
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4996:39: warning: Result of 'calloc' is converted to a pointer of type 'unsigned char', which is incompatible with sizeof operand type 'char' [clang-analyzer-unix.MallocSizeof]
        zdstls = static_cast<unsigned char*>(calloc ( bc, sizeof( char ) ));
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4996:39: note: Result of 'calloc' is converted to a pointer of type 'unsigned char', which is incompatible with sizeof operand type 'char'
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4996:39: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
        zdstls = static_cast<unsigned char*>(calloc ( bc, sizeof( char ) ));
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4998:8: warning: Potential leak of memory pointed to by 'mod_len' [clang-analyzer-cplusplus.NewDeleteLeaks]
                if ( absv_store != nullptr ) free( absv_store );
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3286:7: note: Assuming 'auto_set' is true
        if ( !auto_set ) {
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3286:2: note: Taking false branch
        if ( !auto_set ) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3302:7: note: Assuming 'disc_meta' is false
        if ( disc_meta )
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3302:2: note: Taking false branch
        if ( disc_meta )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3305:7: note: Assuming the condition is false
        if ( !pjg_optimize_header() ) return false;     
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3305:2: note: Taking false branch
        if ( !pjg_optimize_header() ) return false;     
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3307:7: note: Assuming the condition is false
        if ( padbit == -1 )     padbit = 1;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3307:2: note: Taking false branch
        if ( padbit == -1 )     padbit = 1;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3311:7: note: Assuming the condition is false
        if ( !pjg_encode_generic( encoder, hdrdata, hdrs ) ) return false;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3311:2: note: Taking false branch
        if ( !pjg_encode_generic( encoder, hdrdata, hdrs ) ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3318:2: note: Taking false branch
        if ( !pjg_encode_bit( encoder, padbit ) ) return false; 
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3320:35: note: Assuming the condition is false
        if ( !pjg_encode_bit( encoder, ( rst_err == nullptr ) ? 0 : 1 ) ) return false;
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3320:33: note: '?' condition is false
        if ( !pjg_encode_bit( encoder, ( rst_err == nullptr ) ? 0 : 1 ) ) return false;
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3320:2: note: Taking false branch
        if ( !pjg_encode_bit( encoder, ( rst_err == nullptr ) ? 0 : 1 ) ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3322:7: note: Assuming the condition is false
        if ( rst_err != nullptr )
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3322:2: note: Taking false branch
        if ( rst_err != nullptr )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3326:17: note: Assuming 'cmp' is < 'cmpc'
        for ( cmp = 0; cmp < cmpc; cmp++ ) {            
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3326:2: note: Loop condition is true.  Entering loop body
        for ( cmp = 0; cmp < cmpc; cmp++ ) {            
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3329:8: note: Assuming the condition is false
                if ( !pjg_encode_zstscan( encoder, cmp ) ) return false;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3329:3: note: Taking false branch
                if ( !pjg_encode_zstscan( encoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3331:3: note: Taking false branch
                if ( !pjg_encode_zdst_high( encoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3333:9: note: Calling 'pjg_encode_ac_high'
                if ( !pjg_encode_ac_high( encoder, cmp ) ) return false;
                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4985:12: note: Memory is allocated
        mod_len = INIT_MODEL_S( 11, ( segm_cnt[cmp] > 11 ) ? segm_cnt[cmp] : 11, 2 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:298:29: note: expanded from macro 'INIT_MODEL_S'
#define INIT_MODEL_S(a,b,c) new model_s( a, b, c, 255 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4985:32: note: Assuming the condition is false
        mod_len = INIT_MODEL_S( 11, ( segm_cnt[cmp] > 11 ) ? segm_cnt[cmp] : 11, 2 );
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:298:45: note: expanded from macro 'INIT_MODEL_S'
#define INIT_MODEL_S(a,b,c) new model_s( a, b, c, 255 )
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4985:30: note: '?' condition is false
        mod_len = INIT_MODEL_S( 11, ( segm_cnt[cmp] > 11 ) ? segm_cnt[cmp] : 11, 2 );
                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4986:28: note: Assuming the condition is true
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:42: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4986:26: note: '?' condition is true
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4997:9: note: Assuming the condition is true
        if ( ( absv_store == nullptr ) || ( sgn_store == nullptr ) || ( zdstls == nullptr ) ) {
               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4997:33: note: Left side of '||' is true
        if ( ( absv_store == nullptr ) || ( sgn_store == nullptr ) || ( zdstls == nullptr ) ) {
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4998:8: note: Potential leak of memory pointed to by 'mod_len'
                if ( absv_store != nullptr ) free( absv_store );
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4998:8: warning: Potential leak of memory pointed to by 'mod_res' [clang-analyzer-cplusplus.NewDeleteLeaks]
                if ( absv_store != nullptr ) free( absv_store );
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3286:7: note: Assuming 'auto_set' is true
        if ( !auto_set ) {
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3286:2: note: Taking false branch
        if ( !auto_set ) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3302:7: note: Assuming 'disc_meta' is false
        if ( disc_meta )
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3302:2: note: Taking false branch
        if ( disc_meta )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3305:7: note: Assuming the condition is false
        if ( !pjg_optimize_header() ) return false;     
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3305:2: note: Taking false branch
        if ( !pjg_optimize_header() ) return false;     
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3307:7: note: Assuming the condition is false
        if ( padbit == -1 )     padbit = 1;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3307:2: note: Taking false branch
        if ( padbit == -1 )     padbit = 1;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3311:7: note: Assuming the condition is false
        if ( !pjg_encode_generic( encoder, hdrdata, hdrs ) ) return false;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3311:2: note: Taking false branch
        if ( !pjg_encode_generic( encoder, hdrdata, hdrs ) ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3318:2: note: Taking false branch
        if ( !pjg_encode_bit( encoder, padbit ) ) return false; 
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3320:35: note: Assuming the condition is false
        if ( !pjg_encode_bit( encoder, ( rst_err == nullptr ) ? 0 : 1 ) ) return false;
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3320:33: note: '?' condition is false
        if ( !pjg_encode_bit( encoder, ( rst_err == nullptr ) ? 0 : 1 ) ) return false;
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3320:2: note: Taking false branch
        if ( !pjg_encode_bit( encoder, ( rst_err == nullptr ) ? 0 : 1 ) ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3322:7: note: Assuming the condition is false
        if ( rst_err != nullptr )
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3322:2: note: Taking false branch
        if ( rst_err != nullptr )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3326:17: note: Assuming 'cmp' is < 'cmpc'
        for ( cmp = 0; cmp < cmpc; cmp++ ) {            
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3326:2: note: Loop condition is true.  Entering loop body
        for ( cmp = 0; cmp < cmpc; cmp++ ) {            
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3329:8: note: Assuming the condition is false
                if ( !pjg_encode_zstscan( encoder, cmp ) ) return false;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3329:3: note: Taking false branch
                if ( !pjg_encode_zstscan( encoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3331:3: note: Taking false branch
                if ( !pjg_encode_zdst_high( encoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3333:9: note: Calling 'pjg_encode_ac_high'
                if ( !pjg_encode_ac_high( encoder, cmp ) ) return false;
                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4985:32: note: Assuming the condition is false
        mod_len = INIT_MODEL_S( 11, ( segm_cnt[cmp] > 11 ) ? segm_cnt[cmp] : 11, 2 );
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:298:45: note: expanded from macro 'INIT_MODEL_S'
#define INIT_MODEL_S(a,b,c) new model_s( a, b, c, 255 )
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4985:30: note: '?' condition is false
        mod_len = INIT_MODEL_S( 11, ( segm_cnt[cmp] > 11 ) ? segm_cnt[cmp] : 11, 2 );
                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4986:12: note: Memory is allocated
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:29: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4986:28: note: Assuming the condition is true
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:42: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4986:26: note: '?' condition is true
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4997:9: note: Assuming the condition is true
        if ( ( absv_store == nullptr ) || ( sgn_store == nullptr ) || ( zdstls == nullptr ) ) {
               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4997:33: note: Left side of '||' is true
        if ( ( absv_store == nullptr ) || ( sgn_store == nullptr ) || ( zdstls == nullptr ) ) {
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4998:8: note: Potential leak of memory pointed to by 'mod_res'
                if ( absv_store != nullptr ) free( absv_store );
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4998:8: warning: Potential leak of memory pointed to by 'mod_sgn' [clang-analyzer-cplusplus.NewDeleteLeaks]
                if ( absv_store != nullptr ) free( absv_store );
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3286:7: note: Assuming 'auto_set' is true
        if ( !auto_set ) {
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3286:2: note: Taking false branch
        if ( !auto_set ) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3302:7: note: Assuming 'disc_meta' is false
        if ( disc_meta )
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3302:2: note: Taking false branch
        if ( disc_meta )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3305:7: note: Assuming the condition is false
        if ( !pjg_optimize_header() ) return false;     
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3305:2: note: Taking false branch
        if ( !pjg_optimize_header() ) return false;     
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3307:7: note: Assuming the condition is false
        if ( padbit == -1 )     padbit = 1;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3307:2: note: Taking false branch
        if ( padbit == -1 )     padbit = 1;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3311:7: note: Assuming the condition is false
        if ( !pjg_encode_generic( encoder, hdrdata, hdrs ) ) return false;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3311:2: note: Taking false branch
        if ( !pjg_encode_generic( encoder, hdrdata, hdrs ) ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3318:2: note: Taking false branch
        if ( !pjg_encode_bit( encoder, padbit ) ) return false; 
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3320:35: note: Assuming the condition is false
        if ( !pjg_encode_bit( encoder, ( rst_err == nullptr ) ? 0 : 1 ) ) return false;
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3320:33: note: '?' condition is false
        if ( !pjg_encode_bit( encoder, ( rst_err == nullptr ) ? 0 : 1 ) ) return false;
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3320:2: note: Taking false branch
        if ( !pjg_encode_bit( encoder, ( rst_err == nullptr ) ? 0 : 1 ) ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3322:7: note: Assuming the condition is false
        if ( rst_err != nullptr )
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3322:2: note: Taking false branch
        if ( rst_err != nullptr )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3326:17: note: Assuming 'cmp' is < 'cmpc'
        for ( cmp = 0; cmp < cmpc; cmp++ ) {            
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3326:2: note: Loop condition is true.  Entering loop body
        for ( cmp = 0; cmp < cmpc; cmp++ ) {            
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3329:8: note: Assuming the condition is false
                if ( !pjg_encode_zstscan( encoder, cmp ) ) return false;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3329:3: note: Taking false branch
                if ( !pjg_encode_zstscan( encoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3331:3: note: Taking false branch
                if ( !pjg_encode_zdst_high( encoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3333:9: note: Calling 'pjg_encode_ac_high'
                if ( !pjg_encode_ac_high( encoder, cmp ) ) return false;
                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4985:32: note: Assuming the condition is false
        mod_len = INIT_MODEL_S( 11, ( segm_cnt[cmp] > 11 ) ? segm_cnt[cmp] : 11, 2 );
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:298:45: note: expanded from macro 'INIT_MODEL_S'
#define INIT_MODEL_S(a,b,c) new model_s( a, b, c, 255 )
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4985:30: note: '?' condition is false
        mod_len = INIT_MODEL_S( 11, ( segm_cnt[cmp] > 11 ) ? segm_cnt[cmp] : 11, 2 );
                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4986:28: note: Assuming the condition is true
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:42: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4986:26: note: '?' condition is true
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4987:12: note: Memory is allocated
        mod_sgn = INIT_MODEL_B( 9, 1 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:29: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4997:9: note: Assuming the condition is true
        if ( ( absv_store == nullptr ) || ( sgn_store == nullptr ) || ( zdstls == nullptr ) ) {
               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4997:33: note: Left side of '||' is true
        if ( ( absv_store == nullptr ) || ( sgn_store == nullptr ) || ( zdstls == nullptr ) ) {
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4998:8: note: Potential leak of memory pointed to by 'mod_sgn'
                if ( absv_store != nullptr ) free( absv_store );
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4998:31: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( absv_store != nullptr ) free( absv_store );
                                            ^
                                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4998:32: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
                if ( absv_store != nullptr ) free( absv_store );
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4998:32: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4999:30: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( sgn_store != nullptr ) free( sgn_store );
                                           ^
                                            {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4999:31: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
                if ( sgn_store != nullptr ) free( sgn_store );
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4999:31: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5000:27: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( zdstls != nullptr ) free( zdstls );
                                        ^
                                         {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5000:28: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
                if ( zdstls != nullptr ) free( zdstls );
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5000:28: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5001:3: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                sprintf( errormessage, MEM_ERRMSG );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5001:12: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                sprintf( errormessage, MEM_ERRMSG );
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5007:22: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        sgn_nbh = sgn_store - 1;
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5008:22: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        sgn_nbv = sgn_store - w;        
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5011:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        eob_x = eobxhigh[ cmp ];
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5012:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        eob_y = eobyhigh[ cmp ];
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5019:37: warning: statement should be inside braces [google-readability-braces-around-statements]
        for ( dpos = 0; dpos < bc; dpos++ )
                                           ^
                                            {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5020:3: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                zdstls[ dpos ] = zdstdata[ cmp ][ dpos ];
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5020:20: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                zdstls[ dpos ] = zdstdata[ cmp ][ dpos ];
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5020:20: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5023:19: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        for ( i = 1; i < 64; i++ )
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5026:27: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                bpos = static_cast<int>(freqscan[cmp][i]);
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5026:27: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5027:9: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                b_x = unzigzag[ bpos ] % 8;
                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5027:28: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                b_x = unzigzag[ bpos ] % 8;
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5028:9: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                b_y = unzigzag[ bpos ] / 8;
                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5028:28: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                b_y = unzigzag[ bpos ] / 8;
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5030:38: warning: statement should be inside braces [google-readability-braces-around-statements]
                if ( ( b_x == 0 ) || ( b_y == 0 ) )
                                                   ^
                                                    {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5034:42: warning: consider replacing 'short' with 'int16' [google-runtime-int]
                memset( absv_store, 0x00, bc * sizeof( short ) );
                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5038:22: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                pjg_aavrg_prepare( c_absc, c_weight, absv_store, cmp );
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5038:30: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                pjg_aavrg_prepare( c_absc, c_weight, absv_store, cmp );
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5041:12: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                coeffs = colldata[ cmp ][ bpos ];
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5044:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                max_val = MAX_V( cmp, bpos );
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:26: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5044:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                max_val = MAX_V( cmp, bpos );
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:26: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5045:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                max_len = BITLEN1024P( max_val );
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:321:26: note: expanded from macro 'BITLEN1024P'
#define BITLEN1024P(v)  ( pbitlen_0_1024[ v ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5051:9: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        if ( zdstls[dpos] == 0 )
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5051:28: warning: statement should be inside braces [google-readability-braces-around-statements]
                        if ( zdstls[dpos] == 0 )
                                                ^
                                                 {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5061:11: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        snum = segm_tab[ zdstls[dpos] ];
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5061:21: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        snum = segm_tab[ zdstls[dpos] ];
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5063:33: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        ctx_avr = pjg_aavrg_context( c_absc, c_weight, dpos, p_y, p_x, r_x ); // AVERAGE context
                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5063:41: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        ctx_avr = pjg_aavrg_context( c_absc, c_weight, dpos, p_y, p_x, r_x ); // AVERAGE context
                                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5064:14: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        ctx_len = BITLEN1024P( ctx_avr ); // BITLENGTH context                          
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:321:26: note: expanded from macro 'BITLEN1024P'
#define BITLEN1024P(v)  ( pbitlen_0_1024[ v ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5070:9: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        if ( coeffs[ dpos ] == 0 ) {
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5076:17: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                absv = ABS( coeffs[dpos] );
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5077:12: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                clen = BITLEN1024P( absv );
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:321:26: note: expanded from macro 'BITLEN1024P'
#define BITLEN1024P(v)  ( pbitlen_0_1024[ v ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5078:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                sgn = ( coeffs[dpos] > 0 ) ? 0 : 1;
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5086:11: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                        bt = BITN( absv, bp );
                                             ^
/home/mangix/devstuff/packJPG/source/./bitops.h:7:25: note: expanded from macro 'BITN'
#define BITN( c, n )            ( (c >> n) & 0x1 )
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5086:17: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                        bt = BITN( absv, bp );
                                                   ^
/home/mangix/devstuff/packJPG/source/./bitops.h:7:26: note: expanded from macro 'BITN'
#define BITN( c, n )            ( (c >> n) & 0x1 )
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5090:29: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                ctx_sgn = ( p_x > 0 ) ? sgn_nbh[ dpos ] : 0; // sign context
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5091:19: warning: statement should be inside braces [hicpp-braces-around-statements]
                                if ( p_y > 0 ) ctx_sgn += 3 * sgn_nbv[ dpos ]; // IMPROVE !!!!!!!!!!!
                                              ^
                                               {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5091:35: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                if ( p_y > 0 ) ctx_sgn += 3 * sgn_nbv[ dpos ]; // IMPROVE !!!!!!!!!!!
                                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5095:5: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                absv_store[ dpos ] = absv;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5096:5: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                sgn_store[ dpos ] = sgn + 1;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5097:5: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                zdstls[dpos]--;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5099:16: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                if ( b_x > eob_x[dpos] ) eob_x[dpos] = b_x;
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5099:29: warning: statement should be inside braces [hicpp-braces-around-statements]
                                if ( b_x > eob_x[dpos] ) eob_x[dpos] = b_x;
                                                        ^
                                                         {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5099:30: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                if ( b_x > eob_x[dpos] ) eob_x[dpos] = b_x;
                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5100:16: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                if ( b_y > eob_y[dpos] ) eob_y[dpos] = b_y;
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5100:29: warning: statement should be inside braces [hicpp-braces-around-statements]
                                if ( b_y > eob_y[dpos] ) eob_y[dpos] = b_y;
                                                        ^
                                                         {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5100:30: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                if ( b_y > eob_y[dpos] ) eob_y[dpos] = b_y;
                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5110:2: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        free( absv_store );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5110:2: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5111:2: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        free( sgn_store );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5111:2: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5112:2: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        free( zdstls );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5112:2: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5113:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete ( mod_len );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4945:2: note: variable declared here
        model_s* mod_len;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5114:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete ( mod_res );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4947:2: note: variable declared here
        model_b* mod_res;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5115:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete ( mod_sgn );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:4946:2: note: variable declared here
        model_b* mod_sgn;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5125:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_encode_ac_low( ArithmeticEncoder* enc, int cmp )
       ~~~~ ^
       auto                                                      -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5133:2: warning: consider replacing 'short' with 'int16' [google-runtime-int]
        signed short* coeffs; // pointer to current coefficent data
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5135:2: warning: consider replacing 'short' with 'int16' [google-runtime-int]
        signed short* coeffs_x[ 8 ]; // prediction coeffs - current block
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5135:2: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5135:26: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        signed short* coeffs_x[ 8 ]; // prediction coeffs - current block
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5136:2: warning: consider replacing 'short' with 'int16' [google-runtime-int]
        signed short* coeffs_a[ 8 ]; // prediction coeffs - neighboring block
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5136:2: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5136:26: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        signed short* coeffs_a[ 8 ]; // prediction coeffs - neighboring block
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5137:2: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
        int pred_cf[ 8 ]; // prediction multipliers
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5137:15: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        int pred_cf[ 8 ]; // prediction multipliers
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5151:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int bpos, dpos;
        ^~~~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5152:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int clen, absv, sgn;
        ^~~~~~~~~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5153:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int bt, bp;
        ^~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5156:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int b_x, b_y;
        ^~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5157:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int p_x, p_y;
        ^~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5158:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int w, bc;
        ^~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5162:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_s *' [cppcoreguidelines-owning-memory]
        mod_len = INIT_MODEL_S( 11, ( segm_cnt[cmp] > 11 ) ? segm_cnt[cmp] : 11, 2 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5162:32: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        mod_len = INIT_MODEL_S( 11, ( segm_cnt[cmp] > 11 ) ? segm_cnt[cmp] : 11, 2 );
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5162:55: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        mod_len = INIT_MODEL_S( 11, ( segm_cnt[cmp] > 11 ) ? segm_cnt[cmp] : 11, 2 );
                                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5163:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_b *' [cppcoreguidelines-owning-memory]
        mod_res = INIT_MODEL_B( 1 << 4, 2 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5163:26: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
        mod_res = INIT_MODEL_B( 1 << 4, 2 );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:42: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5164:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_b *' [cppcoreguidelines-owning-memory]
        mod_top = INIT_MODEL_B( ( nois_trs[cmp] > 4 ) ? 1 << nois_trs[cmp] : 1 << 4, 3 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5164:28: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        mod_top = INIT_MODEL_B( ( nois_trs[cmp] > 4 ) ? 1 << nois_trs[cmp] : 1 << 4, 3 );
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5164:50: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
        mod_top = INIT_MODEL_B( ( nois_trs[cmp] > 4 ) ? 1 << nois_trs[cmp] : 1 << 4, 3 );
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:42: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5164:55: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        mod_top = INIT_MODEL_B( ( nois_trs[cmp] > 4 ) ? 1 << nois_trs[cmp] : 1 << 4, 3 );
                                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5164:71: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
        mod_top = INIT_MODEL_B( ( nois_trs[cmp] > 4 ) ? 1 << nois_trs[cmp] : 1 << 4, 3 );
                                                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:42: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5165:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_b *' [cppcoreguidelines-owning-memory]
        mod_sgn = INIT_MODEL_B( 11, 1 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5168:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        bc = cmpnfo[cmp].bc;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5169:6: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        w = cmpnfo[cmp].bch;
            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5172:19: warning: 16 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        for ( i = 2; i < 16; i++ )
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5177:27: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                bpos = static_cast<int>(zigzag[ b_x + (8*b_y) ]);
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5177:42: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                bpos = static_cast<int>(zigzag[ b_x + (8*b_y) ]);
                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5180:12: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                coeffs = colldata[ cmp ][ bpos ];
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5183:18: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        for ( ; b_x < 8; b_x++ ) {
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5184:5: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                coeffs_x[ b_x ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ];
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5184:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                coeffs_x[ b_x ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ];
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5184:40: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                coeffs_x[ b_x ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ];
                                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5184:52: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                coeffs_x[ b_x ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ];
                                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5185:5: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                coeffs_a[ b_x ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ] - 1;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5185:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                coeffs_a[ b_x ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ] - 1;
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5185:40: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                coeffs_a[ b_x ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ] - 1;
                                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5185:52: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                coeffs_a[ b_x ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ] - 1;
                                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5185:62: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                coeffs_a[ b_x ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ] - 1;
                                                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5186:5: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                pred_cf[ b_x ] = icos_base_8x8[ b_x * 8 ] * QUANT ( cmp, zigzag[b_x+(8*b_y)] );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5186:22: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                pred_cf[ b_x ] = icos_base_8x8[ b_x * 8 ] * QUANT ( cmp, zigzag[b_x+(8*b_y)] );
                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5186:43: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                pred_cf[ b_x ] = icos_base_8x8[ b_x * 8 ] * QUANT ( cmp, zigzag[b_x+(8*b_y)] );
                                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5186:49: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                pred_cf[ b_x ] = icos_base_8x8[ b_x * 8 ] * QUANT ( cmp, zigzag[b_x+(8*b_y)] );
                                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5186:49: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                pred_cf[ b_x ] = icos_base_8x8[ b_x * 8 ] * QUANT ( cmp, zigzag[b_x+(8*b_y)] );
                                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5186:62: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                pred_cf[ b_x ] = icos_base_8x8[ b_x * 8 ] * QUANT ( cmp, zigzag[b_x+(8*b_y)] );
                                                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5187:6: warning: Value stored to 'b_x' is never read [clang-analyzer-deadcode.DeadStores]
                        } b_x = 0;
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5187:6: note: Value stored to 'b_x' is never read
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5188:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        zdstls = zdstylow[ cmp ];
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5192:18: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        for ( ; b_y < 8; b_y++ ) {
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5193:5: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                coeffs_x[ b_y ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ];
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5193:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                coeffs_x[ b_y ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ];
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5193:40: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                coeffs_x[ b_y ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ];
                                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5193:52: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                coeffs_x[ b_y ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ];
                                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5194:5: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                coeffs_a[ b_y ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ] - w;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5194:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                coeffs_a[ b_y ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ] - w;
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5194:40: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                coeffs_a[ b_y ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ] - w;
                                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5194:52: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                coeffs_a[ b_y ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ] - w;
                                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5194:62: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                coeffs_a[ b_y ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ] - w;
                                                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5195:5: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                pred_cf[ b_y ] = icos_base_8x8[ b_y * 8 ] * QUANT ( cmp, zigzag[b_x+(8*b_y)] );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5195:22: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                pred_cf[ b_y ] = icos_base_8x8[ b_y * 8 ] * QUANT ( cmp, zigzag[b_x+(8*b_y)] );
                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5195:43: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                pred_cf[ b_y ] = icos_base_8x8[ b_y * 8 ] * QUANT ( cmp, zigzag[b_x+(8*b_y)] );
                                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5195:49: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                pred_cf[ b_y ] = icos_base_8x8[ b_y * 8 ] * QUANT ( cmp, zigzag[b_x+(8*b_y)] );
                                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5195:49: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                pred_cf[ b_y ] = icos_base_8x8[ b_y * 8 ] * QUANT ( cmp, zigzag[b_x+(8*b_y)] );
                                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5195:62: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                pred_cf[ b_y ] = icos_base_8x8[ b_y * 8 ] * QUANT ( cmp, zigzag[b_x+(8*b_y)] );
                                                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5196:6: warning: Value stored to 'b_y' is never read [clang-analyzer-deadcode.DeadStores]
                        } b_y = 0;
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5196:6: note: Value stored to 'b_y' is never read
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5197:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        zdstls = zdstxlow[ cmp ];
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5202:14: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                max_valp = MAX_V( cmp, bpos );
                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:26: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5202:14: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                max_valp = MAX_V( cmp, bpos );
                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:26: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5204:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                max_len = BITLEN1024P( max_valp );
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:321:26: note: expanded from macro 'BITLEN1024P'
#define BITLEN1024P(v)  ( pbitlen_0_1024[ v ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5205:25: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                thrs_bp = ( max_len > nois_trs[cmp] ) ? max_len - nois_trs[cmp] : 0;
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5205:53: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                thrs_bp = ( max_len > nois_trs[cmp] ) ? max_len - nois_trs[cmp] : 0;
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5211:9: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        if ( zdstls[ dpos ] == 0 )
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5211:30: warning: statement should be inside braces [google-readability-braces-around-statements]
                        if ( zdstls[ dpos ] == 0 )
                                                  ^
                                                   {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5219:24: warning: statement should be inside braces [google-readability-braces-around-statements]
                        if ( (*edge_c) > 0 )
                                            ^
                                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5220:33: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                ctx_lak = pjg_lakh_context( coeffs_x, coeffs_a, pred_cf, dpos );
                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5220:43: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                ctx_lak = pjg_lakh_context( coeffs_x, coeffs_a, pred_cf, dpos );
                                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5220:53: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                ctx_lak = pjg_lakh_context( coeffs_x, coeffs_a, pred_cf, dpos );
                                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5221:8: warning: statement should be inside braces [google-readability-braces-around-statements]
                        else ctx_lak = 0;
                            ^
                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5223:14: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        ctx_len = BITLEN2048N( ctx_lak ); // BITLENGTH context
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:322:27: note: expanded from macro 'BITLEN2048N'
#define BITLEN2048N(v)  ( (pbitlen_n2048_2047+2048)[ v ] )
                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5223:14: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        ctx_len = BITLEN2048N( ctx_lak ); // BITLENGTH context
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:322:26: note: expanded from macro 'BITLEN2048N'
#define BITLEN2048N(v)  ( (pbitlen_n2048_2047+2048)[ v ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5226:35: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        shift_model( mod_len, ctx_len, zdstls[ dpos ] );
                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5230:9: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        if ( coeffs[ dpos ] == 0 ) {
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5236:17: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                absv = ABS( coeffs[dpos] );
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5237:12: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                clen = BITLEN2048N( absv );
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:322:27: note: expanded from macro 'BITLEN2048N'
#define BITLEN2048N(v)  ( (pbitlen_n2048_2047+2048)[ v ] )
                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5237:12: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                clen = BITLEN2048N( absv );
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:322:26: note: expanded from macro 'BITLEN2048N'
#define BITLEN2048N(v)  ( (pbitlen_n2048_2047+2048)[ v ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5238:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                sgn = ( coeffs[dpos] > 0 ) ? 0 : 1;
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5247:28: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                        shift_model( mod_top, ctx_abs >> thrs_bp, ctx_res, clen - thrs_bp ); // shift in 3 contexts
                                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5249:11: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                        bt = BITN( absv, bp );
                                             ^
/home/mangix/devstuff/packJPG/source/./bitops.h:7:25: note: expanded from macro 'BITN'
#define BITN( c, n )            ( (c >> n) & 0x1 )
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5249:17: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                        bt = BITN( absv, bp );
                                                   ^
/home/mangix/devstuff/packJPG/source/./bitops.h:7:26: note: expanded from macro 'BITN'
#define BITN( c, n )            ( (c >> n) & 0x1 )
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5252:16: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                        ctx_res = ctx_res << 1;
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5253:11: warning: implicit conversion 'int' -> bool [readability-implicit-bool-conversion]
                                        if ( bt ) ctx_res |= 1; 
                                             ^
                                                != 0
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5253:15: warning: statement should be inside braces [hicpp-braces-around-statements]
                                        if ( bt ) ctx_res |= 1; 
                                                 ^
                                                  {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5253:16: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                        if ( bt ) ctx_res |= 1; 
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5256:28: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                        shift_model( mod_res, zdstls[ dpos ], bp ); // shift in 2 contexts
                                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5258:11: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                        bt = BITN( absv, bp );
                                             ^
/home/mangix/devstuff/packJPG/source/./bitops.h:7:25: note: expanded from macro 'BITN'
#define BITN( c, n )            ( (c >> n) & 0x1 )
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5258:17: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                        bt = BITN( absv, bp );
                                                   ^
/home/mangix/devstuff/packJPG/source/./bitops.h:7:26: note: expanded from macro 'BITN'
#define BITN( c, n )            ( (c >> n) & 0x1 )
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5265:5: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                zdstls[ dpos ]--;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5276:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete ( mod_len );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5127:2: note: variable declared here
        model_s* mod_len;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5277:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete ( mod_res );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5129:2: note: variable declared here
        model_b* mod_res;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5278:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete ( mod_top );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5130:2: note: variable declared here
        model_b* mod_top;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5279:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete ( mod_sgn );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5128:2: note: variable declared here
        model_b* mod_sgn;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5289:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_encode_generic( ArithmeticEncoder* enc, unsigned char* data, int len )
       ~~~~ ^
       auto                                                                            -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5296:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_s *' [cppcoreguidelines-owning-memory]
        model = INIT_MODEL_S( 256 + 1, 256, 1 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5299:27: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                encode_ari( enc, model, data[ i ] );
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5300:25: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                model->shift_context( data[ i ] );
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5303:26: warning: 256 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        encode_ari( enc, model, 256 );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5304:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete( model );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5291:2: note: variable declared here
        model_s* model;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5314:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_encode_bit( ArithmeticEncoder* enc, unsigned char bit )
       ~~~~ ^
       auto                                                             -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5320:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_b *' [cppcoreguidelines-owning-memory]
        model = INIT_MODEL_B( 1, -1 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5322:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete( model );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5316:2: note: variable declared here
        model_b* model;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5332:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_decode_zstscan( ArithmeticDecoder* dec, int cmp )
       ~~~~ ^
       auto                                                       -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5336:2: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
        unsigned char freqlist[ 64 ];
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5336:26: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        unsigned char freqlist[ 64 ];
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5343:2: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        zsrtscan[ cmp ][ 0 ] = 0;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5346:19: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        for ( i = 0; i < 64; i++ )
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5346:28: warning: statement should be inside braces [google-readability-braces-around-statements]
        for ( i = 0; i < 64; i++ )
                                  ^
                                   {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5347:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                freqlist[ i ] = stdscan[ i ];
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5347:19: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                freqlist[ i ] = stdscan[ i ];
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5350:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_s *' [cppcoreguidelines-owning-memory]
        model = INIT_MODEL_S( 64, 64, 1 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5353:19: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        for ( i = 1; i < 64; i++ )
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5356:26: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                model->exclude_symbols(64 - i);
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5365:24: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        for ( tpos = 0; i < 64; i++ ) {
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5366:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                while ( freqlist[ ++tpos ] == 0 );
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5366:38: warning: statement should be inside braces [hicpp-braces-around-statements]
                                while ( freqlist[ ++tpos ] == 0 );
                                                                 ^
                                                                  {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5367:5: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                zsrtscan[ cmp ][ i ] = freqlist[ tpos ];
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5367:28: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                zsrtscan[ cmp ][ i ] = freqlist[ tpos ];
                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5373:26: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                for ( tpos = 0; tpos < 64; tpos++ ) {
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5374:9: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        if ( freqlist[ tpos ] != 0 ) cpos--;
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5374:32: warning: statement should be inside braces [hicpp-braces-around-statements]
                        if ( freqlist[ tpos ] != 0 ) cpos--;
                                                    ^
                                                     {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5375:20: warning: statement should be inside braces [hicpp-braces-around-statements]
                        if ( cpos == 0 ) break;
                                        ^
                                         {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5379:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                zsrtscan[ cmp ][ i ] = freqlist[ tpos ];
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5379:26: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                zsrtscan[ cmp ][ i ] = freqlist[ tpos ];
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5381:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                freqlist[ tpos ] = 0;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5385:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete( model  );               
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5334:2: note: variable declared here
        model_s* model;;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5388:2: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        freqscan[ cmp ] = zsrtscan[ cmp ];
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5388:20: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
        freqscan[ cmp ] = zsrtscan[ cmp ];
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5388:20: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5398:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_decode_zdst_high( ArithmeticDecoder* dec, int cmp )
       ~~~~ ^
       auto                                                         -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5404:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int a, b;
        ^~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5410:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_s *' [cppcoreguidelines-owning-memory]
        model = INIT_MODEL_S( 49 + 1, 25 + 1, 1 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5411:11: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        zdstls = zdstdata[ cmp ];
                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5412:6: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        w = cmpnfo[cmp].bch;
            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5413:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        bc = cmpnfo[cmp].bc;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5419:20: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                a = ( a >= 0 ) ? zdstls[ a ] : 0;
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5420:20: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                b = ( b >= 0 ) ? zdstls[ b ] : 0;
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5424:3: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                zdstls[ dpos ] = decode_ari( dec, model );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5428:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete( model );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5400:2: note: variable declared here
        model_s* model;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5438:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_decode_zdst_low( ArithmeticDecoder* dec, int cmp )
       ~~~~ ^
       auto                                                        -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5453:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_s *' [cppcoreguidelines-owning-memory]
        model = INIT_MODEL_S( 8, 8, 2 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5454:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        zdstls_x = zdstxlow[ cmp ];
                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5455:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        zdstls_y = zdstylow[ cmp ];
                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5456:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        ctx_eobx = eobxhigh[ cmp ];
                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5457:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        ctx_eoby = eobyhigh[ cmp ];
                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5458:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        ctx_zdst = zdstdata[ cmp ];
                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5459:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        bc = cmpnfo[cmp].bc;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5463:27: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                model->shift_context( ( ctx_zdst[dpos] + 3 ) / 7 ); // shift context
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5463:50: warning: 7 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                model->shift_context( ( ctx_zdst[dpos] + 3 ) / 7 ); // shift context
                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5464:25: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                model->shift_context( ctx_eobx[dpos] ); // shift context
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5465:3: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                zdstls_x[ dpos ] = decode_ari( dec, model ); // decode symbol
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5469:27: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                model->shift_context( ( ctx_zdst[dpos] + 3 ) / 7 ); // shift context
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5469:50: warning: 7 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                model->shift_context( ( ctx_zdst[dpos] + 3 ) / 7 ); // shift context
                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5470:25: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                model->shift_context( ctx_eoby[dpos] ); // shift context
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5471:3: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                zdstls_y[ dpos ] = decode_ari( dec, model ); // decode symbol
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5475:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete( model );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5440:2: note: variable declared here
        model_s* model;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5485:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_decode_dc( ArithmeticDecoder* dec, int cmp )
       ~~~~ ^
       auto                                                  -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5494:2: warning: consider replacing 'short' with 'int16' [google-runtime-int]
        signed short* coeffs; // pointer to current coefficent data
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5496:2: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        unsigned short* absv_store; // absolute coefficients values storage
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5497:2: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        unsigned short* c_absc[ 6 ]; // quick access array for contexts
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5497:2: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5497:26: warning: 6 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        unsigned short* c_absc[ 6 ]; // quick access array for contexts
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5498:2: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
        int c_weight[ 6 ]; // weighting for contexts
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5498:16: warning: 6 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        int c_weight[ 6 ]; // weighting for contexts
                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5507:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int clen, absv, sgn;
        ^~~~~~~~~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5509:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int bt, bp;
        ^~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5511:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int p_x, p_y;
        ^~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5513:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int w, bc;
        ^~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5517:13: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
        segm_tab = segm_tables[ segm_cnt[ cmp ] - 1 ];
                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5517:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5517:26: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        segm_tab = segm_tables[ segm_cnt[ cmp ] - 1 ];
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5520:12: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        max_val = MAX_V( cmp, 0 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:26: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5520:12: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        max_val = MAX_V( cmp, 0 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:26: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5521:12: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        max_len = BITLEN1024P( max_val );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:321:26: note: expanded from macro 'BITLEN1024P'
#define BITLEN1024P(v)  ( pbitlen_0_1024[ v ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5524:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_s *' [cppcoreguidelines-owning-memory]
        mod_len = INIT_MODEL_S( max_len + 1, ( segm_cnt[cmp] > max_len ) ? segm_cnt[cmp] : max_len + 1, 2 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5524:41: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        mod_len = INIT_MODEL_S( max_len + 1, ( segm_cnt[cmp] > max_len ) ? segm_cnt[cmp] : max_len + 1, 2 );
                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5524:69: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        mod_len = INIT_MODEL_S( max_len + 1, ( segm_cnt[cmp] > max_len ) ? segm_cnt[cmp] : max_len + 1, 2 );
                                                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5525:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_b *' [cppcoreguidelines-owning-memory]
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5525:28: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5525:51: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:42: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5525:60: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5526:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_b *' [cppcoreguidelines-owning-memory]
        mod_sgn = INIT_MODEL_B( 1, 0 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5529:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        bc = cmpnfo[cmp].bc;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5530:6: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        w = cmpnfo[cmp].bch;
            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5533:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'unsigned short *' [cppcoreguidelines-owning-memory]
        absv_store = static_cast<unsigned short*>(calloc ( bc, sizeof( short ) ));
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5533:27: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        absv_store = static_cast<unsigned short*>(calloc ( bc, sizeof( short ) ));
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5533:44: warning: Result of 'calloc' is converted to a pointer of type 'unsigned short', which is incompatible with sizeof operand type 'short' [clang-analyzer-unix.MallocSizeof]
        absv_store = static_cast<unsigned short*>(calloc ( bc, sizeof( short ) ));
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5533:44: note: Result of 'calloc' is converted to a pointer of type 'unsigned short', which is incompatible with sizeof operand type 'short'
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5533:44: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
        absv_store = static_cast<unsigned short*>(calloc ( bc, sizeof( short ) ));
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5533:65: warning: consider replacing 'short' with 'int16' [google-runtime-int]
        absv_store = static_cast<unsigned short*>(calloc ( bc, sizeof( short ) ));
                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5535:3: warning: Potential leak of memory pointed to by 'mod_len' [clang-analyzer-cplusplus.NewDeleteLeaks]
                sprintf( errormessage, MEM_ERRMSG );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3408:2: note: Loop condition is true.  Entering loop body
        while( true ) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3410:8: note: Assuming 'hcode' is not equal to 0
                if ( hcode == 0x00 ) {
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3410:3: note: Taking false branch
                if ( hcode == 0x00 ) {
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3416:13: note: Assuming 'hcode' is >= 20
                else if ( hcode >= 0x14 ) {
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3416:8: note: Taking true branch
                else if ( hcode >= 0x14 ) {
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3418:9: note: Assuming 'hcode' is equal to 'appversion'
                        if ( hcode != appversion ) {
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3418:4: note: Taking false branch
                        if ( hcode != appversion ) {
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3424:9: note:  Execution continues on line 3435
                        else break;
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3438:7: note: Assuming the condition is false
        if ( !pjg_decode_generic( decoder, &hdrdata, &hdrs ) ) return false;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3438:2: note: Taking false branch
        if ( !pjg_decode_generic( decoder, &hdrdata, &hdrs ) ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3440:2: note: Taking false branch
        if (!pjg_decode_bit(decoder, &cb)) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3445:2: note: Taking false branch
        if ( !pjg_decode_bit( decoder, &cb ) ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3447:7: note: Assuming 'cb' is not equal to 1
        if ( cb == 1 )
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3447:2: note: Taking false branch
        if ( cb == 1 )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3451:7: note: Assuming the condition is false
        if ( !pjg_unoptimize_header() ) return false;   
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3451:2: note: Taking false branch
        if ( !pjg_unoptimize_header() ) return false;   
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3453:7: note: Assuming 'disc_meta' is false
        if ( disc_meta )
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3453:2: note: Taking false branch
        if ( disc_meta )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3456:7: note: Assuming the condition is false
        if ( !jpg_setup_imginfo() ) return false;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3456:2: note: Taking false branch
        if ( !jpg_setup_imginfo() ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3459:17: note: Assuming 'cmp' is < 'cmpc'
        for ( cmp = 0; cmp < cmpc; cmp++ ) {            
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3459:2: note: Loop condition is true.  Entering loop body
        for ( cmp = 0; cmp < cmpc; cmp++ ) {            
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3461:8: note: Assuming the condition is false
                if ( !pjg_decode_zstscan( decoder, cmp ) ) return false;                
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3461:3: note: Taking false branch
                if ( !pjg_decode_zstscan( decoder, cmp ) ) return false;                
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3463:3: note: Taking false branch
                if ( !pjg_decode_zdst_high( decoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3465:8: note: Assuming the condition is false
                if ( !pjg_decode_ac_high( decoder, cmp ) ) return false;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3465:3: note: Taking false branch
                if ( !pjg_decode_ac_high( decoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3467:8: note: Assuming the condition is false
                if ( !pjg_decode_zdst_low( decoder, cmp ) ) return false;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3467:3: note: Taking false branch
                if ( !pjg_decode_zdst_low( decoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3469:8: note: Assuming the condition is false
                if ( !pjg_decode_ac_low( decoder, cmp ) ) return false; 
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3469:3: note: Taking false branch
                if ( !pjg_decode_ac_low( decoder, cmp ) ) return false; 
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3471:9: note: Calling 'pjg_decode_dc'
                if ( !pjg_decode_dc( decoder, cmp ) ) return false;     
                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5520:12: note: Assuming the condition is false
        max_val = MAX_V( cmp, 0 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:26: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:22: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5520:12: note: '?' condition is false
        max_val = MAX_V( cmp, 0 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:24: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5524:12: note: Memory is allocated
        mod_len = INIT_MODEL_S( max_len + 1, ( segm_cnt[cmp] > max_len ) ? segm_cnt[cmp] : max_len + 1, 2 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:298:29: note: expanded from macro 'INIT_MODEL_S'
#define INIT_MODEL_S(a,b,c) new model_s( a, b, c, 255 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5524:41: note: Assuming the condition is false
        mod_len = INIT_MODEL_S( max_len + 1, ( segm_cnt[cmp] > max_len ) ? segm_cnt[cmp] : max_len + 1, 2 );
                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:298:45: note: expanded from macro 'INIT_MODEL_S'
#define INIT_MODEL_S(a,b,c) new model_s( a, b, c, 255 )
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5524:39: note: '?' condition is false
        mod_len = INIT_MODEL_S( max_len + 1, ( segm_cnt[cmp] > max_len ) ? segm_cnt[cmp] : max_len + 1, 2 );
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5525:28: note: Assuming the condition is true
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:42: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5525:26: note: '?' condition is true
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5534:7: note: Assuming the condition is true
        if ( absv_store == nullptr ) {
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5534:2: note: Taking true branch
        if ( absv_store == nullptr ) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5535:3: note: Potential leak of memory pointed to by 'mod_len'
                sprintf( errormessage, MEM_ERRMSG );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5535:3: warning: Potential leak of memory pointed to by 'mod_res' [clang-analyzer-cplusplus.NewDeleteLeaks]
                sprintf( errormessage, MEM_ERRMSG );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3408:2: note: Loop condition is true.  Entering loop body
        while( true ) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3410:8: note: Assuming 'hcode' is not equal to 0
                if ( hcode == 0x00 ) {
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3410:3: note: Taking false branch
                if ( hcode == 0x00 ) {
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3416:13: note: Assuming 'hcode' is >= 20
                else if ( hcode >= 0x14 ) {
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3416:8: note: Taking true branch
                else if ( hcode >= 0x14 ) {
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3418:9: note: Assuming 'hcode' is equal to 'appversion'
                        if ( hcode != appversion ) {
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3418:4: note: Taking false branch
                        if ( hcode != appversion ) {
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3424:9: note:  Execution continues on line 3435
                        else break;
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3438:7: note: Assuming the condition is false
        if ( !pjg_decode_generic( decoder, &hdrdata, &hdrs ) ) return false;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3438:2: note: Taking false branch
        if ( !pjg_decode_generic( decoder, &hdrdata, &hdrs ) ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3440:2: note: Taking false branch
        if (!pjg_decode_bit(decoder, &cb)) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3445:2: note: Taking false branch
        if ( !pjg_decode_bit( decoder, &cb ) ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3447:7: note: Assuming 'cb' is not equal to 1
        if ( cb == 1 )
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3447:2: note: Taking false branch
        if ( cb == 1 )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3451:7: note: Assuming the condition is false
        if ( !pjg_unoptimize_header() ) return false;   
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3451:2: note: Taking false branch
        if ( !pjg_unoptimize_header() ) return false;   
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3453:7: note: Assuming 'disc_meta' is false
        if ( disc_meta )
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3453:2: note: Taking false branch
        if ( disc_meta )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3456:7: note: Assuming the condition is false
        if ( !jpg_setup_imginfo() ) return false;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3456:2: note: Taking false branch
        if ( !jpg_setup_imginfo() ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3459:17: note: Assuming 'cmp' is < 'cmpc'
        for ( cmp = 0; cmp < cmpc; cmp++ ) {            
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3459:2: note: Loop condition is true.  Entering loop body
        for ( cmp = 0; cmp < cmpc; cmp++ ) {            
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3461:8: note: Assuming the condition is false
                if ( !pjg_decode_zstscan( decoder, cmp ) ) return false;                
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3461:3: note: Taking false branch
                if ( !pjg_decode_zstscan( decoder, cmp ) ) return false;                
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3463:3: note: Taking false branch
                if ( !pjg_decode_zdst_high( decoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3465:8: note: Assuming the condition is false
                if ( !pjg_decode_ac_high( decoder, cmp ) ) return false;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3465:3: note: Taking false branch
                if ( !pjg_decode_ac_high( decoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3467:8: note: Assuming the condition is false
                if ( !pjg_decode_zdst_low( decoder, cmp ) ) return false;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3467:3: note: Taking false branch
                if ( !pjg_decode_zdst_low( decoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3469:8: note: Assuming the condition is false
                if ( !pjg_decode_ac_low( decoder, cmp ) ) return false; 
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3469:3: note: Taking false branch
                if ( !pjg_decode_ac_low( decoder, cmp ) ) return false; 
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3471:9: note: Calling 'pjg_decode_dc'
                if ( !pjg_decode_dc( decoder, cmp ) ) return false;     
                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5520:12: note: Assuming the condition is false
        max_val = MAX_V( cmp, 0 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:26: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:22: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5520:12: note: '?' condition is false
        max_val = MAX_V( cmp, 0 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:24: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5524:41: note: Assuming the condition is false
        mod_len = INIT_MODEL_S( max_len + 1, ( segm_cnt[cmp] > max_len ) ? segm_cnt[cmp] : max_len + 1, 2 );
                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:298:45: note: expanded from macro 'INIT_MODEL_S'
#define INIT_MODEL_S(a,b,c) new model_s( a, b, c, 255 )
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5524:39: note: '?' condition is false
        mod_len = INIT_MODEL_S( max_len + 1, ( segm_cnt[cmp] > max_len ) ? segm_cnt[cmp] : max_len + 1, 2 );
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5525:12: note: Memory is allocated
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:29: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5525:28: note: Assuming the condition is true
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:42: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5525:26: note: '?' condition is true
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5534:7: note: Assuming the condition is true
        if ( absv_store == nullptr ) {
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5534:2: note: Taking true branch
        if ( absv_store == nullptr ) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5535:3: note: Potential leak of memory pointed to by 'mod_res'
                sprintf( errormessage, MEM_ERRMSG );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5535:3: warning: Potential leak of memory pointed to by 'mod_sgn' [clang-analyzer-cplusplus.NewDeleteLeaks]
                sprintf( errormessage, MEM_ERRMSG );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3408:2: note: Loop condition is true.  Entering loop body
        while( true ) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3410:8: note: Assuming 'hcode' is not equal to 0
                if ( hcode == 0x00 ) {
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3410:3: note: Taking false branch
                if ( hcode == 0x00 ) {
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3416:13: note: Assuming 'hcode' is >= 20
                else if ( hcode >= 0x14 ) {
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3416:8: note: Taking true branch
                else if ( hcode >= 0x14 ) {
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3418:9: note: Assuming 'hcode' is equal to 'appversion'
                        if ( hcode != appversion ) {
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3418:4: note: Taking false branch
                        if ( hcode != appversion ) {
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3424:9: note:  Execution continues on line 3435
                        else break;
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3438:7: note: Assuming the condition is false
        if ( !pjg_decode_generic( decoder, &hdrdata, &hdrs ) ) return false;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3438:2: note: Taking false branch
        if ( !pjg_decode_generic( decoder, &hdrdata, &hdrs ) ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3440:2: note: Taking false branch
        if (!pjg_decode_bit(decoder, &cb)) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3445:2: note: Taking false branch
        if ( !pjg_decode_bit( decoder, &cb ) ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3447:7: note: Assuming 'cb' is not equal to 1
        if ( cb == 1 )
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3447:2: note: Taking false branch
        if ( cb == 1 )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3451:7: note: Assuming the condition is false
        if ( !pjg_unoptimize_header() ) return false;   
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3451:2: note: Taking false branch
        if ( !pjg_unoptimize_header() ) return false;   
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3453:7: note: Assuming 'disc_meta' is false
        if ( disc_meta )
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3453:2: note: Taking false branch
        if ( disc_meta )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3456:7: note: Assuming the condition is false
        if ( !jpg_setup_imginfo() ) return false;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3456:2: note: Taking false branch
        if ( !jpg_setup_imginfo() ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3459:17: note: Assuming 'cmp' is < 'cmpc'
        for ( cmp = 0; cmp < cmpc; cmp++ ) {            
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3459:2: note: Loop condition is true.  Entering loop body
        for ( cmp = 0; cmp < cmpc; cmp++ ) {            
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3461:8: note: Assuming the condition is false
                if ( !pjg_decode_zstscan( decoder, cmp ) ) return false;                
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3461:3: note: Taking false branch
                if ( !pjg_decode_zstscan( decoder, cmp ) ) return false;                
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3463:3: note: Taking false branch
                if ( !pjg_decode_zdst_high( decoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3465:8: note: Assuming the condition is false
                if ( !pjg_decode_ac_high( decoder, cmp ) ) return false;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3465:3: note: Taking false branch
                if ( !pjg_decode_ac_high( decoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3467:8: note: Assuming the condition is false
                if ( !pjg_decode_zdst_low( decoder, cmp ) ) return false;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3467:3: note: Taking false branch
                if ( !pjg_decode_zdst_low( decoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3469:8: note: Assuming the condition is false
                if ( !pjg_decode_ac_low( decoder, cmp ) ) return false; 
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3469:3: note: Taking false branch
                if ( !pjg_decode_ac_low( decoder, cmp ) ) return false; 
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3471:9: note: Calling 'pjg_decode_dc'
                if ( !pjg_decode_dc( decoder, cmp ) ) return false;     
                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5520:12: note: Assuming the condition is false
        max_val = MAX_V( cmp, 0 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:26: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:22: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5520:12: note: '?' condition is false
        max_val = MAX_V( cmp, 0 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:24: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5524:41: note: Assuming the condition is false
        mod_len = INIT_MODEL_S( max_len + 1, ( segm_cnt[cmp] > max_len ) ? segm_cnt[cmp] : max_len + 1, 2 );
                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:298:45: note: expanded from macro 'INIT_MODEL_S'
#define INIT_MODEL_S(a,b,c) new model_s( a, b, c, 255 )
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5524:39: note: '?' condition is false
        mod_len = INIT_MODEL_S( max_len + 1, ( segm_cnt[cmp] > max_len ) ? segm_cnt[cmp] : max_len + 1, 2 );
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5525:28: note: Assuming the condition is true
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:42: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5525:26: note: '?' condition is true
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5526:12: note: Memory is allocated
        mod_sgn = INIT_MODEL_B( 1, 0 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:29: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5534:7: note: Assuming the condition is true
        if ( absv_store == nullptr ) {
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5534:2: note: Taking true branch
        if ( absv_store == nullptr ) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5535:3: note: Potential leak of memory pointed to by 'mod_sgn'
                sprintf( errormessage, MEM_ERRMSG );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5535:3: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                sprintf( errormessage, MEM_ERRMSG );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5535:12: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                sprintf( errormessage, MEM_ERRMSG );
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5541:21: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
        pjg_aavrg_prepare( c_absc, c_weight, absv_store, cmp );
                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5541:29: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
        pjg_aavrg_prepare( c_absc, c_weight, absv_store, cmp );
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5544:11: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        coeffs = colldata[ cmp ][ 0 ];
                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5545:11: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        zdstls = zdstdata[ cmp ];       
                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5557:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                snum = segm_tab[ zdstls[dpos] ];
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5557:20: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                snum = segm_tab[ zdstls[dpos] ];
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5559:32: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                ctx_avr = pjg_aavrg_context( c_absc, c_weight, dpos, p_y, p_x, r_x ); // AVERAGE context
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5559:40: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                ctx_avr = pjg_aavrg_context( c_absc, c_weight, dpos, p_y, p_x, r_x ); // AVERAGE context
                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5560:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                ctx_len = BITLEN1024P( ctx_avr ); // BITLENGTH context                          
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:321:26: note: expanded from macro 'BITLEN1024P'
#define BITLEN1024P(v)  ( pbitlen_0_1024[ v ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5579:12: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                absv = absv << 1;
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5580:10: warning: implicit conversion 'int' -> bool [readability-implicit-bool-conversion]
                                if ( bt ) absv |= 1; 
                                     ^
                                        != 0
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5580:14: warning: statement should be inside braces [hicpp-braces-around-statements]
                                if ( bt ) absv |= 1; 
                                         ^
                                          {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5580:15: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                if ( bt ) absv |= 1; 
                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5585:4: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        coeffs[ dpos ] = ( sgn == 0 ) ? absv : -absv;
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5585:36: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
                        coeffs[ dpos ] = ( sgn == 0 ) ? absv : -absv;
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5585:43: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
                        coeffs[ dpos ] = ( sgn == 0 ) ? absv : -absv;
                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5587:4: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        absv_store[ dpos ] = absv;
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5592:2: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        free( absv_store );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5592:2: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5593:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete ( mod_len );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5489:2: note: variable declared here
        model_s* mod_len;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5594:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete ( mod_res );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5491:2: note: variable declared here
        model_b* mod_res;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5595:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete ( mod_sgn );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5490:2: note: variable declared here
        model_b* mod_sgn;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5605:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_decode_ac_high( ArithmeticDecoder* dec, int cmp )
       ~~~~ ^
       auto                                                       -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5616:2: warning: consider replacing 'short' with 'int16' [google-runtime-int]
        signed short* coeffs; // pointer to current coefficent data
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5618:2: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        unsigned short* absv_store; // absolute coefficients values storage
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5619:2: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        unsigned short* c_absc[ 6 ]; // quick access array for contexts
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5619:2: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5619:26: warning: 6 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        unsigned short* c_absc[ 6 ]; // quick access array for contexts
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5620:2: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
        int c_weight[ 6 ]; // weighting for contexts
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5620:16: warning: 6 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        int c_weight[ 6 ]; // weighting for contexts
                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5633:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int bpos, dpos;
        ^~~~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5634:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int clen, absv, sgn;
        ^~~~~~~~~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5636:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int bt, bp;
        ^~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5639:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int b_x, b_y;
        ^~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5640:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int p_x, p_y;
        ^~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5642:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int w, bc;
        ^~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5646:13: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
        segm_tab = segm_tables[ segm_cnt[ cmp ] - 1 ];
                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5646:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5646:26: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        segm_tab = segm_tables[ segm_cnt[ cmp ] - 1 ];
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5649:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_s *' [cppcoreguidelines-owning-memory]
        mod_len = INIT_MODEL_S( 11, ( segm_cnt[cmp] > 11 ) ? segm_cnt[cmp] : 11, 2 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5649:32: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        mod_len = INIT_MODEL_S( 11, ( segm_cnt[cmp] > 11 ) ? segm_cnt[cmp] : 11, 2 );
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5649:55: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        mod_len = INIT_MODEL_S( 11, ( segm_cnt[cmp] > 11 ) ? segm_cnt[cmp] : 11, 2 );
                                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5650:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_b *' [cppcoreguidelines-owning-memory]
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5650:28: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5650:51: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:42: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5650:60: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5651:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_b *' [cppcoreguidelines-owning-memory]
        mod_sgn = INIT_MODEL_B( 9, 1 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5654:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        bc = cmpnfo[cmp].bc;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5655:6: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        w = cmpnfo[cmp].bch;
            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5658:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'unsigned short *' [cppcoreguidelines-owning-memory]
        absv_store = static_cast<unsigned short*>(calloc ( bc, sizeof( short ) ));      
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5658:27: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
        absv_store = static_cast<unsigned short*>(calloc ( bc, sizeof( short ) ));      
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5658:44: warning: Result of 'calloc' is converted to a pointer of type 'unsigned short', which is incompatible with sizeof operand type 'short' [clang-analyzer-unix.MallocSizeof]
        absv_store = static_cast<unsigned short*>(calloc ( bc, sizeof( short ) ));      
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5658:44: note: Result of 'calloc' is converted to a pointer of type 'unsigned short', which is incompatible with sizeof operand type 'short'
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5658:44: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
        absv_store = static_cast<unsigned short*>(calloc ( bc, sizeof( short ) ));      
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5658:65: warning: consider replacing 'short' with 'int16' [google-runtime-int]
        absv_store = static_cast<unsigned short*>(calloc ( bc, sizeof( short ) ));      
                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5659:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'unsigned char *' [cppcoreguidelines-owning-memory]
        sgn_store = static_cast<unsigned char*>(calloc ( bc, sizeof( char ) ));
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5659:42: warning: Result of 'calloc' is converted to a pointer of type 'unsigned char', which is incompatible with sizeof operand type 'char' [clang-analyzer-unix.MallocSizeof]
        sgn_store = static_cast<unsigned char*>(calloc ( bc, sizeof( char ) ));
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5659:42: note: Result of 'calloc' is converted to a pointer of type 'unsigned char', which is incompatible with sizeof operand type 'char'
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5659:42: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
        sgn_store = static_cast<unsigned char*>(calloc ( bc, sizeof( char ) ));
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5660:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'unsigned char *' [cppcoreguidelines-owning-memory]
        zdstls = static_cast<unsigned char*>(calloc ( bc, sizeof( char ) ));
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5660:39: warning: Result of 'calloc' is converted to a pointer of type 'unsigned char', which is incompatible with sizeof operand type 'char' [clang-analyzer-unix.MallocSizeof]
        zdstls = static_cast<unsigned char*>(calloc ( bc, sizeof( char ) ));
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5660:39: note: Result of 'calloc' is converted to a pointer of type 'unsigned char', which is incompatible with sizeof operand type 'char'
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5660:39: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
        zdstls = static_cast<unsigned char*>(calloc ( bc, sizeof( char ) ));
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5662:8: warning: Potential leak of memory pointed to by 'mod_len' [clang-analyzer-cplusplus.NewDeleteLeaks]
                if ( absv_store != nullptr ) free( absv_store );
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3408:2: note: Loop condition is true.  Entering loop body
        while( true ) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3410:8: note: Assuming 'hcode' is not equal to 0
                if ( hcode == 0x00 ) {
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3410:3: note: Taking false branch
                if ( hcode == 0x00 ) {
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3416:13: note: Assuming 'hcode' is >= 20
                else if ( hcode >= 0x14 ) {
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3416:8: note: Taking true branch
                else if ( hcode >= 0x14 ) {
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3418:9: note: Assuming 'hcode' is equal to 'appversion'
                        if ( hcode != appversion ) {
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3418:4: note: Taking false branch
                        if ( hcode != appversion ) {
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3424:9: note:  Execution continues on line 3435
                        else break;
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3438:7: note: Assuming the condition is false
        if ( !pjg_decode_generic( decoder, &hdrdata, &hdrs ) ) return false;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3438:2: note: Taking false branch
        if ( !pjg_decode_generic( decoder, &hdrdata, &hdrs ) ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3440:2: note: Taking false branch
        if (!pjg_decode_bit(decoder, &cb)) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3445:2: note: Taking false branch
        if ( !pjg_decode_bit( decoder, &cb ) ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3447:7: note: Assuming 'cb' is not equal to 1
        if ( cb == 1 )
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3447:2: note: Taking false branch
        if ( cb == 1 )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3451:7: note: Assuming the condition is false
        if ( !pjg_unoptimize_header() ) return false;   
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3451:2: note: Taking false branch
        if ( !pjg_unoptimize_header() ) return false;   
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3453:7: note: Assuming 'disc_meta' is false
        if ( disc_meta )
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3453:2: note: Taking false branch
        if ( disc_meta )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3456:7: note: Assuming the condition is false
        if ( !jpg_setup_imginfo() ) return false;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3456:2: note: Taking false branch
        if ( !jpg_setup_imginfo() ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3459:17: note: Assuming 'cmp' is < 'cmpc'
        for ( cmp = 0; cmp < cmpc; cmp++ ) {            
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3459:2: note: Loop condition is true.  Entering loop body
        for ( cmp = 0; cmp < cmpc; cmp++ ) {            
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3461:8: note: Assuming the condition is false
                if ( !pjg_decode_zstscan( decoder, cmp ) ) return false;                
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3461:3: note: Taking false branch
                if ( !pjg_decode_zstscan( decoder, cmp ) ) return false;                
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3463:3: note: Taking false branch
                if ( !pjg_decode_zdst_high( decoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3465:9: note: Calling 'pjg_decode_ac_high'
                if ( !pjg_decode_ac_high( decoder, cmp ) ) return false;
                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5649:12: note: Memory is allocated
        mod_len = INIT_MODEL_S( 11, ( segm_cnt[cmp] > 11 ) ? segm_cnt[cmp] : 11, 2 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:298:29: note: expanded from macro 'INIT_MODEL_S'
#define INIT_MODEL_S(a,b,c) new model_s( a, b, c, 255 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5649:32: note: Assuming the condition is false
        mod_len = INIT_MODEL_S( 11, ( segm_cnt[cmp] > 11 ) ? segm_cnt[cmp] : 11, 2 );
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:298:45: note: expanded from macro 'INIT_MODEL_S'
#define INIT_MODEL_S(a,b,c) new model_s( a, b, c, 255 )
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5649:30: note: '?' condition is false
        mod_len = INIT_MODEL_S( 11, ( segm_cnt[cmp] > 11 ) ? segm_cnt[cmp] : 11, 2 );
                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5650:28: note: Assuming the condition is true
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:42: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5650:26: note: '?' condition is true
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5661:9: note: Assuming the condition is true
        if ( ( absv_store == nullptr ) || ( sgn_store == nullptr ) || ( zdstls == nullptr ) ) {
               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5661:33: note: Left side of '||' is true
        if ( ( absv_store == nullptr ) || ( sgn_store == nullptr ) || ( zdstls == nullptr ) ) {
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5662:8: note: Potential leak of memory pointed to by 'mod_len'
                if ( absv_store != nullptr ) free( absv_store );
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5662:8: warning: Potential leak of memory pointed to by 'mod_res' [clang-analyzer-cplusplus.NewDeleteLeaks]
                if ( absv_store != nullptr ) free( absv_store );
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3408:2: note: Loop condition is true.  Entering loop body
        while( true ) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3410:8: note: Assuming 'hcode' is not equal to 0
                if ( hcode == 0x00 ) {
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3410:3: note: Taking false branch
                if ( hcode == 0x00 ) {
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3416:13: note: Assuming 'hcode' is >= 20
                else if ( hcode >= 0x14 ) {
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3416:8: note: Taking true branch
                else if ( hcode >= 0x14 ) {
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3418:9: note: Assuming 'hcode' is equal to 'appversion'
                        if ( hcode != appversion ) {
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3418:4: note: Taking false branch
                        if ( hcode != appversion ) {
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3424:9: note:  Execution continues on line 3435
                        else break;
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3438:7: note: Assuming the condition is false
        if ( !pjg_decode_generic( decoder, &hdrdata, &hdrs ) ) return false;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3438:2: note: Taking false branch
        if ( !pjg_decode_generic( decoder, &hdrdata, &hdrs ) ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3440:2: note: Taking false branch
        if (!pjg_decode_bit(decoder, &cb)) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3445:2: note: Taking false branch
        if ( !pjg_decode_bit( decoder, &cb ) ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3447:7: note: Assuming 'cb' is not equal to 1
        if ( cb == 1 )
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3447:2: note: Taking false branch
        if ( cb == 1 )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3451:7: note: Assuming the condition is false
        if ( !pjg_unoptimize_header() ) return false;   
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3451:2: note: Taking false branch
        if ( !pjg_unoptimize_header() ) return false;   
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3453:7: note: Assuming 'disc_meta' is false
        if ( disc_meta )
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3453:2: note: Taking false branch
        if ( disc_meta )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3456:7: note: Assuming the condition is false
        if ( !jpg_setup_imginfo() ) return false;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3456:2: note: Taking false branch
        if ( !jpg_setup_imginfo() ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3459:17: note: Assuming 'cmp' is < 'cmpc'
        for ( cmp = 0; cmp < cmpc; cmp++ ) {            
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3459:2: note: Loop condition is true.  Entering loop body
        for ( cmp = 0; cmp < cmpc; cmp++ ) {            
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3461:8: note: Assuming the condition is false
                if ( !pjg_decode_zstscan( decoder, cmp ) ) return false;                
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3461:3: note: Taking false branch
                if ( !pjg_decode_zstscan( decoder, cmp ) ) return false;                
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3463:3: note: Taking false branch
                if ( !pjg_decode_zdst_high( decoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3465:9: note: Calling 'pjg_decode_ac_high'
                if ( !pjg_decode_ac_high( decoder, cmp ) ) return false;
                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5649:32: note: Assuming the condition is false
        mod_len = INIT_MODEL_S( 11, ( segm_cnt[cmp] > 11 ) ? segm_cnt[cmp] : 11, 2 );
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:298:45: note: expanded from macro 'INIT_MODEL_S'
#define INIT_MODEL_S(a,b,c) new model_s( a, b, c, 255 )
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5649:30: note: '?' condition is false
        mod_len = INIT_MODEL_S( 11, ( segm_cnt[cmp] > 11 ) ? segm_cnt[cmp] : 11, 2 );
                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5650:12: note: Memory is allocated
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:29: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5650:28: note: Assuming the condition is true
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:42: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5650:26: note: '?' condition is true
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5661:9: note: Assuming the condition is true
        if ( ( absv_store == nullptr ) || ( sgn_store == nullptr ) || ( zdstls == nullptr ) ) {
               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5661:33: note: Left side of '||' is true
        if ( ( absv_store == nullptr ) || ( sgn_store == nullptr ) || ( zdstls == nullptr ) ) {
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5662:8: note: Potential leak of memory pointed to by 'mod_res'
                if ( absv_store != nullptr ) free( absv_store );
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5662:8: warning: Potential leak of memory pointed to by 'mod_sgn' [clang-analyzer-cplusplus.NewDeleteLeaks]
                if ( absv_store != nullptr ) free( absv_store );
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3408:2: note: Loop condition is true.  Entering loop body
        while( true ) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3410:8: note: Assuming 'hcode' is not equal to 0
                if ( hcode == 0x00 ) {
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3410:3: note: Taking false branch
                if ( hcode == 0x00 ) {
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3416:13: note: Assuming 'hcode' is >= 20
                else if ( hcode >= 0x14 ) {
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3416:8: note: Taking true branch
                else if ( hcode >= 0x14 ) {
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3418:9: note: Assuming 'hcode' is equal to 'appversion'
                        if ( hcode != appversion ) {
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3418:4: note: Taking false branch
                        if ( hcode != appversion ) {
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3424:9: note:  Execution continues on line 3435
                        else break;
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3438:7: note: Assuming the condition is false
        if ( !pjg_decode_generic( decoder, &hdrdata, &hdrs ) ) return false;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3438:2: note: Taking false branch
        if ( !pjg_decode_generic( decoder, &hdrdata, &hdrs ) ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3440:2: note: Taking false branch
        if (!pjg_decode_bit(decoder, &cb)) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3445:2: note: Taking false branch
        if ( !pjg_decode_bit( decoder, &cb ) ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3447:7: note: Assuming 'cb' is not equal to 1
        if ( cb == 1 )
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3447:2: note: Taking false branch
        if ( cb == 1 )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3451:7: note: Assuming the condition is false
        if ( !pjg_unoptimize_header() ) return false;   
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3451:2: note: Taking false branch
        if ( !pjg_unoptimize_header() ) return false;   
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3453:7: note: Assuming 'disc_meta' is false
        if ( disc_meta )
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3453:2: note: Taking false branch
        if ( disc_meta )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3456:7: note: Assuming the condition is false
        if ( !jpg_setup_imginfo() ) return false;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3456:2: note: Taking false branch
        if ( !jpg_setup_imginfo() ) return false;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3459:17: note: Assuming 'cmp' is < 'cmpc'
        for ( cmp = 0; cmp < cmpc; cmp++ ) {            
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3459:2: note: Loop condition is true.  Entering loop body
        for ( cmp = 0; cmp < cmpc; cmp++ ) {            
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3461:8: note: Assuming the condition is false
                if ( !pjg_decode_zstscan( decoder, cmp ) ) return false;                
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3461:3: note: Taking false branch
                if ( !pjg_decode_zstscan( decoder, cmp ) ) return false;                
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3463:3: note: Taking false branch
                if ( !pjg_decode_zdst_high( decoder, cmp ) ) return false;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3465:9: note: Calling 'pjg_decode_ac_high'
                if ( !pjg_decode_ac_high( decoder, cmp ) ) return false;
                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5649:32: note: Assuming the condition is false
        mod_len = INIT_MODEL_S( 11, ( segm_cnt[cmp] > 11 ) ? segm_cnt[cmp] : 11, 2 );
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:298:45: note: expanded from macro 'INIT_MODEL_S'
#define INIT_MODEL_S(a,b,c) new model_s( a, b, c, 255 )
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5649:30: note: '?' condition is false
        mod_len = INIT_MODEL_S( 11, ( segm_cnt[cmp] > 11 ) ? segm_cnt[cmp] : 11, 2 );
                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5650:28: note: Assuming the condition is true
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:42: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5650:26: note: '?' condition is true
        mod_res = INIT_MODEL_B( ( segm_cnt[cmp] < 16 ) ? 1 << 4 : segm_cnt[cmp], 2 );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5651:12: note: Memory is allocated
        mod_sgn = INIT_MODEL_B( 9, 1 );
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:29: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5661:9: note: Assuming the condition is true
        if ( ( absv_store == nullptr ) || ( sgn_store == nullptr ) || ( zdstls == nullptr ) ) {
               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5661:33: note: Left side of '||' is true
        if ( ( absv_store == nullptr ) || ( sgn_store == nullptr ) || ( zdstls == nullptr ) ) {
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5662:8: note: Potential leak of memory pointed to by 'mod_sgn'
                if ( absv_store != nullptr ) free( absv_store );
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5662:31: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( absv_store != nullptr ) free( absv_store );
                                            ^
                                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5662:32: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
                if ( absv_store != nullptr ) free( absv_store );
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5662:32: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5663:30: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( sgn_store != nullptr ) free( sgn_store );
                                           ^
                                            {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5663:31: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
                if ( sgn_store != nullptr ) free( sgn_store );
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5663:31: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5664:27: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( zdstls != nullptr ) free( zdstls );
                                        ^
                                         {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5664:28: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
                if ( zdstls != nullptr ) free( zdstls );
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5664:28: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5665:3: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                sprintf( errormessage, MEM_ERRMSG );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5665:12: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                sprintf( errormessage, MEM_ERRMSG );
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5671:22: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        sgn_nbh = sgn_store - 1;
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5672:22: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        sgn_nbv = sgn_store - w;        
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5675:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        eob_x = eobxhigh[ cmp ];
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5676:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        eob_y = eobyhigh[ cmp ];
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5683:37: warning: statement should be inside braces [google-readability-braces-around-statements]
        for ( dpos = 0; dpos < bc; dpos++ )
                                           ^
                                            {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5684:3: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                zdstls[ dpos ] = zdstdata[ cmp ][ dpos ];
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5684:20: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                zdstls[ dpos ] = zdstdata[ cmp ][ dpos ];
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5684:20: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5687:19: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        for ( i = 1; i < 64; i++ )
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5690:27: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                bpos = static_cast<int>(freqscan[cmp][i]);
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5690:27: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5691:9: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                b_x = unzigzag[ bpos ] % 8;
                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5691:28: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                b_x = unzigzag[ bpos ] % 8;
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5692:9: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                b_y = unzigzag[ bpos ] / 8;             
                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5692:28: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                b_y = unzigzag[ bpos ] / 8;             
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5694:38: warning: statement should be inside braces [google-readability-braces-around-statements]
                if ( ( b_x == 0 ) || ( b_y == 0 ) )
                                                   ^
                                                    {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5698:42: warning: consider replacing 'short' with 'int16' [google-runtime-int]
                memset( absv_store, 0x00, bc * sizeof( short ) );
                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5702:22: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                pjg_aavrg_prepare( c_absc, c_weight, absv_store, cmp );
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5702:30: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                pjg_aavrg_prepare( c_absc, c_weight, absv_store, cmp );
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5705:12: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                coeffs = colldata[ cmp ][ bpos ];
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5708:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                max_val = MAX_V( cmp, bpos );
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:26: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5708:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                max_val = MAX_V( cmp, bpos );
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:26: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5709:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                max_len = BITLEN1024P( max_val );
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:321:26: note: expanded from macro 'BITLEN1024P'
#define BITLEN1024P(v)  ( pbitlen_0_1024[ v ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5715:9: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        if ( zdstls[dpos] == 0 )
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5715:28: warning: statement should be inside braces [google-readability-braces-around-statements]
                        if ( zdstls[dpos] == 0 )
                                                ^
                                                 {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5725:11: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        snum = segm_tab[ zdstls[dpos] ];
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5725:21: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        snum = segm_tab[ zdstls[dpos] ];
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5727:33: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        ctx_avr = pjg_aavrg_context( c_absc, c_weight, dpos, p_y, p_x, r_x ); // AVERAGE context
                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5727:41: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        ctx_avr = pjg_aavrg_context( c_absc, c_weight, dpos, p_y, p_x, r_x ); // AVERAGE context
                                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5728:14: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        ctx_len = BITLEN1024P( ctx_avr ); // BITLENGTH context                          
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:321:26: note: expanded from macro 'BITLEN1024P'
#define BITLEN1024P(v)  ( pbitlen_0_1024[ v ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5748:13: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                        absv = absv << 1;
                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5749:11: warning: implicit conversion 'int' -> bool [readability-implicit-bool-conversion]
                                        if ( bt ) absv |= 1; 
                                             ^
                                                != 0
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5749:15: warning: statement should be inside braces [hicpp-braces-around-statements]
                                        if ( bt ) absv |= 1; 
                                                 ^
                                                  {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5749:16: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                        if ( bt ) absv |= 1; 
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5752:29: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                ctx_sgn = ( p_x > 0 ) ? sgn_nbh[ dpos ] : 0; // sign context
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5753:19: warning: statement should be inside braces [hicpp-braces-around-statements]
                                if ( p_y > 0 ) ctx_sgn += 3 * sgn_nbv[ dpos ]; // IMPROVE! !!!!!!!!!!!
                                              ^
                                               {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5753:35: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                if ( p_y > 0 ) ctx_sgn += 3 * sgn_nbv[ dpos ]; // IMPROVE! !!!!!!!!!!!
                                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5757:5: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                coeffs[ dpos ] = ( sgn == 0 ) ? absv : -absv;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5757:37: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
                                coeffs[ dpos ] = ( sgn == 0 ) ? absv : -absv;
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5757:44: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
                                coeffs[ dpos ] = ( sgn == 0 ) ? absv : -absv;
                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5759:5: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                absv_store[ dpos ] = absv;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5760:5: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                sgn_store[ dpos ] = sgn + 1;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5761:5: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                zdstls[dpos]--;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5763:16: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                if ( b_x > eob_x[dpos] ) eob_x[dpos] = b_x;
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5763:29: warning: statement should be inside braces [hicpp-braces-around-statements]
                                if ( b_x > eob_x[dpos] ) eob_x[dpos] = b_x;
                                                        ^
                                                         {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5763:30: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                if ( b_x > eob_x[dpos] ) eob_x[dpos] = b_x;
                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5764:16: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                if ( b_y > eob_y[dpos] ) eob_y[dpos] = b_y;     
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5764:29: warning: statement should be inside braces [hicpp-braces-around-statements]
                                if ( b_y > eob_y[dpos] ) eob_y[dpos] = b_y;     
                                                        ^
                                                         {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5764:30: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                if ( b_y > eob_y[dpos] ) eob_y[dpos] = b_y;     
                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5774:2: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        free( absv_store );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5774:2: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5775:2: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        free( sgn_store );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5775:2: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5776:2: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        free( zdstls );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5776:2: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5777:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete ( mod_len );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5609:2: note: variable declared here
        model_s* mod_len;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5778:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete ( mod_res );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5611:2: note: variable declared here
        model_b* mod_res;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5779:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete ( mod_sgn );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5610:2: note: variable declared here
        model_b* mod_sgn;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5789:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_decode_ac_low( ArithmeticDecoder* dec, int cmp )
       ~~~~ ^
       auto                                                      -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5797:2: warning: consider replacing 'short' with 'int16' [google-runtime-int]
        signed short* coeffs; // pointer to current coefficent data
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5799:2: warning: consider replacing 'short' with 'int16' [google-runtime-int]
        signed short* coeffs_x[ 8 ]; // prediction coeffs - current block
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5799:2: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5799:26: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        signed short* coeffs_x[ 8 ]; // prediction coeffs - current block
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5800:2: warning: consider replacing 'short' with 'int16' [google-runtime-int]
        signed short* coeffs_a[ 8 ]; // prediction coeffs - neighboring block
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5800:2: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5800:26: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        signed short* coeffs_a[ 8 ]; // prediction coeffs - neighboring block
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5801:2: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
        int pred_cf[ 8 ]; // prediction multipliers
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5801:15: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        int pred_cf[ 8 ]; // prediction multipliers
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5815:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int bpos, dpos;
        ^~~~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5816:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int clen, absv, sgn;
        ^~~~~~~~~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5817:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int bt, bp;
        ^~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5820:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int b_x, b_y;
        ^~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5821:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int p_x, p_y;
        ^~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5822:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int w, bc;
        ^~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5826:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_s *' [cppcoreguidelines-owning-memory]
        mod_len = INIT_MODEL_S( 11, ( segm_cnt[cmp] > 11 ) ? segm_cnt[cmp] : 11, 2 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5826:32: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        mod_len = INIT_MODEL_S( 11, ( segm_cnt[cmp] > 11 ) ? segm_cnt[cmp] : 11, 2 );
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5826:55: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        mod_len = INIT_MODEL_S( 11, ( segm_cnt[cmp] > 11 ) ? segm_cnt[cmp] : 11, 2 );
                                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5827:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_b *' [cppcoreguidelines-owning-memory]
        mod_res = INIT_MODEL_B( 1 << 4, 2 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5827:26: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
        mod_res = INIT_MODEL_B( 1 << 4, 2 );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:42: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5828:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_b *' [cppcoreguidelines-owning-memory]
        mod_top = INIT_MODEL_B( ( nois_trs[cmp] > 4 ) ? 1 << nois_trs[cmp] : 1 << 4, 3 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5828:28: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        mod_top = INIT_MODEL_B( ( nois_trs[cmp] > 4 ) ? 1 << nois_trs[cmp] : 1 << 4, 3 );
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5828:50: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
        mod_top = INIT_MODEL_B( ( nois_trs[cmp] > 4 ) ? 1 << nois_trs[cmp] : 1 << 4, 3 );
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:42: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5828:55: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        mod_top = INIT_MODEL_B( ( nois_trs[cmp] > 4 ) ? 1 << nois_trs[cmp] : 1 << 4, 3 );
                                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5828:71: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
        mod_top = INIT_MODEL_B( ( nois_trs[cmp] > 4 ) ? 1 << nois_trs[cmp] : 1 << 4, 3 );
                                                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:299:42: note: expanded from macro 'INIT_MODEL_B'
#define INIT_MODEL_B(a,b)   new model_b( a, b, 255 )
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5829:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_b *' [cppcoreguidelines-owning-memory]
        mod_sgn = INIT_MODEL_B( 11, 1 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5832:7: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        bc = cmpnfo[cmp].bc;
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5833:6: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        w = cmpnfo[cmp].bch;
            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5836:19: warning: 16 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        for ( i = 2; i < 16; i++ )
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5841:27: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                bpos = static_cast<int>(zigzag[ b_x + (8*b_y) ]);
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5841:42: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                bpos = static_cast<int>(zigzag[ b_x + (8*b_y) ]);
                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5844:12: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                coeffs = colldata[ cmp ][ bpos ];
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5847:18: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        for ( ; b_x < 8; b_x++ ) {
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5848:5: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                coeffs_x[ b_x ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ];
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5848:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                coeffs_x[ b_x ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ];
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5848:40: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                coeffs_x[ b_x ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ];
                                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5848:52: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                coeffs_x[ b_x ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ];
                                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5849:5: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                coeffs_a[ b_x ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ] - 1;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5849:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                coeffs_a[ b_x ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ] - 1;
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5849:40: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                coeffs_a[ b_x ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ] - 1;
                                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5849:52: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                coeffs_a[ b_x ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ] - 1;
                                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5849:62: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                coeffs_a[ b_x ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ] - 1;
                                                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5850:5: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                pred_cf[ b_x ] = icos_base_8x8[ b_x * 8 ] * QUANT ( cmp, zigzag[b_x+(8*b_y)] );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5850:22: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                pred_cf[ b_x ] = icos_base_8x8[ b_x * 8 ] * QUANT ( cmp, zigzag[b_x+(8*b_y)] );
                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5850:43: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                pred_cf[ b_x ] = icos_base_8x8[ b_x * 8 ] * QUANT ( cmp, zigzag[b_x+(8*b_y)] );
                                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5850:49: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                pred_cf[ b_x ] = icos_base_8x8[ b_x * 8 ] * QUANT ( cmp, zigzag[b_x+(8*b_y)] );
                                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5850:49: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                pred_cf[ b_x ] = icos_base_8x8[ b_x * 8 ] * QUANT ( cmp, zigzag[b_x+(8*b_y)] );
                                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5850:62: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                pred_cf[ b_x ] = icos_base_8x8[ b_x * 8 ] * QUANT ( cmp, zigzag[b_x+(8*b_y)] );
                                                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5851:6: warning: Value stored to 'b_x' is never read [clang-analyzer-deadcode.DeadStores]
                        } b_x = 0;
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5851:6: note: Value stored to 'b_x' is never read
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5852:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        zdstls = zdstylow[ cmp ];
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5856:18: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        for ( ; b_y < 8; b_y++ ) {
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5857:5: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                coeffs_x[ b_y ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ];
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5857:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                coeffs_x[ b_y ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ];
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5857:40: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                coeffs_x[ b_y ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ];
                                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5857:52: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                coeffs_x[ b_y ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ];
                                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5858:5: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                coeffs_a[ b_y ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ] - w;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5858:23: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                coeffs_a[ b_y ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ] - w;
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5858:40: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                coeffs_a[ b_y ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ] - w;
                                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5858:52: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                coeffs_a[ b_y ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ] - w;
                                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5858:62: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                coeffs_a[ b_y ] = colldata[ cmp ][ zigzag[b_x+(8*b_y)] ] - w;
                                                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5859:5: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                pred_cf[ b_y ] = icos_base_8x8[ b_y * 8 ] * QUANT ( cmp, zigzag[b_x+(8*b_y)] );
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5859:22: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                pred_cf[ b_y ] = icos_base_8x8[ b_y * 8 ] * QUANT ( cmp, zigzag[b_x+(8*b_y)] );
                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5859:43: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                pred_cf[ b_y ] = icos_base_8x8[ b_y * 8 ] * QUANT ( cmp, zigzag[b_x+(8*b_y)] );
                                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5859:49: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                pred_cf[ b_y ] = icos_base_8x8[ b_y * 8 ] * QUANT ( cmp, zigzag[b_x+(8*b_y)] );
                                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5859:49: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                pred_cf[ b_y ] = icos_base_8x8[ b_y * 8 ] * QUANT ( cmp, zigzag[b_x+(8*b_y)] );
                                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5859:62: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                pred_cf[ b_y ] = icos_base_8x8[ b_y * 8 ] * QUANT ( cmp, zigzag[b_x+(8*b_y)] );
                                                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5860:6: warning: Value stored to 'b_y' is never read [clang-analyzer-deadcode.DeadStores]
                        } b_y = 0;
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5860:6: note: Value stored to 'b_y' is never read
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5861:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        zdstls = zdstxlow[ cmp ];
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5866:14: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                max_valp = MAX_V( cmp, bpos );
                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:26: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5866:14: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                max_valp = MAX_V( cmp, bpos );
                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:26: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5868:13: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                max_len = BITLEN1024P( max_valp );
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:321:26: note: expanded from macro 'BITLEN1024P'
#define BITLEN1024P(v)  ( pbitlen_0_1024[ v ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5869:25: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                thrs_bp = ( max_len > nois_trs[cmp] ) ? max_len - nois_trs[cmp] : 0;
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5869:53: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                thrs_bp = ( max_len > nois_trs[cmp] ) ? max_len - nois_trs[cmp] : 0;
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5875:9: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        if ( zdstls[ dpos ] == 0 )
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5875:30: warning: statement should be inside braces [google-readability-braces-around-statements]
                        if ( zdstls[ dpos ] == 0 )
                                                  ^
                                                   {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5883:24: warning: statement should be inside braces [google-readability-braces-around-statements]
                        if ( (*edge_c) > 0 )
                                            ^
                                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5884:33: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                ctx_lak = pjg_lakh_context( coeffs_x, coeffs_a, pred_cf, dpos );
                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5884:43: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                ctx_lak = pjg_lakh_context( coeffs_x, coeffs_a, pred_cf, dpos );
                                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5884:53: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                                ctx_lak = pjg_lakh_context( coeffs_x, coeffs_a, pred_cf, dpos );
                                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5885:8: warning: statement should be inside braces [google-readability-braces-around-statements]
                        else ctx_lak = 0;
                            ^
                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5887:14: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                        ctx_len = BITLEN2048N( ctx_lak ); // BITLENGTH context                          
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:322:27: note: expanded from macro 'BITLEN2048N'
#define BITLEN2048N(v)  ( (pbitlen_n2048_2047+2048)[ v ] )
                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5887:14: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        ctx_len = BITLEN2048N( ctx_lak ); // BITLENGTH context                          
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:322:26: note: expanded from macro 'BITLEN2048N'
#define BITLEN2048N(v)  ( (pbitlen_n2048_2047+2048)[ v ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5889:35: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        shift_model( mod_len, ctx_len, zdstls[ dpos ] );
                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5905:28: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                        shift_model( mod_top, ctx_abs >> thrs_bp, ctx_res, clen - thrs_bp ); // shift in 3 contexts
                                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5909:16: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                        ctx_res = ctx_res << 1;
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5910:11: warning: implicit conversion 'int' -> bool [readability-implicit-bool-conversion]
                                        if ( bt ) ctx_res |= 1; 
                                             ^
                                                != 0
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5910:15: warning: statement should be inside braces [hicpp-braces-around-statements]
                                        if ( bt ) ctx_res |= 1; 
                                                 ^
                                                  {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5910:16: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                        if ( bt ) ctx_res |= 1; 
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5914:28: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                        shift_model( mod_res, zdstls[ dpos ], bp ); // shift in 2 contexts
                                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5918:13: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                        absv = absv << 1;
                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5919:11: warning: implicit conversion 'int' -> bool [readability-implicit-bool-conversion]
                                        if ( bt ) absv |= 1; 
                                             ^
                                                != 0
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5919:15: warning: statement should be inside braces [hicpp-braces-around-statements]
                                        if ( bt ) absv |= 1; 
                                                 ^
                                                  {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5919:16: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                                        if ( bt ) absv |= 1; 
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5922:27: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                shift_model( mod_sgn, zdstls[ dpos ], ctx_sgn );
                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5925:5: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                coeffs[ dpos ] = ( sgn == 0 ) ? absv : -absv;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5925:37: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
                                coeffs[ dpos ] = ( sgn == 0 ) ? absv : -absv;
                                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5925:44: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
                                coeffs[ dpos ] = ( sgn == 0 ) ? absv : -absv;
                                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5927:5: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                zdstls[ dpos ]--;
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5938:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete ( mod_len );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5791:2: note: variable declared here
        model_s* mod_len;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5939:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete ( mod_res );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5793:2: note: variable declared here
        model_b* mod_res;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5940:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete ( mod_top );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5794:2: note: variable declared here
        model_b* mod_top;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5941:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete ( mod_sgn );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5792:2: note: variable declared here
        model_b* mod_sgn;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5951:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_decode_generic( ArithmeticDecoder* dec, unsigned char** data, int* len )
       ~~~~ ^
       auto                                                                              -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5959:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'MemoryWriter *' [cppcoreguidelines-owning-memory]
        bwrt = new MemoryWriter();
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5962:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_s *' [cppcoreguidelines-owning-memory]
        model = INIT_MODEL_S( 256 + 1, 256, 1 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5965:13: warning: 256 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                if ( c == 256 ) break;
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5965:18: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( c == 256 ) break;
                               ^
                                {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5969:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete( model );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5954:2: note: variable declared here
        model_s* model;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5973:3: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
                delete bwrt;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5953:2: note: variable declared here
        MemoryWriter* bwrt;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5974:3: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                sprintf( errormessage, MEM_ERRMSG );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5974:12: warning: do not implicitly decay an array into a pointer; consider using gsl::array_view or an explicit cast instead [cppcoreguidelines-pro-bounds-array-to-pointer-decay]
                sprintf( errormessage, MEM_ERRMSG );
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5981:23: warning: statement should be inside braces [hicpp-braces-around-statements]
        if ( len != nullptr ) (*len) = bwrt->num_bytes_written();
                             ^
                              {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5982:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete bwrt;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5953:2: note: variable declared here
        MemoryWriter* bwrt;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5992:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_decode_bit( ArithmeticDecoder* dec, unsigned char* bit )
       ~~~~ ^
       auto                                                              -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5997:2: warning: assigning newly created 'gsl::owner<>' to non-owner 'model_b *' [cppcoreguidelines-owning-memory]
        model = INIT_MODEL_B( 1, -1 );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5999:2: warning: deleting a pointer through a type that is not marked 'gsl::owner<>'; consider using a smart pointer instead [cppcoreguidelines-owning-memory]
        delete( model );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:5994:2: note: variable declared here
        model_b* model;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6011:2: warning: do not declare C-style arrays, use std::array<> instead [cppcoreguidelines-avoid-c-arrays]
        unsigned int zdist[ 64 ]; // distributions of zeroes per band
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6011:22: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        unsigned int zdist[ 64 ]; // distributions of zeroes per band
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6012:11: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        int bc = cmpnfo[cmp].bc;
                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6013:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int bpos, dpos; 
        ^~~~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6020:19: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        for ( i = 0; i < 64; i++ ) {
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6021:3: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                sv[ i ] = i;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6022:3: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                zdist[ i ] = 0;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6026:25: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        for ( bpos = 0; bpos < 64; bpos++ )
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6026:37: warning: statement should be inside braces [google-readability-braces-around-statements]
        for ( bpos = 0; bpos < 64; bpos++ )
                                           ^
                                            {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6027:37: warning: statement should be inside braces [google-readability-braces-around-statements]
        for ( dpos = 0; dpos < bc; dpos++ )                     
                                           ^
                                            {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6028:8: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( colldata[cmp][bpos][dpos] == 0 ) zdist[ bpos ]++;
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6028:8: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6028:40: warning: statement should be inside braces [hicpp-braces-around-statements]
                if ( colldata[cmp][bpos][dpos] == 0 ) zdist[ bpos ]++;
                                                     ^
                                                      {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6028:41: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( colldata[cmp][bpos][dpos] == 0 ) zdist[ bpos ]++;
                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6031:2: warning: misleading indentation: statement is indented too deeply [readability-misleading-indentation]
        while ( !done ) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6026:2: note: did you mean this line to be inside this 'for'
        for ( bpos = 0; bpos < 64; bpos++ )
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6033:20: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                for ( i = 2; i < 64; i++ )
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6033:29: warning: statement should be inside braces [google-readability-braces-around-statements]
                for ( i = 2; i < 64; i++ )
                                          ^
                                           {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6034:8: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( zdist[ i ] < zdist[ i - 1 ] ) {
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6034:21: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                if ( zdist[ i ] < zdist[ i - 1 ] ) {
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6036:11: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        swap = zdist[ i ];
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6036:11: warning: narrowing conversion from 'unsigned int' to signed type 'int' is implementation-defined [bugprone-narrowing-conversions]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6037:4: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        zdist[ i ] = zdist[ i - 1 ];
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6037:17: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        zdist[ i ] = zdist[ i - 1 ];
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6038:4: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                        zdist[ i - 1 ] = swap;
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6040:11: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        swap = sv[ i ];
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6041:4: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        sv[ i ] = sv[ i - 1 ];
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6041:14: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        sv[ i ] = sv[ i - 1 ];
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6042:4: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        sv[ i - 1 ] = swap;
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6053:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_optimize_header( void )
       ~~~~ ^
       auto                             -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6053:34: warning: redundant void argument list in function definition [modernize-redundant-void-arg]
INTERN bool pjg_optimize_header( void )
                                 ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6068:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                type = hdrdata[ hpos + 1 ];
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6069:13: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                len = 2 + B_SHORT( hdrdata[ hpos + 2 ], hdrdata[ hpos + 3 ] );
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:320:28: note: expanded from macro 'B_SHORT'
#define B_SHORT(v1,v2)  ( ( ((int) v1) << 8 ) + ((int) v2) )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6069:22: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                len = 2 + B_SHORT( hdrdata[ hpos + 2 ], hdrdata[ hpos + 3 ] );
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6069:43: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                len = 2 + B_SHORT( hdrdata[ hpos + 2 ], hdrdata[ hpos + 3 ] );
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6070:16: warning: 0xC4 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                if ( type == 0xC4 ) { // for DHT
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6077:29: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                        for ( spos = 0; spos < std_huff_lengths[ i ]; spos++ ) {
                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6078:12: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                                if ( hdrdata[ hpos + spos ] != std_huff_tables[ i ][ spos ] )
                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6078:38: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                if ( hdrdata[ hpos + spos ] != std_huff_tables[ i ][ spos ] )
                                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6078:68: warning: statement should be inside braces [google-readability-braces-around-statements]
                                                if ( hdrdata[ hpos + spos ] != std_huff_tables[ i ][ spos ] )
                                                                                                             ^
                                                                                                              {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6082:19: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                        if ( spos != std_huff_lengths[ i ] )
                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6082:42: warning: statement should be inside braces [google-readability-braces-around-statements]
                                        if ( spos != std_huff_lengths[ i ] )
                                                                            ^
                                                                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6087:6: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                        hdrdata[ hpos + 0 ] = std_huff_lengths[ i ] - 16 - i;
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6087:28: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                        hdrdata[ hpos + 0 ] = std_huff_lengths[ i ] - 16 - i;
                                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6087:52: warning: 16 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                        hdrdata[ hpos + 0 ] = std_huff_lengths[ i ] - 16 - i;
                                                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6088:6: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                        hdrdata[ hpos + 1 ] = i;
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6089:29: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                        for ( spos = 2; spos < std_huff_lengths[ i ]; spos++ )
                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6089:60: warning: statement should be inside braces [google-readability-braces-around-statements]
                                        for ( spos = 2; spos < std_huff_lengths[ i ]; spos++ )
                                                                                              ^
                                                                                               {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6090:7: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                                hdrdata[ hpos + spos ] = 0x00;
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6095:12: warning: 16 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                skip = 16;
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6096:22: warning: 16 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                for ( i = 0; i < 16; i++ )              
                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6096:31: warning: statement should be inside braces [google-readability-braces-around-statements]
                                for ( i = 0; i < 16; i++ )              
                                                          ^
                                                           {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6097:32: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                        skip += static_cast< int>(hdrdata[ hpos + i ]);                         
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6101:21: warning: 0xDB is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                else if ( type == 0xDB ) { // for DQT
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6105:16: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                i = LBITS( hdrdata[ hpos ], 4 );                                
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6105:16: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/./bitops.h:5:26: note: expanded from macro 'LBITS'
#define LBITS( c, n )           ( c >> (8 - n) )
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6109:14: warning: 128 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                        hpos += 128;
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6113:18: warning: 63 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                for ( spos = 63; spos > 0; spos-- )
                                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6113:40: warning: statement should be inside braces [google-readability-braces-around-statements]
                                for ( spos = 63; spos > 0; spos-- )
                                                                   ^
                                                                    {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6114:6: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                        hdrdata[ hpos + spos ] -= hdrdata[ hpos + spos - 1 ];
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6114:32: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                        hdrdata[ hpos + spos ] -= hdrdata[ hpos + spos - 1 ];
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6116:13: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                hpos += 64;
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6132:13: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN bool pjg_unoptimize_header( void )
       ~~~~ ^
       auto                               -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6132:36: warning: redundant void argument list in function definition [modernize-redundant-void-arg]
INTERN bool pjg_unoptimize_header( void )
                                   ^~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6147:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                type = hdrdata[ hpos + 1 ];
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6148:13: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                len = 2 + B_SHORT( hdrdata[ hpos + 2 ], hdrdata[ hpos + 3 ] );
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:320:28: note: expanded from macro 'B_SHORT'
#define B_SHORT(v1,v2)  ( ( ((int) v1) << 8 ) + ((int) v2) )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6148:22: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                len = 2 + B_SHORT( hdrdata[ hpos + 2 ], hdrdata[ hpos + 3 ] );
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6148:43: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                len = 2 + B_SHORT( hdrdata[ hpos + 2 ], hdrdata[ hpos + 3 ] );
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6150:16: warning: 0xC4 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                if ( type == 0xC4 ) { // for DHT
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6156:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                if ( hdrdata[ hpos ] > 2 ) {    
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6158:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                        i = hdrdata[ hpos + 1 ];
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6159:29: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                        for ( spos = 0; spos < std_huff_lengths[ i ]; spos++ ) {
                                                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6160:7: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                                hdrdata[ hpos + spos ] = std_huff_tables[ i ][ spos ];
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6160:32: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
                                                hdrdata[ hpos + spos ] = std_huff_tables[ i ][ spos ];
                                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6164:12: warning: 16 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                skip = 16;
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6165:22: warning: 16 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                for ( i = 0; i < 16; i++ )              
                                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6165:31: warning: statement should be inside braces [google-readability-braces-around-statements]
                                for ( i = 0; i < 16; i++ )              
                                                          ^
                                                           {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6166:32: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                        skip += static_cast< int>(hdrdata[ hpos + i ]);                         
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6170:21: warning: 0xDB is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                else if ( type == 0xDB ) { // for DQT
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6174:16: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                i = LBITS( hdrdata[ hpos ], 4 );                                
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6174:16: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
/home/mangix/devstuff/packJPG/source/./bitops.h:5:26: note: expanded from macro 'LBITS'
#define LBITS( c, n )           ( c >> (8 - n) )
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6178:14: warning: 128 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                        hpos += 128;
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6182:28: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                for ( spos = 1; spos < 64; spos++ )
                                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6182:40: warning: statement should be inside braces [google-readability-braces-around-statements]
                                for ( spos = 1; spos < 64; spos++ )
                                                                   ^
                                                                    {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6183:6: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                        hdrdata[ hpos + spos ] += hdrdata[ hpos + spos - 1 ];
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6183:32: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                                        hdrdata[ hpos + spos ] += hdrdata[ hpos + spos - 1 ];
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6185:13: warning: 64 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                                hpos += 64;
                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6201:32: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
INTERN void pjg_aavrg_prepare( unsigned short** abs_coeffs, int* weights, unsigned short* abs_store, int cmp )
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6201:75: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
INTERN void pjg_aavrg_prepare( unsigned short** abs_coeffs, int* weights, unsigned short* abs_store, int cmp )
                                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6203:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        int w = cmpnfo[cmp].bch;
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6206:2: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        abs_coeffs[ 0 ] = abs_store + (  0 + ((-2)*w) ); // top-top
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6206:30: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        abs_coeffs[ 0 ] = abs_store + (  0 + ((-2)*w) ); // top-top
                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6207:2: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        abs_coeffs[ 1 ] = abs_store + ( -1 + ((-1)*w) ); // top-left
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6207:30: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        abs_coeffs[ 1 ] = abs_store + ( -1 + ((-1)*w) ); // top-left
                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6208:2: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        abs_coeffs[ 2 ] = abs_store + (  0 + ((-1)*w) ); // top
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6208:30: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        abs_coeffs[ 2 ] = abs_store + (  0 + ((-1)*w) ); // top
                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6209:2: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        abs_coeffs[ 3 ] = abs_store + (  1 + ((-1)*w) ); // top-right
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6209:30: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        abs_coeffs[ 3 ] = abs_store + (  1 + ((-1)*w) ); // top-right
                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6210:2: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        abs_coeffs[ 4 ] = abs_store + ( -2 + (( 0)*w) ); // left-left
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6210:30: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        abs_coeffs[ 4 ] = abs_store + ( -2 + (( 0)*w) ); // left-left
                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6211:2: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        abs_coeffs[ 5 ] = abs_store + ( -1 + (( 0)*w) ); // left
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6211:14: warning: 5 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        abs_coeffs[ 5 ] = abs_store + ( -1 + (( 0)*w) ); // left
                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6211:30: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        abs_coeffs[ 5 ] = abs_store + ( -1 + (( 0)*w) ); // left
                                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6213:2: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        weights[ 0 ] = abs_ctx_weights_lum[ 0 ][ 0 ][ 2 ]; // top-top
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6214:2: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        weights[ 1 ] = abs_ctx_weights_lum[ 0 ][ 1 ][ 1 ]; // top-left
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6215:2: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        weights[ 2 ] = abs_ctx_weights_lum[ 0 ][ 1 ][ 2 ]; // top
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6216:2: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        weights[ 3 ] = abs_ctx_weights_lum[ 0 ][ 1 ][ 3 ]; // top-right
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6217:2: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        weights[ 4 ] = abs_ctx_weights_lum[ 0 ][ 2 ][ 0 ]; // left-left
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6218:2: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        weights[ 5 ] = abs_ctx_weights_lum[ 0 ][ 2 ][ 1 ]; // left
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6218:11: warning: 5 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        weights[ 5 ] = abs_ctx_weights_lum[ 0 ][ 2 ][ 1 ]; // left
                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6225:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int pjg_aavrg_context( unsigned short** abs_coeffs, int* weights, int pos, int p_y, int p_x, int r_x )
       ~~~ ^
       auto                                                                                                   -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6225:31: warning: consider replacing 'unsigned short' with 'uint16' [google-runtime-int]
INTERN int pjg_aavrg_context( unsigned short** abs_coeffs, int* weights, int pos, int p_y, int p_x, int r_x )
                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6225:65: warning: pointer parameter 'weights' can be pointer to const [readability-non-const-parameter]
INTERN int pjg_aavrg_context( unsigned short** abs_coeffs, int* weights, int pos, int p_y, int p_x, int r_x )
                                                                ^
                                                           const 
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6234:12: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                w_curr = weights[ 0 ]; ctx_avr += abs_coeffs[ 0 ][ pos ] * w_curr; w_ctx += w_curr;
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6234:37: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                w_curr = weights[ 0 ]; ctx_avr += abs_coeffs[ 0 ][ pos ] * w_curr; w_ctx += w_curr;
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6235:12: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                w_curr = weights[ 2 ]; ctx_avr += abs_coeffs[ 2 ][ pos ] * w_curr; w_ctx += w_curr;
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6235:37: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                w_curr = weights[ 2 ]; ctx_avr += abs_coeffs[ 2 ][ pos ] * w_curr; w_ctx += w_curr;
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6237:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 1 ]; ctx_avr += abs_coeffs[ 1 ][ pos ] * w_curr; w_ctx += w_curr;
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6237:38: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 1 ]; ctx_avr += abs_coeffs[ 1 ][ pos ] * w_curr; w_ctx += w_curr;
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6238:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 4 ]; ctx_avr += abs_coeffs[ 4 ][ pos ] * w_curr; w_ctx += w_curr;
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6238:38: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 4 ]; ctx_avr += abs_coeffs[ 4 ][ pos ] * w_curr; w_ctx += w_curr;
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6239:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 5 ]; ctx_avr += abs_coeffs[ 5 ][ pos ] * w_curr; w_ctx += w_curr;
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6239:22: warning: 5 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        w_curr = weights[ 5 ]; ctx_avr += abs_coeffs[ 5 ][ pos ] * w_curr; w_ctx += w_curr;
                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6239:38: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 5 ]; ctx_avr += abs_coeffs[ 5 ][ pos ] * w_curr; w_ctx += w_curr;
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6239:50: warning: 5 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        w_curr = weights[ 5 ]; ctx_avr += abs_coeffs[ 5 ][ pos ] * w_curr; w_ctx += w_curr;
                                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6242:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 1 ]; ctx_avr += abs_coeffs[ 1 ][ pos ] * w_curr; w_ctx += w_curr;
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6242:38: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 1 ]; ctx_avr += abs_coeffs[ 1 ][ pos ] * w_curr; w_ctx += w_curr;
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6243:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 5 ]; ctx_avr += abs_coeffs[ 5 ][ pos ] * w_curr; w_ctx += w_curr;
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6243:22: warning: 5 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        w_curr = weights[ 5 ]; ctx_avr += abs_coeffs[ 5 ][ pos ] * w_curr; w_ctx += w_curr;
                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6243:38: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 5 ]; ctx_avr += abs_coeffs[ 5 ][ pos ] * w_curr; w_ctx += w_curr;
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6243:50: warning: 5 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        w_curr = weights[ 5 ]; ctx_avr += abs_coeffs[ 5 ][ pos ] * w_curr; w_ctx += w_curr;
                                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6246:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 3 ]; ctx_avr += abs_coeffs[ 3 ][ pos ] * w_curr; w_ctx += w_curr;
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6246:38: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 3 ]; ctx_avr += abs_coeffs[ 3 ][ pos ] * w_curr; w_ctx += w_curr;
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6250:12: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                w_curr = weights[ 2 ]; ctx_avr += abs_coeffs[ 2 ][ pos ] * w_curr; w_ctx += w_curr;
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6250:37: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                w_curr = weights[ 2 ]; ctx_avr += abs_coeffs[ 2 ][ pos ] * w_curr; w_ctx += w_curr;
                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6252:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 1 ]; ctx_avr += abs_coeffs[ 1 ][ pos ] * w_curr; w_ctx += w_curr;
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6252:38: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 1 ]; ctx_avr += abs_coeffs[ 1 ][ pos ] * w_curr; w_ctx += w_curr;
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6253:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 4 ]; ctx_avr += abs_coeffs[ 4 ][ pos ] * w_curr; w_ctx += w_curr;
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6253:38: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 4 ]; ctx_avr += abs_coeffs[ 4 ][ pos ] * w_curr; w_ctx += w_curr;
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6254:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 5 ]; ctx_avr += abs_coeffs[ 5 ][ pos ] * w_curr; w_ctx += w_curr;
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6254:22: warning: 5 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        w_curr = weights[ 5 ]; ctx_avr += abs_coeffs[ 5 ][ pos ] * w_curr; w_ctx += w_curr;
                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6254:38: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 5 ]; ctx_avr += abs_coeffs[ 5 ][ pos ] * w_curr; w_ctx += w_curr;
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6254:50: warning: 5 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        w_curr = weights[ 5 ]; ctx_avr += abs_coeffs[ 5 ][ pos ] * w_curr; w_ctx += w_curr;
                                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6257:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 1 ]; ctx_avr += abs_coeffs[ 1 ][ pos ] * w_curr; w_ctx += w_curr;
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6257:38: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 1 ]; ctx_avr += abs_coeffs[ 1 ][ pos ] * w_curr; w_ctx += w_curr;
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6258:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 5 ]; ctx_avr += abs_coeffs[ 5 ][ pos ] * w_curr; w_ctx += w_curr;
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6258:22: warning: 5 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        w_curr = weights[ 5 ]; ctx_avr += abs_coeffs[ 5 ][ pos ] * w_curr; w_ctx += w_curr;
                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6258:38: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 5 ]; ctx_avr += abs_coeffs[ 5 ][ pos ] * w_curr; w_ctx += w_curr;
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6258:50: warning: 5 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        w_curr = weights[ 5 ]; ctx_avr += abs_coeffs[ 5 ][ pos ] * w_curr; w_ctx += w_curr;
                                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6261:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 3 ]; ctx_avr += abs_coeffs[ 3 ][ pos ] * w_curr; w_ctx += w_curr;
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6261:38: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 3 ]; ctx_avr += abs_coeffs[ 3 ][ pos ] * w_curr; w_ctx += w_curr;
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6266:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 4 ]; ctx_avr += abs_coeffs[ 4 ][ pos ] * w_curr; w_ctx += w_curr;
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6266:38: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 4 ]; ctx_avr += abs_coeffs[ 4 ][ pos ] * w_curr; w_ctx += w_curr;
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6267:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 5 ]; ctx_avr += abs_coeffs[ 5 ][ pos ] * w_curr; w_ctx += w_curr;
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6267:22: warning: 5 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        w_curr = weights[ 5 ]; ctx_avr += abs_coeffs[ 5 ][ pos ] * w_curr; w_ctx += w_curr;
                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6267:38: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 5 ]; ctx_avr += abs_coeffs[ 5 ][ pos ] * w_curr; w_ctx += w_curr;
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6267:50: warning: 5 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        w_curr = weights[ 5 ]; ctx_avr += abs_coeffs[ 5 ][ pos ] * w_curr; w_ctx += w_curr;
                                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6270:13: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 5 ]; ctx_avr += abs_coeffs[ 5 ][ pos ] * w_curr; w_ctx += w_curr;
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6270:22: warning: 5 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        w_curr = weights[ 5 ]; ctx_avr += abs_coeffs[ 5 ][ pos ] * w_curr; w_ctx += w_curr;
                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6270:38: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        w_curr = weights[ 5 ]; ctx_avr += abs_coeffs[ 5 ][ pos ] * w_curr; w_ctx += w_curr;
                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6270:50: warning: 5 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                        w_curr = weights[ 5 ]; ctx_avr += abs_coeffs[ 5 ][ pos ] * w_curr; w_ctx += w_curr;
                                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6282:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int pjg_lakh_context( signed short** coeffs_x, signed short** coeffs_a, int* pred_cf, int pos )
       ~~~ ^
       auto                                                                                            -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6282:30: warning: consider replacing 'short' with 'int16' [google-runtime-int]
INTERN int pjg_lakh_context( signed short** coeffs_x, signed short** coeffs_a, int* pred_cf, int pos )
                             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6282:55: warning: consider replacing 'short' with 'int16' [google-runtime-int]
INTERN int pjg_lakh_context( signed short** coeffs_x, signed short** coeffs_a, int* pred_cf, int pos )
                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6282:85: warning: pointer parameter 'pred_cf' can be pointer to const [readability-non-const-parameter]
INTERN int pjg_lakh_context( signed short** coeffs_x, signed short** coeffs_a, int* pred_cf, int pos )
                                                                                    ^
                                                                               const 
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6287:12: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        pred -= ( coeffs_x[ 1 ][ pos ] + coeffs_a[ 1 ][ pos ] ) * pred_cf[ 1 ];
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6287:35: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        pred -= ( coeffs_x[ 1 ][ pos ] + coeffs_a[ 1 ][ pos ] ) * pred_cf[ 1 ];
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6287:60: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        pred -= ( coeffs_x[ 1 ][ pos ] + coeffs_a[ 1 ][ pos ] ) * pred_cf[ 1 ];
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6288:12: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        pred -= ( coeffs_x[ 2 ][ pos ] - coeffs_a[ 2 ][ pos ] ) * pred_cf[ 2 ];
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6288:35: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        pred -= ( coeffs_x[ 2 ][ pos ] - coeffs_a[ 2 ][ pos ] ) * pred_cf[ 2 ];
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6288:60: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        pred -= ( coeffs_x[ 2 ][ pos ] - coeffs_a[ 2 ][ pos ] ) * pred_cf[ 2 ];
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6289:12: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        pred -= ( coeffs_x[ 3 ][ pos ] + coeffs_a[ 3 ][ pos ] ) * pred_cf[ 3 ];
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6289:35: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        pred -= ( coeffs_x[ 3 ][ pos ] + coeffs_a[ 3 ][ pos ] ) * pred_cf[ 3 ];
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6289:60: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        pred -= ( coeffs_x[ 3 ][ pos ] + coeffs_a[ 3 ][ pos ] ) * pred_cf[ 3 ];
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6290:12: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        pred -= ( coeffs_x[ 4 ][ pos ] - coeffs_a[ 4 ][ pos ] ) * pred_cf[ 4 ];
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6290:35: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        pred -= ( coeffs_x[ 4 ][ pos ] - coeffs_a[ 4 ][ pos ] ) * pred_cf[ 4 ];
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6290:60: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        pred -= ( coeffs_x[ 4 ][ pos ] - coeffs_a[ 4 ][ pos ] ) * pred_cf[ 4 ];
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6291:12: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        pred -= ( coeffs_x[ 5 ][ pos ] + coeffs_a[ 5 ][ pos ] ) * pred_cf[ 5 ];
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6291:22: warning: 5 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        pred -= ( coeffs_x[ 5 ][ pos ] + coeffs_a[ 5 ][ pos ] ) * pred_cf[ 5 ];
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6291:35: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        pred -= ( coeffs_x[ 5 ][ pos ] + coeffs_a[ 5 ][ pos ] ) * pred_cf[ 5 ];
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6291:45: warning: 5 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        pred -= ( coeffs_x[ 5 ][ pos ] + coeffs_a[ 5 ][ pos ] ) * pred_cf[ 5 ];
                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6291:60: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        pred -= ( coeffs_x[ 5 ][ pos ] + coeffs_a[ 5 ][ pos ] ) * pred_cf[ 5 ];
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6291:69: warning: 5 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        pred -= ( coeffs_x[ 5 ][ pos ] + coeffs_a[ 5 ][ pos ] ) * pred_cf[ 5 ];
                                                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6292:12: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        pred -= ( coeffs_x[ 6 ][ pos ] - coeffs_a[ 6 ][ pos ] ) * pred_cf[ 6 ];
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6292:22: warning: 6 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        pred -= ( coeffs_x[ 6 ][ pos ] - coeffs_a[ 6 ][ pos ] ) * pred_cf[ 6 ];
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6292:35: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        pred -= ( coeffs_x[ 6 ][ pos ] - coeffs_a[ 6 ][ pos ] ) * pred_cf[ 6 ];
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6292:45: warning: 6 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        pred -= ( coeffs_x[ 6 ][ pos ] - coeffs_a[ 6 ][ pos ] ) * pred_cf[ 6 ];
                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6292:60: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        pred -= ( coeffs_x[ 6 ][ pos ] - coeffs_a[ 6 ][ pos ] ) * pred_cf[ 6 ];
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6292:69: warning: 6 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        pred -= ( coeffs_x[ 6 ][ pos ] - coeffs_a[ 6 ][ pos ] ) * pred_cf[ 6 ];
                                                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6293:12: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        pred -= ( coeffs_x[ 7 ][ pos ] + coeffs_a[ 7 ][ pos ] ) * pred_cf[ 7 ];
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6293:22: warning: 7 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        pred -= ( coeffs_x[ 7 ][ pos ] + coeffs_a[ 7 ][ pos ] ) * pred_cf[ 7 ];
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6293:35: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        pred -= ( coeffs_x[ 7 ][ pos ] + coeffs_a[ 7 ][ pos ] ) * pred_cf[ 7 ];
                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6293:45: warning: 7 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        pred -= ( coeffs_x[ 7 ][ pos ] + coeffs_a[ 7 ][ pos ] ) * pred_cf[ 7 ];
                                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6293:60: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        pred -= ( coeffs_x[ 7 ][ pos ] + coeffs_a[ 7 ][ pos ] ) * pred_cf[ 7 ];
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6293:69: warning: 7 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        pred -= ( coeffs_x[ 7 ][ pos ] + coeffs_a[ 7 ][ pos ] ) * pred_cf[ 7 ];
                                                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6295:36: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        pred = ( ( pred > 0 ) ? ( pred + (pred_cf[0]/2) ) : ( pred - (pred_cf[0]/2) ) ) / pred_cf[ 0 ];
                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6295:64: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        pred = ( ( pred > 0 ) ? ( pred + (pred_cf[0]/2) ) : ( pred - (pred_cf[0]/2) ) ) / pred_cf[ 0 ];
                                                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6295:84: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        pred = ( ( pred > 0 ) ? ( pred + (pred_cf[0]/2) ) : ( pred - (pred_cf[0]/2) ) ) / pred_cf[ 0 ];
                                                                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6297:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        pred += coeffs_a[ 0 ][ pos ];
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6316:17: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                if ( pos >= ( w << 1 ) )
                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6316:27: warning: statement should be inside braces [google-readability-braces-around-statements]
                if ( pos >= ( w << 1 ) )
                                        ^
                                         {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6317:17: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
                        *a = pos - ( w << 1 );
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6318:7: warning: statement should be inside braces [google-readability-braces-around-statements]
                else
                    ^
                     {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6323:18: warning: statement should be inside braces [google-readability-braces-around-statements]
                if ( pos >= 2 )
                               ^
                                {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6325:7: warning: statement should be inside braces [google-readability-braces-around-statements]
                else
                    ^
                     {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6427:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int idct_2d_fst_8x1( int cmp, int dpos, int ix, int iy )
       ~~~ ^
       auto                                                     -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6427:60: warning: parameter 'iy' is unused [misc-unused-parameters]
INTERN int idct_2d_fst_8x1( int cmp, int dpos, int ix, int iy )
                                                     ~~~~~~^~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6434:8: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
        ixy = ix << 3;
              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6437:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][  0 ][ dpos ] * adpt_idct_8x1[ cmp ][ ixy + 0 ];
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6437:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6437:42: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][  0 ][ dpos ] * adpt_idct_8x1[ cmp ][ ixy + 0 ];
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6438:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][  1 ][ dpos ] * adpt_idct_8x1[ cmp ][ ixy + 1 ];
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6438:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6438:42: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][  1 ][ dpos ] * adpt_idct_8x1[ cmp ][ ixy + 1 ];
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6439:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][  5 ][ dpos ] * adpt_idct_8x1[ cmp ][ ixy + 2 ];
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6439:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6439:28: warning: 5 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        idct += colldata[ cmp ][  5 ][ dpos ] * adpt_idct_8x1[ cmp ][ ixy + 2 ];
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6439:42: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][  5 ][ dpos ] * adpt_idct_8x1[ cmp ][ ixy + 2 ];
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6440:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][  6 ][ dpos ] * adpt_idct_8x1[ cmp ][ ixy + 3 ];
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6440:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6440:28: warning: 6 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        idct += colldata[ cmp ][  6 ][ dpos ] * adpt_idct_8x1[ cmp ][ ixy + 3 ];
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6440:42: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][  6 ][ dpos ] * adpt_idct_8x1[ cmp ][ ixy + 3 ];
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6441:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][ 14 ][ dpos ] * adpt_idct_8x1[ cmp ][ ixy + 4 ];
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6441:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6441:27: warning: 14 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        idct += colldata[ cmp ][ 14 ][ dpos ] * adpt_idct_8x1[ cmp ][ ixy + 4 ];
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6441:42: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][ 14 ][ dpos ] * adpt_idct_8x1[ cmp ][ ixy + 4 ];
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6442:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][ 15 ][ dpos ] * adpt_idct_8x1[ cmp ][ ixy + 5 ];
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6442:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6442:27: warning: 15 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        idct += colldata[ cmp ][ 15 ][ dpos ] * adpt_idct_8x1[ cmp ][ ixy + 5 ];
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6442:42: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][ 15 ][ dpos ] * adpt_idct_8x1[ cmp ][ ixy + 5 ];
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6442:70: warning: 5 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        idct += colldata[ cmp ][ 15 ][ dpos ] * adpt_idct_8x1[ cmp ][ ixy + 5 ];
                                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6443:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][ 27 ][ dpos ] * adpt_idct_8x1[ cmp ][ ixy + 6 ];
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6443:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6443:27: warning: 27 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        idct += colldata[ cmp ][ 27 ][ dpos ] * adpt_idct_8x1[ cmp ][ ixy + 6 ];
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6443:42: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][ 27 ][ dpos ] * adpt_idct_8x1[ cmp ][ ixy + 6 ];
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6443:70: warning: 6 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        idct += colldata[ cmp ][ 27 ][ dpos ] * adpt_idct_8x1[ cmp ][ ixy + 6 ];
                                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6444:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][ 28 ][ dpos ] * adpt_idct_8x1[ cmp ][ ixy + 7 ];
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6444:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6444:27: warning: 28 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        idct += colldata[ cmp ][ 28 ][ dpos ] * adpt_idct_8x1[ cmp ][ ixy + 7 ];
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6444:42: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][ 28 ][ dpos ] * adpt_idct_8x1[ cmp ][ ixy + 7 ];
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6444:70: warning: 7 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        idct += colldata[ cmp ][ 28 ][ dpos ] * adpt_idct_8x1[ cmp ][ ixy + 7 ];
                                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6454:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int idct_2d_fst_1x8( int cmp, int dpos, int ix, int iy )
       ~~~ ^
       auto                                                     -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6454:52: warning: parameter 'ix' is unused [misc-unused-parameters]
INTERN int idct_2d_fst_1x8( int cmp, int dpos, int ix, int iy )
                                               ~~~~^~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6461:8: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
        ixy = iy << 3;
              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6464:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][  0 ][ dpos ] * adpt_idct_1x8[ cmp ][ ixy + 0 ];
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6464:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6464:42: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][  0 ][ dpos ] * adpt_idct_1x8[ cmp ][ ixy + 0 ];
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6465:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][  2 ][ dpos ] * adpt_idct_1x8[ cmp ][ ixy + 1 ];
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6465:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6465:42: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][  2 ][ dpos ] * adpt_idct_1x8[ cmp ][ ixy + 1 ];
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6466:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][  3 ][ dpos ] * adpt_idct_1x8[ cmp ][ ixy + 2 ];
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6466:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6466:42: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][  3 ][ dpos ] * adpt_idct_1x8[ cmp ][ ixy + 2 ];
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6467:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][  9 ][ dpos ] * adpt_idct_1x8[ cmp ][ ixy + 3 ];
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6467:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6467:28: warning: 9 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        idct += colldata[ cmp ][  9 ][ dpos ] * adpt_idct_1x8[ cmp ][ ixy + 3 ];
                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6467:42: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][  9 ][ dpos ] * adpt_idct_1x8[ cmp ][ ixy + 3 ];
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6468:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][ 10 ][ dpos ] * adpt_idct_1x8[ cmp ][ ixy + 4 ];
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6468:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6468:27: warning: 10 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        idct += colldata[ cmp ][ 10 ][ dpos ] * adpt_idct_1x8[ cmp ][ ixy + 4 ];
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6468:42: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][ 10 ][ dpos ] * adpt_idct_1x8[ cmp ][ ixy + 4 ];
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6469:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][ 20 ][ dpos ] * adpt_idct_1x8[ cmp ][ ixy + 5 ];
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6469:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6469:27: warning: 20 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        idct += colldata[ cmp ][ 20 ][ dpos ] * adpt_idct_1x8[ cmp ][ ixy + 5 ];
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6469:42: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][ 20 ][ dpos ] * adpt_idct_1x8[ cmp ][ ixy + 5 ];
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6469:70: warning: 5 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        idct += colldata[ cmp ][ 20 ][ dpos ] * adpt_idct_1x8[ cmp ][ ixy + 5 ];
                                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6470:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][ 21 ][ dpos ] * adpt_idct_1x8[ cmp ][ ixy + 6 ];
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6470:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6470:27: warning: 21 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        idct += colldata[ cmp ][ 21 ][ dpos ] * adpt_idct_1x8[ cmp ][ ixy + 6 ];
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6470:42: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][ 21 ][ dpos ] * adpt_idct_1x8[ cmp ][ ixy + 6 ];
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6470:70: warning: 6 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        idct += colldata[ cmp ][ 21 ][ dpos ] * adpt_idct_1x8[ cmp ][ ixy + 6 ];
                                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6471:10: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][ 35 ][ dpos ] * adpt_idct_1x8[ cmp ][ ixy + 7 ];
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6471:10: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6471:27: warning: 35 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        idct += colldata[ cmp ][ 35 ][ dpos ] * adpt_idct_1x8[ cmp ][ ixy + 7 ];
                                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6471:42: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        idct += colldata[ cmp ][ 35 ][ dpos ] * adpt_idct_1x8[ cmp ][ ixy + 7 ];
                                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6471:70: warning: 7 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
        idct += colldata[ cmp ][ 35 ][ dpos ] * adpt_idct_1x8[ cmp ][ ixy + 7 ];
                                                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6517:12: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN int dc_1ddct_predictor( int cmp, int dpos )
       ~~~ ^
       auto                                        -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6519:11: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        int w  = cmpnfo[cmp].bch;
                 ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6532:9: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        swap = colldata[ cmp ][ 0 ][ dpos ];
               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6532:9: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6533:2: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        colldata[ cmp ][ 0 ][ dpos ] = 0;
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6533:2: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6537:40: warning: 7 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                pa = idct_2d_fst_8x1( cmp, dpos - 1, 7, 0 );
                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6538:43: warning: 7 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                pb = idct_2d_fst_1x8( cmp, dpos - w, 0, 7 );
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6541:44: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                pred = ( ( pa - xa ) + ( pb - xb ) ) * ( 8 / 2 );
                                                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6544:40: warning: 7 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                pa = idct_2d_fst_8x1( cmp, dpos - 1, 7, 0 );
                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6546:24: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                pred = ( pa - xa ) * 8;
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6549:43: warning: 7 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                pb = idct_2d_fst_1x8( cmp, dpos - w, 0, 7 );
                                                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6551:24: warning: 8 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                pred = ( pb - xb ) * 8;
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6558:2: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        colldata[ cmp ][ 0 ][ dpos ] = swap;    
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6558:2: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6558:33: warning: narrowing conversion from 'int' to signed type 'short' is implementation-defined [bugprone-narrowing-conversions]
        colldata[ cmp ][ 0 ][ dpos ] = swap;    
                                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6562:14: warning: Division by zero [clang-analyzer-core.DivideZero]
        pred = pred / QUANT( cmp, 0 );
                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3177:17: note: Assuming 'cmp' is < 'cmpc'
        for ( cmp = 0; cmp < cmpc; cmp++ ) {
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3177:2: note: Loop condition is true.  Entering loop body
        for ( cmp = 0; cmp < cmpc; cmp++ ) {
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3178:13: note: Assuming the condition is false
                absmaxp = MAX_V( cmp, 0 );
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:26: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:22: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3178:13: note: '?' condition is false
                absmaxp = MAX_V( cmp, 0 );
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:306:24: note: expanded from macro 'MAX_V'
#define MAX_V(cm,bp)    ( ( QUANT(cm,bp) > 0 ) ? ( ( freqmax[bp] + QUANT(cm,bp) - 1 ) /  QUANT(cm,bp) ) : 0 )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3182:19: note: Assuming 'dpos' is < field 'bc'
                for ( dpos = 1; dpos < cmpnfo[cmp].bc; dpos++ ) {
                                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3182:3: note: Loop condition is true.  Entering loop body
                for ( dpos = 1; dpos < cmpnfo[cmp].bc; dpos++ ) {
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:3187:15: note: Calling 'dc_1ddct_predictor'
                        (*coef) += dc_1ddct_predictor( cmp, dpos ); // 1d dct predictor
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6536:9: note: Assuming 'px' is <= 0
        if ( ( px > 0 ) && ( py > 0 ) ) {
               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6536:18: note: Left side of '&&' is false
        if ( ( px > 0 ) && ( py > 0 ) ) {
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6543:12: note: 'px' is <= 0
        else if ( px > 0 ) {
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6543:7: note: Taking false branch
        else if ( px > 0 ) {
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6548:12: note: Assuming 'py' is <= 0
        else if ( py > 0 ) {
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6548:7: note: Taking false branch
        else if ( py > 0 ) {
             ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6561:9: note: '?' condition is false
        pred = CLAMPED( -( 1024 * DCT_RSC_FACTOR ), ( 1016 * DCT_RSC_FACTOR ), pred );
               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:323:26: note: expanded from macro 'CLAMPED'
#define CLAMPED(l,h,v)  ( ( v < l ) ? l : ( v > h ) ? h : v )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6561:9: note: '?' condition is false
        pred = CLAMPED( -( 1024 * DCT_RSC_FACTOR ), ( 1016 * DCT_RSC_FACTOR ), pred );
               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:323:42: note: expanded from macro 'CLAMPED'
#define CLAMPED(l,h,v)  ( ( v < l ) ? l : ( v > h ) ? h : v )
                                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6562:14: note: Division by zero
        pred = pred / QUANT( cmp, 0 );
                    ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6562:16: warning: do not use array subscript when the index is not an integer constant expression; use gsl::at() instead [cppcoreguidelines-pro-bounds-constant-array-index]
        pred = pred / QUANT( cmp, 0 );
                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6562:16: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
        pred = pred / QUANT( cmp, 0 );
                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:305:24: note: expanded from macro 'QUANT'
#define QUANT(cm,bp)    ( cmpnfo[cm].qtable[ bp ] )
                          ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6574:19: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN inline int plocoi( int a, int b, int c )
              ~~~ ^
              auto                              -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6577:2: warning: multiple declarations in a single statement reduces readability [readability-isolate-declaration]
        int min, max;
        ^~~~~~~~~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6582:17: warning: statement should be inside braces [hicpp-braces-around-statements]
        if ( c >= max ) return min;
                       ^
                        {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6583:17: warning: statement should be inside braces [hicpp-braces-around-statements]
        if ( c <= min ) return max;
                       ^
                        {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6592:19: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN inline int median_int( int* values, int size )
              ~~~ ^
              auto                                    -> int
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6594:17: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
        int middle = ( size >> 1 );
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6604:31: warning: statement should be inside braces [google-readability-braces-around-statements]
                for ( i = 1; i < size; i++ )
                                            ^
                                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6605:8: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                if ( values[ i ] < values[ i - 1 ] ) {
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6605:22: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                if ( values[ i ] < values[ i - 1 ] ) {
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6606:11: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        swap = values[ i ];
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6607:4: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        values[ i ] = values[ i - 1 ];
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6607:18: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        values[ i ] = values[ i - 1 ];
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6608:4: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        values[ i - 1 ] = swap;
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6615:5: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                ( values[ middle ] + values[ middle - 1 ] ) / 2 : values[ middle ];
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6615:24: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                ( values[ middle ] + values[ middle - 1 ] ) / 2 : values[ middle ];
                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6615:53: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                ( values[ middle ] + values[ middle - 1 ] ) / 2 : values[ middle ];
                                                                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6622:21: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN inline float median_float( float* values, int size )
              ~~~~~ ^
              auto                                          -> float
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6624:17: warning: use of a signed integer operand with a binary bitwise operator [hicpp-signed-bitwise]
        int middle = ( size >> 1 );
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6634:31: warning: statement should be inside braces [google-readability-braces-around-statements]
                for ( i = 1; i < size; i++ )
                                            ^
                                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6635:8: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                if ( values[ i ] < values[ i - 1 ] ) {
                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6635:22: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                if ( values[ i ] < values[ i - 1 ] ) {
                                   ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6636:11: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        swap = values[ i ];
                               ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6637:4: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        values[ i ] = values[ i - 1 ];
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6637:18: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        values[ i ] = values[ i - 1 ];
                                      ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6638:4: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                        values[ i - 1 ] = swap;
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6645:10: warning: narrowing conversion from 'double' to 'float' [bugprone-narrowing-conversions]
                return ( values[ middle ] + values[ middle - 1 ] ) / 2.0;
                       ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6645:12: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                return ( values[ middle ] + values[ middle - 1 ] ) / 2.0;
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6645:31: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                return ( values[ middle ] + values[ middle - 1 ] ) / 2.0;
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6645:56: warning: 2.0 is a magic number; consider replacing it with a named constant [cppcoreguidelines-avoid-magic-numbers]
                return ( values[ middle ] + values[ middle - 1 ] ) / 2.0;
                                                                     ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6647:2: warning: do not use 'else' after 'return' [readability-else-after-return]
        else
        ^~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6647:6: warning: statement should be inside braces [google-readability-braces-around-statements]
        else
            ^
             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6648:12: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                return ( values[ middle ] );
                         ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6667:2: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
        fprintf( msgout, "[" );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6672:32: warning: statement should be inside braces [google-readability-braces-around-statements]
        for ( i = 0; i < barpos; i++ )
                                      ^
                                       {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6673:3: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                fprintf( msgout, "X" );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6675:28: warning: statement should be inside braces [google-readability-braces-around-statements]
        for (  ; i < BARLEN; i++ )
                                  ^
                                   {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6676:3: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                fprintf( msgout, " " );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6677:2: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
        fprintf( msgout, "]" );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6685:21: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN inline char* create_filename( const char* base, const char* extension )
              ~~~~~ ^
              auto                                                             -> char*
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6687:12: warning: narrowing conversion from 'unsigned long' to signed type 'int' is implementation-defined [bugprone-narrowing-conversions]
        int len = strlen( base ) + ( ( extension == nullptr ) ? 0 : strlen( extension ) + 1 ) + 1;      
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6688:2: warning: initializing non-owner 'char *' with a newly created 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        char* filename = static_cast<char*>(calloc( len, sizeof( char ) ));     
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6688:38: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
        char* filename = static_cast<char*>(calloc( len, sizeof( char ) ));     
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6691:2: warning: Call to function 'strcpy' is insecure as it does not provide bounding of the memory buffer. Replace unbounded copy functions with analogous functions that support length arguments such as 'strlcpy'. CWE-119 [clang-analyzer-security.insecureAPI.strcpy]
        strcpy( filename, base );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6691:2: note: Call to function 'strcpy' is insecure as it does not provide bounding of the memory buffer. Replace unbounded copy functions with analogous functions that support length arguments such as 'strlcpy'. CWE-119
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6702:21: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN inline char* unique_filename( const char* base, const char* extension )
              ~~~~~ ^
              auto                                                             -> char*
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6704:12: warning: narrowing conversion from 'unsigned long' to signed type 'int' is implementation-defined [bugprone-narrowing-conversions]
        int len = strlen( base ) + ( ( extension == nullptr ) ? 0 : strlen( extension ) + 1 ) + 1;      
                  ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6705:2: warning: initializing non-owner 'char *' with a newly created 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        char* filename = static_cast<char*>(calloc( len, sizeof( char ) ));     
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6705:38: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
        char* filename = static_cast<char*>(calloc( len, sizeof( char ) ));     
                                            ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6708:2: warning: Call to function 'strcpy' is insecure as it does not provide bounding of the memory buffer. Replace unbounded copy functions with analogous functions that support length arguments such as 'strlcpy'. CWE-119 [clang-analyzer-security.insecureAPI.strcpy]
        strcpy( filename, base );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6708:2: note: Call to function 'strcpy' is insecure as it does not provide bounding of the memory buffer. Replace unbounded copy functions with analogous functions that support length arguments such as 'strlcpy'. CWE-119
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6712:3: warning: assigning newly created 'gsl::owner<>' to non-owner 'char *' [cppcoreguidelines-owning-memory]
                filename = static_cast<char*>(realloc( filename, len ));
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6712:33: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
                filename = static_cast<char*>(realloc( filename, len ));
                                              ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6712:33: warning: do not manage memory manually; consider std::vector or std::string [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6734:11: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                (*extstr++) = '.';
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6735:3: warning: Call to function 'strcpy' is insecure as it does not provide bounding of the memory buffer. Replace unbounded copy functions with analogous functions that support length arguments such as 'strlcpy'. CWE-119 [clang-analyzer-security.insecureAPI.strcpy]
                strcpy( extstr, extension );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6735:3: note: Call to function 'strcpy' is insecure as it does not provide bounding of the memory buffer. Replace unbounded copy functions with analogous functions that support length arguments such as 'strlcpy'. CWE-119
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6737:6: warning: statement should be inside braces [google-readability-braces-around-statements]
        else
            ^
             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6748:2: warning: initializing non-owner 'char *' with a newly created 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        char* tmpname = static_cast<char*>(calloc( strlen( filename ) + 1, sizeof( char ) ));
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6748:37: warning: do not manage memory manually; consider a container or a smart pointer [cppcoreguidelines-no-malloc]
        char* tmpname = static_cast<char*>(calloc( strlen( filename ) + 1, sizeof( char ) ));
                                           ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6752:2: warning: Call to function 'strcpy' is insecure as it does not provide bounding of the memory buffer. Replace unbounded copy functions with analogous functions that support length arguments such as 'strlcpy'. CWE-119 [clang-analyzer-security.insecureAPI.strcpy]
        strcpy( tmpname, filename );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6752:2: note: Call to function 'strcpy' is insecure as it does not provide bounding of the memory buffer. Replace unbounded copy functions with analogous functions that support length arguments such as 'strlcpy'. CWE-119
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6758:11: warning: do not use pointer arithmetic [cppcoreguidelines-pro-bounds-pointer-arithmetic]
                (*extstr++) = '_';
                        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6759:3: warning: Call to function 'strcpy' is insecure as it does not provide bounding of the memory buffer. Replace unbounded copy functions with analogous functions that support length arguments such as 'strlcpy'. CWE-119 [clang-analyzer-security.insecureAPI.strcpy]
                strcpy( extstr, strrchr( tmpname, '.' ) );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6759:3: note: Call to function 'strcpy' is insecure as it does not provide bounding of the memory buffer. Replace unbounded copy functions with analogous functions that support length arguments such as 'strlcpy'. CWE-119
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6761:6: warning: statement should be inside braces [google-readability-braces-around-statements]
        else
            ^
             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6762:3: warning: do not call c-style vararg functions [cppcoreguidelines-pro-type-vararg]
                sprintf( filename, "%s_", tmpname );
                ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6765:2: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        free( tmpname );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6765:2: warning: do not manage memory manually; use RAII [cppcoreguidelines-no-malloc]
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6772:20: warning: use a trailing return type for this function [modernize-use-trailing-return-type]
INTERN inline bool file_exists( const char* filename )
              ~~~~ ^
              auto                                     -> bool
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6775:2: warning: initializing non-owner 'FILE *' (aka '_IO_FILE *') with a newly created 'gsl::owner<>' [cppcoreguidelines-owning-memory]
        FILE* fp = fopen( filename, "rb" );
        ^
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6775:30: warning: use 'fopen' mode 'e' to set O_CLOEXEC [android-cloexec-fopen]
        FILE* fp = fopen( filename, "rb" );
                                    ^~~~
                                    "rbe"
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6777:22: warning: statement should be inside braces [google-readability-braces-around-statements]
        if ( fp == nullptr ) return false;
                            ^
                             {
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6778:2: warning: do not use 'else' after 'return' [readability-else-after-return]
        else {
        ^~~~~~
/home/mangix/devstuff/packJPG/source/packjpg.cpp:6779:3: warning: calling legacy resource function without passing a 'gsl::owner<>' [cppcoreguidelines-owning-memory]
                fclose( fp );
                ^
